try{(self.webpackChunkvk=self.webpackChunkvk||[]).push([[69094],{428069:(t,e,i)=>{i.d(e,{P:()=>r});var s=i(331635),n=i(42107),a=i(36794),o=i(931958);class r{createTrack(t){return this.trackFactory.create(t)}createSnippet(t){return this.snippetFactory.create(t)}createTrackFromEntity(t){return this.trackFactory.createFromEntity(t)}createSnippetFromEntity(t){return this.snippetFactory.createFromEntity(t)}constructor(t,e){this.trackFactory=t,this.snippetFactory=e}}r=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===a.u?Object:a.u,void 0===o._?Object:o._])],r)},931958:(t,e,i)=>{i.d(e,{_:()=>j});var s=i(434518),n=i(763812),a=i(331635),o=i(42107),r=i(975077),c=i(990126),l=i(273193),d=i(916533),u=i(317562),h=i(861700),p=i(788535),y=i(161308),g=i(15589),m=i(595432),A=i(12527),v=i(156589),f=i(655732),C=i(393951),_=i(908677),b=i(327813),S=i(477999);class P extends S.H{get clipRange(){const{previewUrlResponse:t}=this.source,e=t?.clip_from,i=t?.clip_to;return e&&i?{from:e,to:i}:null}constructor(t){super(t),(0,b.Gn)(this)}}(0,a.Cg)([b.EW,(0,a.Sn)("design:type",void 0),(0,a.Sn)("design:paramtypes",[])],P.prototype,"clipRange",null);var k=i(541859),E=(0,n._)("_getData"),I=(0,n._)("_createActions");class w extends k.z{get data(){return(0,s._)(this,E)[E]()}get actions(){return(0,s._)(this,I)[I]()}constructor(t){super(t),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),this.type="music_snippet",(0,s._)(this,E)[E]=t.getData,(0,s._)(this,I)[I]=t.createActions,this.entity=t.entity,(0,b.Gn)(this)}}(0,a.Cg)([b.EW,(0,a.Sn)("design:type",void 0),(0,a.Sn)("design:paramtypes",[])],w.prototype,"data",null),(0,a.Cg)([b.EW,(0,a.Sn)("design:type",void 0),(0,a.Sn)("design:paramtypes",[])],w.prototype,"actions",null);var O=(0,n._)("_createAudioEntity"),F=(0,n._)("_createFallbackEnsureList"),L=(0,n._)("_createActionsProvider"),x=(0,n._)("_createContext");class j{create(t){const{langs:e}=this,{getSource:i,onTogglePlaying:n}=t,a=t.context??(0,s._)(this,x)[x](),o=t.channel??this.player.main,r=new P({getSource:i}),c=t.entities?.audio??(0,s._)(this,O)[O](i),l=t.ensureList??(0,s._)(this,F)[F](c),d=(0,s._)(this,L)[L](o),u=new C.z({entityType:"snippet",musicService:this.musicService,getSource:i}),h=new _.j({musicService:this.musicService,getSource:i});return new w({entity:c,getData:()=>r,getPlayback:()=>new g.H({entity:c,ensureList:l,channel:o,langs:e,onTogglePlaying:n}),context:a,like:u,dislike:h,langs:e,musicService:this.musicService,createAlbum:e=>this.albumFactory.create({data:e,actionsCallbacks:t.albumActionsCallbacks}),createActions:()=>new A.P({getSource:i,data:r,entity:c,ensureList:l,context:a,provider:d,callbacks:t.actionsCallbacks}),authorsOverride:t.authorsOverride})}createFromEntity(t){const{audio:e}=t.entities;return this.create({...t,getSource:()=>({subtype:"snippet",audio:e.data.apiAudio,trackCode:e.context.trackCode,previewUrlResponse:null})})}constructor(t,e,i,s,n,a,o,r,c){Object.defineProperty(this,O,{value:M}),Object.defineProperty(this,F,{value:N}),Object.defineProperty(this,L,{value:z}),Object.defineProperty(this,x,{value:Y}),this.langs=t,this.authService=e,this.entityFactory=i,this.musicService=s,this.albumFactory=n,this.audioConfig=a,this.notifications=o,this.player=r,this.audioDislikesAnalytics=c}}function M(t){const e=t();return this.entityFactory.createSnippet(e.audio).attachContext({trackCode:e.trackCode??e.audio.track_code??""})}function N(t){const e=t.context.list??new u.Z({items:[t]});return async()=>e}function z(t){return new v.A({overrides:this.audioConfig.musicAudioActionOverrides,langs:this.langs,authService:this.authService,musicService:this.musicService,channel:t,platformConfig:this.audioConfig,notifications:this.notifications,audioDislikesAnalytics:this.audioDislikesAnalytics})}function Y(t={}){return{targetOwnerId:this.authService.userIdOrAnonim,...t}}j=(0,a.Cg)([o.z8.container(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[void 0===l.Y?Object:l.Y,void 0===d.u?Object:d.u,void 0===r.C?Object:r.C,void 0===c.v?Object:c.v,void 0===m.K?Object:m.K,void 0===h.w?Object:h.w,void 0===p.F?Object:p.F,void 0===y.Y?Object:y.Y,void 0===f.$?Object:f.$])],j)},524706:(t,e,i)=>{i.d(e,{O:()=>o});var s=i(331635),n=i(42107),a=i(886602);class o{createEpisode(t){return this.episodeFactory.create(t)}createEpisodeFromEntity(t){const{audio:e}=t.entities;return this.createEpisode({...t,getSource:()=>({audio:e.data.apiAudio,trackCode:e.context.trackCode})})}constructor(t){this.episodeFactory=t}}o=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===a.B?Object:a.B])],o)},159220:(t,e,i)=>{i.d(e,{g:()=>c});var s=i(331635),n=i(327813),a=i(45734),o=i(830443),r=i(112249);class c{async init(){this._initialized||(this.registerReactions(),await this.settings.ensure(),this.setInitialized(!0))}destroy(){this.isPlaying&&this.channel.stop(),this.reactions.dispose()}setInitialized(t){this._initialized=t}get initialized(){return this._initialized}get isAutoplay(){return this._isAutoplay}get isPlaying(){return this.isCurrentList&&this.channel.playing}get isPaused(){return this.isCurrentList&&this.channel.paused}get isListPlaying(){return this.isCurrentAttachmentList&&this.listChannel.playing}get isListPaused(){return this.isCurrentAttachmentList&&this.listChannel.paused}get isDisabled(){return!1}get isOtherChannelCurrentlyPlaying(){return this.playingChannel?.playing&&this.playingChannel.id!==this.channel.id}get canAutoplay(){const{settings:t}=this;return t.isAutoplayEnabled&&t.isAutoplayActive&&this.pageVisibility.isVisible&&!this.isOtherChannelCurrentlyPlaying}get progress(){return this.channel.progress}get listChannelProgress(){return this.listChannel.progress}get isCurrentList(){const{currentListIdentity:t}=this.channel;return!!t&&(0,a.C)(t,this.list.identity)}get isCurrentAttachmentList(){const{currentListIdentity:t}=this.listChannel;return!!t&&(0,a.C)(t,this.list.identity)}get currentAudio(){return this.channel.currentAudio}get currentAudioOnMediaList(){return this.listChannel.currentAudio}togglePlay(t){this.isPlaying?this.pause(!1):this.play(t)}togglePlayAttachmentList(t){this.isListPlaying?this.pauseListChannel():this.playListChannel(t)}autoplay(){this.canAutoplay&&this.play(!0)}autopause(){this.settings.isAutoplayActive&&this.isPlaying&&this.pause(!0)}async playListChannel(t){this.settings.stopAutoplay();const e=this.getPlayReason(),i=this.isListPaused&&this.isCurrentAudio(t);i?this.listChannel.resume(e):await this.listChannel.playAudio(t,this.list,e),this.listChannel.currentAudio&&this.analytics?.logPlayAudio({isAutoplayEnabled:this.settings.isAutoplayEnabled,wasPaused:i})}pauseListChannel(){if(this.isListPlaying){this.listChannel.pause(this.getPauseReason(this._isAutoplay));this.listChannel.currentAudio&&this.analytics?.logPauseAudio({isAutoplayEnabled:this.settings.isAutoplayEnabled})}}async play(t){this._isAutoplay=t;const e=this.getPlayReason(t),i=Boolean(this.isPaused&&this.channel.currentAudio);i?this.channel.resume(e):(await this.channel.playAudioList(this.list,e),this.analytics?.logPlayList(this.settings.isAutoplayEnabled)),this._isAutoplay&&this.settings.startAutoplay();this.channel.currentAudio&&this.analytics?.logPlayAudio({isAutoplayEnabled:this.settings.isAutoplayEnabled,wasPaused:i})}async playAudio(t){this.settings.stopAutoplay();const e=this.getPlayReason(),i=this.isPaused&&this.isCurrentAudio(t);i?this.channel.resume(e):await this.channel.playAudio(t,this.list,e),this.channel.currentAudio&&this.analytics?.logPlayAudio({isAutoplayEnabled:this.settings.isAutoplayEnabled,wasPaused:i})}pause(t){if(this._isAutoplay=t,this.isPlaying){this.channel.pause(this.getPauseReason(this._isAutoplay)),this._isAutoplay||this.settings.stopAutoplay();this.channel.currentAudio&&this.analytics?.logPauseAudio({isAutoplayEnabled:this.settings.isAutoplayEnabled})}}registerReactions(){this.reactions.reaction((()=>[this.isAutoplay,this.isCurrentList]),(([t,e])=>{e&&this.channel.setRepeat(t?"queue":"none")}),{fireImmediately:!0}),this.reactions.reaction((()=>this.canAutoplay),(t=>{!t&&this.isAutoplay&&this.isPlaying&&this.autopause()}))}getPlayReason(t=!1){return t?r.YR.Autoplay:r.YR.ListButton}getPauseReason(t=!1){return t?r.Ub.Unknown:r.Ub.PauseButton}constructor(t){this._initialized=!1,this._isAutoplay=!1,this.reactions=new o.O,this.playingChannel=null,this.onTogglePlay=()=>{this.togglePlay(!1)},this.onTogglePlayAttachmentList=t=>{this.togglePlayAttachmentList(t)},this.onTogglePlayWithAutoplay=()=>{this.togglePlay(!0)},this.isCurrentAudio=t=>this.currentAudio?.identity.fullId===t.identity.fullId,this.list=t.list,this.channel=t.channel,this.listChannel=t.listChannel,this.settings=t.settings,this.pageVisibility=t.pageVisibility,this.analytics=t.analytics,this.playingChannel=t.playingChannel,(0,n.Gn)(this)}}(0,s.Cg)([n.sH],c.prototype,"_initialized",void 0),(0,s.Cg)([n.XI,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[Boolean]),(0,s.Sn)("design:returntype",void 0)],c.prototype,"setInitialized",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],c.prototype,"initialized",null)},959267:(t,e,i)=>{i.d(e,{i:()=>l});var s=i(331635),n=i(42107),a=i(389889),o=i(161308),r=i(501429),c=i(159220);class l{create({list:t,analytics:e}){return new c.g({channel:this.audioPlayer.onMediaAttachment,listChannel:this.channel,settings:this.settings,pageVisibility:this.pageVisibility,list:t,playingChannel:this.audioPlayer.playing,analytics:e})}get channel(){return this.audioPlayer.main}constructor(t,e,i){this.audioPlayer=t,this.settings=e,this.pageVisibility=i}}l=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.Y?Object:o.Y,void 0===r.m?Object:r.m,void 0===a.W?Object:a.W])],l)},501429:(t,e,i)=>{i.d(e,{m:()=>l});var s=i(331635),n=i(327813),a=i(42107),o=i(645189),r=i(552343);class c{async ensure(){if(!this.settings)try{this.fetching||(this.fetching=this.fetch()),await this.fetching}finally{(0,n.h5)((()=>{this.fetching=null}))}}get isAutoplayEnabled(){const{settings:t}=this;if(!t)return!1;const e=t.params.find((t=>"ct_no_video_autoplay"===t.key));return e?.is_checked??!1}async fetch(){const t=await this.provider.fetchAccountSettingsSections({sections:"content"});if(!t)throw new Error("Service did not return account settings");const e=t.sections?.at(0);if(!e)throw new Error("Service did not return account settings section");(0,n.h5)((()=>{this.settings=e}))}constructor(t){this.provider=t,this.settings=null,this.fetching=null,(0,n.l_)(this)}}c=(0,s.Cg)([a.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===r.E?Object:r.E])],c);class l{async ensure(){return this.accountSettings.ensure()}get isOnMediaAudioRedesignFixEnabled(){return this.userEnv.partConfigEnabled("feed_onmedia_audio_redesign_fix")}get isAttachmentOnMediaAudiosListEnabled(){return this.userEnv.partConfigEnabled("feed_attachment_onmedia_audios_list")}get isAutoplayEnabled(){return this.accountSettings.isAutoplayEnabled}get isAutoplayActive(){return this._isAutoplayActive}get isAudioListLegalNoticeIconEnabled(){return this.userEnv.partConfigEnabled("frontend.feed_badges_legal_notice_icon_enabled")||this.userEnv.partConfigEnabled("feed_audiolist_legal_notice_icon_abt_enabled")}startAutoplay(){this._isAutoplayActive=!0}stopAutoplay(){this._isAutoplayActive=!1}constructor(t,e){this.accountSettings=t,this.userEnv=e,this._isAutoplayActive=!1,(0,n.Gn)(this)}}(0,s.Cg)([n.sH],l.prototype,"_isAutoplayActive",void 0),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],l.prototype,"isOnMediaAudioRedesignFixEnabled",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],l.prototype,"isAttachmentOnMediaAudiosListEnabled",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],l.prototype,"isAutoplayEnabled",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],l.prototype,"isAutoplayActive",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",void 0),(0,s.Sn)("design:paramtypes",[])],l.prototype,"isAudioListLegalNoticeIconEnabled",null),(0,s.Cg)([n.XI,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[]),(0,s.Sn)("design:returntype",void 0)],l.prototype,"startAutoplay",null),(0,s.Cg)([n.XI,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[]),(0,s.Sn)("design:returntype",void 0)],l.prototype,"stopAutoplay",null),l=(0,s.Cg)([a.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===c?Object:c,void 0===o.J?Object:o.J])],l)},760724:(t,e,i)=>{i.d(e,{D:()=>a});var s=i(331635),n=i(327813);class a{logPlayAudio({isAutoplayEnabled:t,wasPaused:e,context:i}){const{postActionAnalytics:s,audioItem:n,postClickAnalytics:a,postHandlers:o}=this;if(!n)return;const r={audio_item:n,subtype:this.getEventSubtype(e??!1,t),track_code:i?.trackCode};o&&this.props.feedItemId?t&&e?o.click.onUnmuteAudio({audio_item:n,feedItemId:this.props.feedItemId}):o.action.sendStartPostAudio({...r,feedItemId:this.props.feedItemId}):t&&e?a?.onUnmuteAudio({audio_item:n}):s?.sendStartPostAudio(r)}logPauseAudio({isAutoplayEnabled:t}){const{postActionAnalytics:e,audioItem:i,postClickAnalytics:s}=this;e&&i&&(this.postHandlers&&this.props.feedItemId?t?this.postHandlers.click.onMuteAudio({audio_item:i,feedItemId:this.props.feedItemId}):this.postHandlers.click.onPauseAudio({audio_item:i,feedItemId:this.props.feedItemId}):t?s?.onMuteAudio({audio_item:i}):s?.onPauseAudio({audio_item:i}))}get list(){return this.props.list}get postClickAnalytics(){return this.props.postClickAnalytics??null}get postActionAnalytics(){return this.props.postActionAnalytics??null}get postHandlers(){return this.props.postHandlers??null}get props(){return this.getProps()}getEventSubtype(t,e){return e?"autoplay":t?"pause":"manual"}constructor(t){this.getProps=t,(0,n.Gn)(this)}}(0,s.Cg)([n.EW,(0,s.Sn)("design:type","undefined"==typeof TAudioList?Object:TAudioList),(0,s.Sn)("design:paramtypes",[])],a.prototype,"list",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",Object),(0,s.Sn)("design:paramtypes",[])],a.prototype,"postClickAnalytics",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",Object),(0,s.Sn)("design:paramtypes",[])],a.prototype,"postActionAnalytics",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type",Object),(0,s.Sn)("design:paramtypes",[])],a.prototype,"postHandlers",null),(0,s.Cg)([n.EW,(0,s.Sn)("design:type","undefined"==typeof IOnMediaAttachmentAnalyticsProps?Object:IOnMediaAttachmentAnalyticsProps),(0,s.Sn)("design:paramtypes",[])],a.prototype,"props",null)},103312:(t,e,i)=>{i.d(e,{L:()=>c});var s=i(331635),n=i(327813),a=i(725200),o=i(320366),r=i(760724);class c extends r.D{logPlayList(){}logOpen(){const t=this.toClickEvent();t&&(this.postHandlers&&this.props.feedItemId?this.postHandlers.click.onOpenAudio({...t,feedItemId:this.props.feedItemId}):this.postClickAnalytics?.onOpenAudio(t))}logToggleOwning({state:t}){const e=this.toClickEvent();e&&this.props.feedItemId&&(this.postHandlers&&this.props.feedItemId?t?this.postHandlers.click.onAddedAudio({...e,feedItemId:this.props.feedItemId}):this.postHandlers.click.onRemovedAudio({...e,feedItemId:this.props.feedItemId}):t?this.postClickAnalytics?.onAddedAudio(e):this.postClickAnalytics?.onRemovedAudio(e))}get audioItem(){const t=this.list.audioAt(0)??null;if(!t)return null;const{id:e}=t.identity;let i=function(t){if((0,a.F)(t,o.h.Radio))return 100;return t.identity.ownerId}(t);return{item_id:e,item_owner_id:i,item_type:"audio"}}toClickEvent(){const{audioItem:t}=this;return t?{audio_item:t}:null}constructor(t){super(t),(0,n.Gn)(this)}}(0,s.Cg)([n.EW,(0,s.Sn)("design:type",Object),(0,s.Sn)("design:paramtypes",[])],c.prototype,"audioItem",null)},739991:(t,e,i)=>{i.d(e,{ZE:()=>o,c4:()=>a,n0:()=>n,y9:()=>s});const s="type_feed_post_",n="type_feed_",a="showMoreButton",o="textObsceneBlur"},313178:(t,e,i)=>{i.d(e,{z:()=>h});var s=i(331635),n=i(42107),a=i(457518),o=i(320366),r=i(321171),c=i(627255),l=i(238204),d=i(294507);function u(t){return t.podcast_info?o.h.PodcastEpisode:o.h.MusicTrack}class h{static isSameTypeCollection(t){let e;for(const i of t){const t=u(i);if(e){if(t!==e)return!1}else e=t}return!0}createFromAPI(t){if(!t.length)throw new Error("Unexpected empty audios attachment collection");if(!h.isSameTypeCollection(t))throw new Error("Audios for AttachmentAudioList must be same type");const e=u(t[0]);switch(e){case o.h.MusicTrack:{const e={type:r.b.AttachmentAudioList};return new d.Y({identity:this.createIdentityFromAPI(t),getData:()=>e,audios:t.map((t=>this.musicTrackProvider.createContextualFromAPI(t,{}))),context:{ref:null},attachContextToAudio:(t,e)=>t.attachContext(e)})}case o.h.PodcastEpisode:{const e={type:r.b.AttachmentAudioList};return new d.Y({identity:this.createIdentityFromAPI(t),getData:()=>e,audios:t.map((t=>this.podcastEpisodeProvider.createContextualFromAPI(t,{}))),context:{ref:null},attachContextToAudio:(t,e)=>t.attachContext(e)})}default:throw new Error(`Unsupported AttachmentAudioList contentType ${e}`)}}createIdentityFromAPI(t){const e=t.map((t=>`AttachmentAudioList#${t.owner_id}_${t.id}${t.preview_url?"_snippet":""}`)).join("/");return new a.h({id:e})}constructor(t,e){this.musicTrackProvider=t,this.podcastEpisodeProvider=e}}h=(0,s.Cg)([n.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===c.E?Object:c.E,void 0===l.D?Object:l.D])],h)},294507:(t,e,i)=>{i.d(e,{Y:()=>c});var s=i(434518),n=i(763812),a=i(1872),o=(0,n._)("_attachContextToAudio"),r=(0,n._)("_createItems");class c extends a.B{get isEmpty(){return!this.items.length}get head(){return this.items}audioAt(t){return this.items.at(t)}async fetchAt(t){return this.audioAtStrict(t)}async fetchNext(){return[]}constructor(t){super(t),Object.defineProperty(this,r,{value:l}),Object.defineProperty(this,o,{writable:!0,value:void 0}),(0,s._)(this,o)[o]=null,t.attachContextToAudio&&((0,s._)(this,o)[o]=t.attachContextToAudio),this.items=(0,s._)(this,r)[r](t.audios)}}function l(t){const e=[];let i;if(!t)return e;for(const n of t)i=n,!i.context.list&&(0,s._)(this,o)[o]&&(i=(0,s._)(this,o)[o](i,{...i.context,list:this})),e.push(i);return e}},238204:(t,e,i)=>{i.d(e,{D:()=>p});var s=i(331635),n=i(327813),a=i(42107),o=i(768641),r=i(585666),c=i(166900),l=i(723110),d=i(575485),u=i(328545),h=i(72039);class p extends r.f{createContextualFromAPI(t,e){const i=t.track_code;if(!i)throw new Error("trackCode is not defined in source");const s={...e,trackCode:i};return this.episodeContext.set(t.id,s),this.createFromAPI(t).attachContext(s)}createFromAPI(t){return this.create({identity:this.toEntityIdentity((0,u.m)(t)),data:(0,h.J)(t),state:(e=t,{isFavorite:e.podcast_info?.is_favorite})});var e}async ensure(t){const e=this.get(t);return e||this.fetch(t)}async ensureContext(t){const e=this.get(t);if(e){const i=this.getEpisodeContextual(t);return i||e}return this.fetchContext(t)}getEpisodeContextual(t){const e=this.get(t),i=this.episodeContext.get(t.id);return e&&i?e.attachContext(i):null}async fetch(t){const e=await this.podcastsApi.getEpisode({episode_id:t.id,owner_id:t.ownerId});return this.createFromAPI(e)}async fetchContext(t){const e=await this.podcastsApi.getEpisode({episode_id:t.id,owner_id:t.ownerId});return this.createContextualFromAPI(e,{})}constructEntity(t,e){return new c.q({...t,context:e,favoritesService:this.favoritesService})}setState(t,e){const{isFavorite:i}=e;void 0!==i&&this.favoritesService.setState(t,i)}getContextKey(t){return`${t.list?.identity.fullId??""}/${t.trackCode}`}toEntityIdentity(t){return new l.$(t)}constructor(t,e){super(),this.podcastsApi=t,this.favoritesService=e,this.episodeContext=new Map,(0,n.Gn)(this)}}p=(0,s.Cg)([a.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.M?Object:o.M,void 0===d.H?Object:d.H])],p)},937717:(t,e,i)=>{i.d(e,{h:()=>r});var s=i(331635),n=i(42107),a=i(327813),o=i(313178);class r{cache(t,e){if(this.hasInCache(t))return;const i=this.audioListProvider.createFromAPI(e);this.audioListsByPostId.set(t,i)}getByPostId(t){return this.audioListsByPostId.get(t)}getEnsured(t,e){return!this.hasInCache(t)&&e&&this.cache(t,e),this.getByPostId(t)}hasInCache(t){return this.audioListsByPostId.has(t)}constructor(t){this.audioListProvider=t,this.audioListsByPostId=new Map,(0,a.l_)(this)}}r=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.z?Object:o.z])],r)},552343:(t,e,i)=>{i.d(e,{E:()=>y});var s=i(331635),n=i(327813),a=i(42107),o=i(909589),r=i(941745),c=i(950211),l=i(71183),d=i(809609),u=i(645189),h=i(441587),p=i(82988);class y{get sections(){return this.data}async fetchAccountSettingsSections(t,e){try{const i={signal:e?.abortController?.signal||this.abortController.signal};return this.api.getAccountSettingsWithPrefetch(t,i)}catch(t){return this.checkError(t)}}async updateSettingsSections(t){const e=await this.fetchAccountSettingsSections({page:"account"},t),i=e?.sections?.find((t=>"color_scheme"===t.id))?.params?.find((t=>"select"===t.type&&"cs_color_scheme_mode"===t.key));if("auto"===i?.value){const t=this.cookie.get("remixcolor_scheme_mode");"light"!==t&&"dark"!==t||(i.value=t)}return(0,n.h5)((()=>{this.data=e?.sections??[]})),e}async setAccountParam(t,e,i){return this.setParam(this.data,this.api.setAccountSettings.bind(this.api),((...i)=>(this.settingsAccountEventEmitter.emitSettingsChanged(t,e),this.updateSettingsSections(...i))),t,e,i)}get notifySections(){return this.notifyData}setNotifySections(t){this.notifyData=t}async updateNotifySettingsSections(t,e="notify"){const i=await this.getNotifySettingsSections({page:e},t);if(!i)return;const s=i?.sections?.find((t=>"site_notify"===t.id))?.params?.find((t=>"custom_toggle"===t.type&&"sn_sounds_on"===t.key));return s&&(s.is_checked=!parseInt(this.ls.getItem("sound_notify_off")??"",10)),(0,n.h5)((()=>{this.notifyData=i?.sections??[]})),i}async getNotifySettingsSections(t,e){try{const i={signal:e?.abortController?.signal||this.abortController.signal},s=this.api.getNotifySettingsWithPrefetch(t,i);return await s}catch(t){return this.checkError(t)}}async setNotifyParam(t,e,i,s){return this.setParam(this.notifyData,this.api.setNotifySettings.bind(this.api),this.updateNotifySettingsSections.bind(this),t,e,i,s)}checkPageAddress(t){return this.utilsApi.checkScreenName({screen_name:t})}async setPageAddress(t){return!!(await this.accountApi.saveInfo({screen_name:t})).changed&&(this.updateSettingsSections(),!0)}deactivateProfile(t){return this.accountApi.deactivate(t)}getProfileInfo(){return this.accountApi.getProfileShortInfo({})}async setParam(t,e,i,s,n,a,o){const{param:r}=this.selectParam(t,s,a);if("custom_toggle"===r.type&&"sn_sounds_on"===r.key&&"boolean"==typeof n)return this.ls.setItem("sound_notify_off",String(Number(!n))),void this.optimisticSetParam(r,n);const c=this.optimisticSetParam(r,n);this.abortController?.abort();const l=new AbortController;this.abortController=l;try{await e({key:s,value:"boolean"==typeof n?String(n):n}),i({abortController:l},o)}catch(t){return this.checkError(t,c)}}optimisticSetParam(t,e){let i;return"boolean"==typeof e?(i=t.is_checked,t.is_checked=e):(i=t.value,t.value=e),()=>{"boolean"==typeof i?t.is_checked=i:t.value=i}}selectParam(t,e,i){let s,n;if(i?(n=t.find((t=>i===t.id)),s=n?.params?.find((t=>e===t.key))):n=t.find((t=>{const i=t.params.find((t=>e===t.key));if(i)return s=i,!0})),!s||!n)throw Error(`Can't find ${s?"section":"param"}. Param key: ${e}, Section id: ${i}`);return{param:s,section:n}}checkError(t,e){if("network_error"!==t.type||20!==t.error?.code)throw e?.(),t.error}constructor(t,e,i,s,a,o,r,c){this.accountApi=t,this.api=e,this.cookie=i,this.ls=s,this.settingsApi=a,this.userEnv=o,this.utilsApi=r,this.settingsAccountEventEmitter=c,this.data=[],this.notifyData=[],this.abortController=new AbortController,(0,n.l_)(this)}}y=(0,s.Cg)([a.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.y?Object:o.y,void 0===r.q?Object:r.q,void 0===c.H?Object:c.H,void 0===l.D?Object:l.D,void 0===d.K?Object:d.K,void 0===u.J?Object:u.J,void 0===h.E?Object:h.E,void 0===p.B?Object:p.B])],y)},809609:(t,e,i)=>{i.d(e,{K:()=>o});var s=i(331635),n=i(42107),a=i(820282);class o extends a.S{get namespace(){return"settings"}constructor(...t){super(...t),this.performEmailBannerAction=this.makeMethod("performEmailBannerAction"),this.startChangeEmail=this.makeMethod("startChangeEmail"),this.startChangeNotifyEmail=this.makeMethod("startChangeNotifyEmail")}}o=(0,s.Cg)([n.z8.global()],o)},630218:(t,e,i)=>{i.d(e,{S:()=>Y});var s=i(221020),n=i(992999),a=i(634164),o=i(815287),r=i(516427),c=i(638945),l=i(283815),d=i(971084),u=i(551082),h=i(413621),p=i(741509);const y="vkitThumb__thumb--dAPRC",g="vkitThumb__control--H46M4",m="vkitThumb__stubIcon--sQsud",A=({playing:t,active:e,src:i,controlClassName:n,equalizerClassName:o,size:r})=>(0,s.FD)("div",{className:y,children:[(0,s.Y)(h._,{src:i,size:r,borderRadius:"l",alt:"",fallbackIcon:(0,s.Y)(l.d,{className:m}),children:e&&(0,s.Y)(h._.Overlay,{theme:"dark",visibility:"always",children:(0,s.Y)(p.r,{playing:t,className:o})})}),(0,s.Y)("div",{className:(0,a.$)(g,n),children:t?(0,s.Y)(d.S,{}):(0,s.Y)(u.G,{})})]});var v=i(674585);const f="vkitArtist__artist--K864F",C="vkitArtist__artistClickable--5JWSo",_=({name:t,href:e,onClick:i})=>{const n=(0,v.b)({href:e,onClick:i});return(0,s.Y)(c.tW,{className:(0,a.$)(f,n&&C),onClick:i,href:e,Component:e?"a":void 0,children:t})},b=t=>t.reduce(((e,i,n)=>{const{name:a,href:r,onClick:c}=i,l=n!==t.length-1;return e.push((0,s.Y)(_,{name:a,href:r,onClick:c},a)),l&&e.push((0,s.Y)(o.Fragment,{children:", "},n)),e}),[]);var S=i(284146);const P="vkitMusicCell__tappable--ATWQs",k="vkitMusicCell__rootDisableOpacity--dAjmJ",E="vkitMusicCell__musicCell--BPs9t",I="vkitMusicCell__control--uY4lH",w="vkitMusicCell__equalizer--8PbJc",O="vkitMusicCell__before--4nJk8",F="vkitMusicCell__content--LFUiy",L="vkitMusicCell__titleLayout--1652V",x="vkitMusicCell__title--LpMwk",j="vkitMusicCell__badge--Dip62",M="vkitMusicCell__subtitle--rIuFU",N="vkitMusicCell__after--qYQx9",z="vkitMusicCell__duration--LfZ5g",Y=({className:t,title:e,duration:i,progress:l,artists:d=[],featuredArtists:u=[],explicit:h,hasThumbActivated:p,hasThumbPlaying:y,thumb:g,onClick:m,onThumbClick:v,thumbLabel:f,onThumbKeyDown:C,thumbSize:_=40,after:Y,disableOpacity:T,noticeIcon:D})=>{const W=(({duration:t=0,progress:e})=>t&&e?(0,S.a)(Math.round(e*t)):(0,S.a)(t))({duration:i,progress:l}),R=(0,o.isValidElement)(d)?d:b(d),H=b(u),B=D?(0,s.Y)("div",{className:j,children:D}):h&&(0,s.Y)(n.N,{className:j}),$=(0,o.isValidElement)(g)?g:(0,s.Y)(A,{active:p,playing:y,src:g,controlClassName:I,equalizerClassName:w,size:_});return(0,s.Y)(r.SB4,{className:(0,a.$)(P,T&&k),onClick:m,"data-testid":"music-cell",children:(0,s.FD)("div",{className:(0,a.$)(E,t),children:[v?(0,s.Y)("div",{className:O,"data-testid":"music-cell-thumb",onClick:v,tabIndex:0,"aria-label":f,role:"button",onKeyDown:t=>{"Enter"!==t.key&&"Space"!==t.key||C?.(t)},children:$}):(0,s.Y)("div",{className:O,"data-testid":"music-cell-thumb",children:$}),(0,s.FD)("div",{className:F,children:[(0,s.FD)("div",{className:L,children:[(0,s.Y)("span",{className:x,"data-testid":"music-cell-title",children:e}),B]}),(0,s.FD)(c.tW,{className:M,"data-testid":"music-cell-artists",children:[R,u.length>0&&(0,s.Y)(s.FK,{children:" feat. "}),H]})]}),(0,s.Y)("div",{className:N,children:Y||(0,s.Y)("span",{className:z,"data-testid":"music-cell-duration",children:W})})]})})}}}]),"undefined"!=typeof window&&window.stManager?.done?.("dist/core_spa/chunks/69094.16d45e8e.js")}catch(t){throw"undefined"!=typeof window&&window.stManager?.fail?.("dist/core_spa/chunks/69094.16d45e8e.js",t),t}