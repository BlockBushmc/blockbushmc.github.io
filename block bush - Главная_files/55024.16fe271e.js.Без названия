try{(self.webpackChunkvk=self.webpackChunkvk||[]).push([[55024],{502255:(e,t,s)=>{s.d(t,{$:()=>i});const i=e=>"string"!=typeof e||e.startsWith("data:")||e.startsWith("blob:")||function(e){const t=location.origin,s=new URL(e,t).origin;return s===t}(e)?null:"Anonymous"},536149:(e,t,s)=>{s.d(t,{r:()=>i});const i=e=>{if(e.type)return e.type.toLowerCase();const t=function(e){const t=e.name.split(".");return t.length<=1?"":t.pop()?.toLowerCase()||""}(e);return{heic:"image/heic",heif:"image/heif"}[t]||""}},724075:(e,t,s)=>{s.d(t,{M:()=>r});var i=s(815287),a=s(888817);const r=(e,t,s,r,n=2)=>{(0,i.useEffect)((()=>{const i=void 0===s?window:s;if(!e||!i)return;const o=(0,a.n)((()=>{const e=i instanceof Window?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight):Math.max(i.scrollHeight,i.clientHeight),s=i instanceof Window?document.documentElement.clientHeight:i.clientHeight,a=i instanceof Window?i.scrollY:i.scrollTop,o=s+a,c=Math.max(e-n*s,0);(!r&&o>=c||r&&a<s/2)&&t?.()}),34);return o(),i.addEventListener("scroll",o),()=>{i.removeEventListener("scroll",o)}}),[e,t,s,r])}},244509:(e,t,s)=>{s.d(t,{P:()=>i});const i=(e,t)=>(t=t||e.type.toLowerCase(),["image/heic","image/heif"].includes(t))},756452:(e,t,s)=>{s.d(t,{E:()=>r});var i=s(536149),a=s(244509);const r=e=>{const t=(0,i.r)(e);return(0,a.P)(e,t)}},648992:(e,t,s)=>{s.d(t,{y:()=>a});var i=s(502255);const a=(e,t)=>new Promise(((s,a)=>{const r=new Image;r.crossOrigin=(0,i.$)(e),t&&(r.dataset.name=t),r.onerror=()=>{const t=e?.startsWith("data:")?"<dataURL>":e;a(new Error(`Failed to load image's URL: ${t}`))},r.onload=()=>{s(r)},r.src=e}))},634478:(e,t,s)=>{s.d(t,{v:()=>d});var i=s(331635),a=s(42107),r=s(99201),n=s(327813),o=s(250096);class c{get rawId(){return(0,o._y)({id:this._data.id,ownerId:this._data.owner_id})}get data(){return this._data}constructor(e){this._data=e,(0,n.l_)(this)}}class d{createPhotoFromApi(e){const t=new c(e);return this.photosMap.set(t.rawId,t),t}createPhotosFromApi(e){return e.map((e=>this.createPhotoFromApi(e)))}getPhoto(e){return this.photosMap.get(e)}async fetchPhotosByIds(e){return(await this.photosApi.getById({photos:e.photos.join(","),extended:Number(e.extended??!1),photo_sizes:Number(e.photo_sizes??!1)})).map((e=>this.createPhotoFromApi(e)))}constructor(e){this.photosApi=e,this.photosMap=new Map,(0,n.l_)(this)}}d=(0,i.Cg)([a.z8.container(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0===r.U?Object:r.U])],d)},250096:(e,t,s)=>{s.d(t,{Iz:()=>a,Ox:()=>n,_y:()=>r});var i=s(144819);const a=e=>{if(void 0!==e)return e?1:0},r=e=>(0,i.WO)(e),n=e=>{const{id:t,owner_id:s}=e;return r({id:t,ownerId:s})}},208712:(e,t,s)=>{s.d(t,{T:()=>d});var i=s(331635),a=s(327813),r=s(24584),n=s(42107),o=s(553968),c=s(382627);class d{createUserFromApiData(e,t){const s=new o.$(e);return t&&(this._cacheByIds.set(s.data.id,s),s.data.domain&&this._cacheByDomains.set(s.data.domain,s.data.id)),s}async fetch({user_ids:e,domains:t,fields:s=[],usePrefetch:i=!1,...a}={},r){const n=Array.from(new Set(s)),o=Array.from(new Set(e)),c=Array.from(new Set(t));if(o.length||c.length){const t=a;e?.length&&(t.user_ids=e.join(",")),c?.length&&(t.domains=c.join(",")),n?.length&&(t.fields=n.join(","));const s=(await(i?this.usersApi.getWithPrefetch:this.usersApi.get)(t,r)).filter(Boolean).map((e=>({data:e,fields:n})));return this.addToCache(s,!0)}return this.getCachedUsers({ids:o,domains:c})}async ensure({user_ids:e,domains:t,fields:s=[],...i}={},a){const r=Array.from(new Set(e)),n=Array.from(new Set(t)),o=r.reduce(((e,t)=>(this.isInfoMissing(t,s)&&e.push(t),e)),[]),c=n.reduce(((e,t)=>{const i=this._cacheByDomains.get(t);return i&&this.isInfoMissing(i,s)&&e.push(t),e}),[]);return o.length||c.length?await this.fetch({user_ids:o,domains:c,fields:s,usePrefetch:!0,...i},a):this.getCachedUsers({ids:r,domains:n})}getCachedUsers({ids:e=[],domains:t=[]}){const s=new Map;return new Set([...e,...t.reduce(((e,t)=>{const s=this._cacheByDomains.get(t);return s&&e.push(s),e}),[])]).forEach((e=>{const t=this._cacheByIds.get(e);t&&s.set(e,t)})),s}addToCache(e,t=!0){const s=new Map;return e.forEach((e=>{const i=e.data.id,a=this._cacheByIds.get(i);a&&!t||(a?.data?.domain&&a.data.domain!==e.data.domain&&this._cacheByDomains.delete(a.data.domain),s.set(i,this.createUserFromApiData(e,!0)))})),s}isInfoMissing(e,t){const s=this._cacheByIds.get(e);return!s||!(0,c.P)(s,t)}constructor(e){this.usersApi=e,this._cacheByIds=new Map,this._cacheByDomains=new Map,(0,a.l_)(this)}}d=(0,i.Cg)([n.z8.container(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0===r.l?Object:r.l])],d)},553968:(e,t,s)=>{s.d(t,{$:()=>a});var i=s(327813);class a{get fields(){return Array.from(this._fields.values())}get id(){return this.data.id}get data(){return this._data}async fetch({fields:e=[],...t}={},s){if(!this.usersApi)throw new Error("UsersApi instance is not provided");const i=Array.from(new Set([...e,...this.fields]).values()),[a]=await this.usersApi.get({user_ids:this.id.toString(),fields:i.join(","),name_case:"Nom",...t},s);if(!a)throw new Error("Could not fetch data for user, empty data was returned");return this.setData({data:a,fields:i}),this.data}setFields(e){this._fields.clear(),new Set(e).forEach((e=>this._fields.add(e)))}setData(e){const{data:t,fields:s=[]}=e;if(t.id!==this.id)throw new Error("Trying to change id of an existing User instance");this._data=t,this.setFields([...s])}constructor(e,t){this.usersApi=t,this._fields=new Set;const{data:s,fields:a=[]}=e;this._data=s,this.setFields([...a]),(0,i.l_)(this)}}},382627:(e,t,s)=>{s.d(t,{P:()=>i});const i=(e,t=[])=>{const s=new Set(e.fields);return new Set([...e.fields,...t]).size===s.size}},4176:(e,t,s)=>{s.d(t,{J:()=>c});var i=s(331635),a=s(42107),r=s(186742),n=s(327813);class o{getIsLoading(e){return!!this.loadings.get(e)}setValue(e,t){this.data.set(e,t)}getValue(e){return this.data.get(e)}async edit(e,t){if(this.loadings.get(e))return this.loadings.get(e);try{this.loadings.set(e,t()),await this.loadings.get(e)}catch(e){this.errorBoundary(e)}finally{(0,n.h5)((()=>{this.loadings.set(e,null)}))}}constructor(e=e=>console.error(e)){this.data=new Map,this.loadings=new Map,this.errorBoundary=e,(0,n.l_)(this)}}class c{async toggle(e,t){const s=this.getIsFavorite(e.id);if(void 0!==s)return s?this.remove(e,t):this.add(e,t)}add(e,t){return this.baseFieldService.edit(e.id,(async()=>{const s={owner_id:e.ownerId,id:e.id,source:e.source,ref:e.ref};await this.faveApi.addVideo(s,t),this.setIsFavorite(e.id,!0)}))}remove(e,t){return this.baseFieldService.edit(e.id,(async()=>{const s={owner_id:e.ownerId,id:e.id,source:e.source,ref:e.ref};await this.faveApi.removeVideo(s,t),this.setIsFavorite(e.id,!1)}))}setIsFavorite(e,t){if(void 0!==t)return this.baseFieldService.setValue(e,t)}getIsFavorite(e){return this.baseFieldService.getValue(e)}constructor(e){this.faveApi=e,this.baseFieldService=new o,(0,n.l_)(this)}}c=(0,i.Cg)([a.z8.global(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0===r.L?Object:r.L])],c)},104416:(e,t,s)=>{s.d(t,{R:()=>o});var i=s(331635),a=s(42107),r=s(419692),n=s(327813);class o{async add(e,t){const s={type:e.type,owner_id:e.ownerId,item_id:e.itemId,from_group:e.fromGroup,track_code:e.trackCode,ref:e.ref};return await this.likesApi.add(s,t)}async remove(e,t){const s={type:e.type,owner_id:e.ownerId,item_id:e.itemId,from_group:e.fromGroup,track_code:e.trackCode,ref:e.ref};return await this.likesApi.delete(s,t)}constructor(e){this.likesApi=e,(0,n.l_)(this)}}o=(0,i.Cg)([a.z8.container(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0===r.d?Object:r.d])],o)},197834:(e,t,s)=>{s.d(t,{m:()=>i});const i=e=>void 0!==e.id&&void 0!==e.owner_id},527992:(e,t,s)=>{s.d(t,{K:()=>o});var i=s(331635),a=s(327813),r=s(998286),n=s(42107);class o{create(e){return this.wallApi.post(e)}createAdsStealth(e){return this.wallApi.postAdsStealth(e)}fetchPost(e){return this.wallApi.getPostById(e)}edit(e){return this.wallApi.edit(e)}fetchPostingSettings(e){return this.wallApi.getPostingSettings(e)}constructor(e){this.wallApi=e,(0,a.l_)(this)}}o=(0,i.Cg)([n.z8.container(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[void 0===r.t?Object:r.t])],o)},383753:(e,t,s)=>{s.d(t,{o:()=>n});var i=s(331635),a=s(820282),r=s(42107);class n extends a.S{get namespace(){return"bestFriends"}constructor(...e){super(...e),this.get=this.makeMethod("get"),this.getWithFields=this.makeMethod("get"),this.batchEdit=this.makeMethod("batchEdit")}}n=(0,i.Cg)([r.z8.global()],n)},419692:(e,t,s)=>{s.d(t,{d:()=>n});var i=s(331635),a=s(42107),r=s(820282);class n extends r.S{get namespace(){return"likes"}constructor(...e){super(...e),this.add=this.makeMethod("add"),this.delete=this.makeMethod("delete"),this.getList=this.makeMethod("getList"),this.isLiked=this.makeMethod("isLiked")}}n=(0,i.Cg)([a.z8.global()],n)},518227:(e,t,s)=>{s.d(t,{i:()=>a});var i=s(815287);function a(e){const[t,s]=(0,i.useState)(e),a=(0,i.useRef)(t);return[t,(0,i.useCallback)((e=>{const t=e instanceof Function?e(a.current):e;a.current=t,s(t)}),[]),a]}},336888:(e,t,s)=>{s.d(t,{h:()=>a,i:()=>i});const i=RegExp("\\[#blur\\|(?<obscene>[^|\\]]+)\\|(?<blur>[&$!#%]+)]","g");class a{parseObsceneTags(){const e={};for(const t of this._regExpExecArray){const{obscene:s,blur:i}=t.groups??{};s&&(e[s]=i)}return e}get obsceneWordsCount(){return this._regExpExecArray.length}encodeObscene(){return this._obsceneWordList.length?this._text.replace(i,"$1"):this._text}constructor(e){this._text=e,this._regExpExecArray=Array.from(this._text.matchAll(i)),this._blurByObscene=this.parseObsceneTags(),this._obsceneWordList=Object.keys(this._blurByObscene),this._obsceneWordsRegex=new RegExp(this._obsceneWordList.join("|"),"g"),this.getObsceneBlurArray=e=>{if(!this._obsceneWordList.length)return e;const t=e.split(this._obsceneWordsRegex),s=e.match(this._obsceneWordsRegex);if(!s?.length)return e;const i=[];return t.forEach(((e,t)=>{if(i.push(e),t>=s.length)return;const a=s[t],r=this._blurByObscene[a];i.push({obsceneBlur:{obscene:a,blur:r}})})),i}}}},965970:(e,t,s)=>{s.d(t,{r:()=>M});var i=s(104650),a=s(233536),r=s(725308);const n="\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј%",o="(https?:\\/\\/)?",c="((?:["+n+"\\—\\-\\_]+\\.){1,5})",d="([A-Za-zа-яА-Я\\-\\d]{2,22})",l="(?:\\:(\\d{2,5}))?",h="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",g="\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$~=;:'*"+h+"　-〿＀-￯",p="(([\\/?#])(?:\\&amp;|\\&|\\&#\\d{2,6};|,[_%]|!|,*"+("(?:["+g+"]|[.](?!\\s|$|[^."+g+"]))")+"+|"+("(?:\\(|\\[)["+n+"\\d&#%;,]+(?:\\)|\\])")+"){0,200})?",u=new Set([..."aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),..."бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),..."qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map((e=>"xn--"+e))]),m=[...u].reduce(((e,t)=>Math.max(e,t.length)),0),b=`${h}a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’`,f="(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)",v=`(?:[${b}]|${f})`,y=`(?:[${b}_\\d]|${f})`,_=e=>e&&Number.isInteger(e)&&(r.z.isUserId(e)||r.z.isGroupId(e)||r.z.isChatOrChannelPeer(e)||r.z.isContactId(e))?e:0,k=e=>{try{return decodeURIComponent(e)}catch(t){return e}},w=e=>i.createLanguage({ClientChunks:t=>i.alt(e?.features?.feed_redesign_text_react_post?t.LineBreakWithParagraph:t.LineBreak,t.Email,t.Url,e?.features?.feed_redesign_fix_hashtag_mention?t.HashtagMentionFeed:t.HashtagMention,t.Hashtag,t.MassMention,t.Mention,e?.features?.feed_redesign_fix_mention?t.ScreenNameMentionFeed:t.ScreenNameMention,t.Text).many(),LineBreak:()=>i.regexp(/\n|<br ?\/?>/).map((()=>({kind:"LineBreak"}))),LineBreakWithParagraph:()=>{const t=e.features?.fix_double_br_in_line_break_with_paragraph?/(\n\s*\n)|(<br ?\/?>\s*<br ?\/?>)|(\n){1,2}|(<br ?\/?>){1,2}/:/(\n){1,2}|(<br ?\/?>){1,2}/;return i.regexp(t).map((t=>{const s=t.split(/(\n)|(<br ?\/?>)/).map((e=>"\n"===e?e:e&&e.trim())).filter(Boolean).length;return{kind:"LineBreak",type:(e.features?.fix_double_br_in_line_break_with_paragraph?s>=2:2===s)?"paragraph":"break"}}))},ScreenName:()=>i.seqObj(["prefix",i.oneOf("@*")],["handle",i.alt(i.digit,i.letter,i.string("_")).atLeast(2).map((e=>e.join("")))]),ScreenNameFeed:()=>i.seqObj(["prefix",i.oneOf("@")],["handle",i.alt(i.digit,i.letter,i.string("_"),i.string(".")).atLeast(2).map((e=>e.join("")))]),MassMention:()=>i.regexp(/(?!,|;|:|\.|\s|\n|"|\(|\)|\[|\]|!|\?)([*@](all|everyone|все|online|here|здесь|тут))(?=$|,|;|:|<br ?\/?>|\.(?![a-z0-9_-])|\s|\n|"|\(|\)|\[|\]|!|\?)/i,1).map((e=>({kind:"MassMention",displayName:e}))),Mention:()=>i.seqObj(i.string("["),["type",i.alt(i.string("id"),i.string("club"))],["peerId",i.digit.atLeast(1).map((e=>+e.join("")))],["displayName",i.regexp(/\|(.+?)]/,1)]).map((e=>{let t;return t="club"===e.type?_(-e.peerId):0===e.peerId?_():_(e.peerId),{kind:"Mention",type:e.type,peerId:t,displayName:e.displayName}})),ScreenNameMention:e=>i.seqObj(["screenName",e.ScreenName],["displayName",i.alt(i.seq(i.whitespace,i.regexp(/\((.+?)\)/,1)).map((([,e])=>e)),i.succeed(void 0))]).map((e=>({kind:"ScreenNameMention",screenName:e.screenName.handle,displayName:e.displayName}))),ScreenNameMentionFeed:e=>i.seqObj(["screenName",e.ScreenNameFeed],["displayName",i.alt(i.seq(i.whitespace,i.regexp(/\((.+?)\)/,1)).map((([,e])=>e)),i.succeed(void 0))]).map((e=>({kind:"ScreenNameMention",screenName:e.screenName.handle,displayName:e.displayName}))),Url:()=>{const t=i.seqObj(i.string("["),["protocol",i.regexp(new RegExp(o,"i"))],["fullDomain",i.regexp(new RegExp("(?:m\\.)?vk\\.com|(?:m\\.)?vk\\.ru|(?:m\\.)?vkvideo\\.ru|vk\\.me|web\\.vk\\.me","i"))],i.regexp(new RegExp("(?!/away\\.php)","i")),["query",i.regexp(new RegExp(p))],["displayName",i.regexp(/\|(.+?)]/,1)]).map((t=>{const{protocol:s,fullDomain:i,query:r,displayName:n}=t,o=`${s||"http://"}${i}${r}`,c=`[${s}${i}${r}|${n}]`;return C(e,{kind:"Url",caption:n,href:(0,a.Lt)(o),originalUrl:c},Boolean(e?.features?.fix_cyrillic_in_external_plain_urls))})),s=i.seq(i.regexp(new RegExp(o,"i")),i.regexp(new RegExp(c)),i.regexp(new RegExp(d)),i.regexp(new RegExp(l)),i.regexp(new RegExp(p))).map((t=>{const[s,i,r,n,o]=t,c=`${s||"http://"}${i}${r}${n}${o}`,d=t.join("");return r.length<=m&&u.has(r.toLowerCase())?C(e,{kind:"Url",caption:k((0,a.Lt)(d)),href:(0,a.Lt)(c),originalUrl:d},Boolean(e?.features?.fix_cyrillic_in_external_plain_urls)):{kind:"Text",text:d}}));return i.alt(t,s)},Hashtag:()=>i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`,"u")).map((e=>({kind:"Hashtag",tag:e}))),HashtagMention:e=>i.seqObj(["tag",i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`))],["screenName",e.ScreenName]).map((e=>({kind:"Hashtag",tag:e.tag,screenName:e.screenName.handle}))),HashtagMentionFeed:e=>i.seqObj(["tag",i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`))],["screenName",e.ScreenNameFeed]).map((e=>({kind:"Hashtag",tag:e.tag,screenName:e.screenName.handle}))),Email:()=>i.regexp(new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@("+c+d+"))","i")).map((e=>({kind:"Email",email:e}))),Text:()=>i.any.map((e=>({kind:"Text",text:e})))}),x=e=>i.createLanguage({ClientChunks:t=>i.alt(e?.features?.feed_redesign_text_react_post?t.LineBreakWithParagraph:t.LineBreak,t.Email,t.AliasedUrl,t.Url,e?.features?.feed_redesign_fix_hashtag_mention?t.HashtagMentionFeed:t.HashtagMention,t.Hashtag,t.MassMention,t.Mention,e?.features?.feed_redesign_fix_mention?t.ScreenNameMentionFeed:t.ScreenNameMention,t.Text).many(),LineBreak:()=>i.regexp(/\n|<br ?\/?>/).map((()=>({kind:"LineBreak"}))),LineBreakWithParagraph:()=>{const t=e.features?.fix_double_br_in_line_break_with_paragraph?/(\n\s*\n)|(<br ?\/?>\s*<br ?\/?>)|(\n){1,2}|(^(<br ?\/?>){1,2}\u200b*|\u200b*(<br ?\/?>){1,2})/:/(\n){1,2}|(^(<br ?\/?>){1,2}\u200b*|\u200b*(<br ?\/?>){1,2})/;return i.regexp(t).map((t=>{const s=t.split(/(\n)|(<br ?\/?>)/).map((e=>"\n"===e?e:e&&e.trim())).filter(Boolean).length;return{kind:"LineBreak",type:(e.features?.fix_double_br_in_line_break_with_paragraph?s>=2:2===s)?"paragraph":"break"}}))},ScreenName:()=>i.seqObj(["prefix",i.oneOf("@*")],["handle",i.alt(i.digit,i.letter,i.string("_")).atLeast(2).map((e=>e.join("")))]),ScreenNameFeed:()=>i.seqObj(["prefix",i.oneOf("@")],["handle",i.alt(i.digit,i.letter,i.string("_"),i.string(".")).atLeast(2).map((e=>e.join("")))]),AliasedUrl:()=>i.seqObj(i.string("[#alias|"),["shortenedUrl",i.regexp(/[-a-zA-Zа-яА-Я0-9ёЁєЄҐґЇїІіЈј%@:._\+~#=]{1,256}\.[a-zA-Zа-яА-Я0-9ёЁ()]{1,6}[-a-zA-Zа-яА-Я0-9ёЁ()@:%_\+.,~#?&/=\*\s]*/i)],i.string("|"),["protocol",i.regexp(new RegExp(o,"i"))],["url",i.regexp(/[-a-zA-Zа-яА-Я0-9ёЁєЄҐґЇїІіЈј%@:._\+~#=]{1,256}\.[a-zA-Zа-яА-Я0-9ёЁ()]{1,6}[-a-zA-Zа-яА-Я0-9ёЁ()@:%_\+.,~#?&/=\*{}!№]*/i)],["query",i.regexp(new RegExp(p))],i.string("]")).map((t=>{const{protocol:s,url:i,query:r,shortenedUrl:n}=t,o=`${s||"http://"}${i}${r}`,c=`${s}${i}${r}`,d=`[#alias|${n}|${c}]`;return function(e,t,s=!1){return{...t,...S(t,s,e)}}(e,{kind:"AliasedUrl",caption:n,href:(0,a.Lt)(o),originalUrl:d,originalHref:c},Boolean(e?.features?.fix_cyrillic_in_external_plain_urls))})),MassMention:()=>i.regexp(/(?!,|;|:|\.|\s|\n|"|\(|\)|\[|\]|!|\?)([*@](all|everyone|все|online|here|здесь|тут))(?=$|,|;|:|<br ?\/?>|\.(?![a-z0-9_-])|\s|\n|"|\(|\)|\[|\]|!|\?)/i,1).map((e=>({kind:"MassMention",displayName:e}))),Mention:()=>i.seqObj(i.string("["),["type",i.alt(i.string("id"),i.string("club"))],["peerId",i.digit.atLeast(1).map((e=>+e.join("")))],["displayName",i.regexp(/\|(.+?)]/,1)]).map((e=>{let t;return t="club"===e.type?_(-e.peerId):0===e.peerId?_():_(e.peerId),{kind:"Mention",type:e.type,peerId:t,displayName:e.displayName}})),ScreenNameMention:e=>i.seqObj(["screenName",e.ScreenName],["displayName",i.alt(i.seq(i.whitespace,i.regexp(/\((.+?)\)/,1)).map((([,e])=>e)),i.succeed(void 0))]).map((e=>({kind:"ScreenNameMention",screenName:e.screenName.handle,displayName:e.displayName}))),ScreenNameMentionFeed:e=>i.seqObj(["screenName",e.ScreenNameFeed],["displayName",i.alt(i.seq(i.whitespace,i.regexp(/\((.+?)\)/,1)).map((([,e])=>e)),i.succeed(void 0))]).map((e=>({kind:"ScreenNameMention",screenName:e.screenName.handle,displayName:e.displayName}))),Url:()=>{const t=i.seqObj(i.string("["),["protocol",i.regexp(new RegExp(o,"i"))],["fullDomain",i.regexp(new RegExp("(?:m\\.)?vk\\.com|(?:m\\.)?vk\\.ru|(?:m\\.)?vkvideo\\.ru|vk\\.me|web\\.vk\\.me","i"))],i.regexp(new RegExp("(?!/away\\.php)","i")),["query",i.regexp(new RegExp(p))],["displayName",i.regexp(/\|(.+?)]/,1)]).map((t=>{const{protocol:s,fullDomain:i,query:r,displayName:n}=t,o=`${s||"http://"}${i}${r}`,c=`[${s}${i}${r}|${n}]`;return C(e,{kind:"Url",caption:n,href:(0,a.Lt)(o),originalUrl:c},Boolean(e?.features?.fix_cyrillic_in_external_plain_urls))})),s=i.seq(i.regexp(new RegExp(o,"i")),i.regexp(new RegExp(c)),i.regexp(new RegExp(d)),i.regexp(new RegExp(l)),i.regexp(new RegExp(p))).map((t=>{const[s,i,r,n,o]=t,c=`${s||"http://"}${i}${r}${n}${o}`,d=t.join("");return r.length<=m&&u.has(r.toLowerCase())?C(e,{kind:"Url",caption:k((0,a.Lt)(d)),href:(0,a.Lt)(c),originalUrl:d},Boolean(e?.features?.fix_cyrillic_in_external_plain_urls)):{kind:"Text",text:d}}));return i.alt(t,s)},Hashtag:()=>i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`,"u")).map((e=>({kind:"Hashtag",tag:e}))),HashtagMention:e=>i.seqObj(["tag",i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`))],["screenName",e.ScreenName]).map((e=>({kind:"Hashtag",tag:e.tag,screenName:e.screenName.handle}))),HashtagMentionFeed:e=>i.seqObj(["tag",i.regexp(new RegExp(`#${y}{0,100}${v}${y}{0,100}`))],["screenName",e.ScreenNameFeed]).map((e=>({kind:"Hashtag",tag:e.tag,screenName:e.screenName.handle}))),Email:()=>i.regexp(new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@("+c+d+"))","i")).map((e=>({kind:"Email",email:e}))),Text:()=>i.any.map((e=>({kind:"Text",text:e})))});function S(e,t=!1,s){try{let i,a;return void 0!==s.maybeStripVKSiteURLOriginAnySubdomain(e.href.toLowerCase())?(i=!0,a=e.href):(i=!1,a=s.wrapAwayIfExternal(e.href,t)),{href:a,isInternal:i}}catch(e){return console.error(e),{href:"",isInternal:!0}}}function C(e,t,s=!1){return{...t,...S(t,s,e)}}function M(e,t){if(t.features?.isAliasedUrlEnabled){return function(e,t){if(0===t.length)return[];try{const s=[],i=e.tryParse(t);for(const e of i)if("Text"===e.kind){const t=s[s.length-1],i=(0,a.Lt)(e.text);"Text"===t?.kind?t.text+=i:s.push({kind:"Text",text:i})}else s.push(e);return s}catch(e){return console.error(e),[]}}(x(t).ClientChunks,e)}return function(e,t){if(0===t.length)return[];try{return e.tryParse(t).reduce(((e,t)=>{if("Text"===t.kind){const s=e[e.length-1];"Text"===s?.kind?s.text+=t.text:e.push({kind:"Text",text:t.text})}else e.push(t);return e}),[]).map((e=>"Text"===e.kind?{kind:"Text",text:(0,a.Lt)(e.text)}:e))}catch(e){return console.error(e),[]}}(w(t).ClientChunks,e)}},229767:(e,t,s)=>{s.d(t,{f:()=>c});var i=s(221020),a=s(634164),r=s(772812),n=s(56471),o=s(516427);const c=({obscene:e,blur:t,unblurred:s,accented:c,dataId:d,tooltipText:l,className:h,...g})=>(0,i.Y)(n.f,{text:l,placement:"top",appearance:"black",children:(0,i.Y)(o.SB4,{...g,className:(0,a.$)(h,!s&&c&&(0,r.I)("color_text_secondary")),Component:"span",hasHover:!1,hasActive:!1,role:"button",tabIndex:0,"data-analytics-hash":"","data-testid":"blurred_obscene_text","data-id":d,children:s?e:t})})},440661:(e,t,s)=>{s.d(t,{L:()=>A});var i=s(221020),a=s(634164),r=s(815287);const n=(0,r.createContext)({direction:"vertical"}),o=n.Provider;var c=s(638945);const d="vkitRoundedGroupItem__wrapper--0lEK2",l="vkitRoundedGroupItem__root--5p5Ti",h="vkitRoundedGroupItem__rootStretched--MdCva",g="vkitRoundedGroupItem__bottom--216HX",p="vkitRoundedGroupItem__rootNegative--eORyl",u={border:"vkitRoundedGroupItem__rootBorder--NrdTo",shadow:"vkitRoundedGroupItem__rootShadow--UPHsE",overlay:"vkitRoundedGroupItem__rootOverlay--8vKZR",avatarOverlay:"vkitRoundedGroupItem__rootAvatarOverlay--kMLMw",negative:"vkitRoundedGroupItem__rootModeNegative--QdltF",accent:"vkitRoundedGroupItem__rootAccent--U5E4F",transparent:void 0,contrast:"vkitRoundedGroupItem__rootContrast--VP0NR",secondary:"vkitRoundedGroupItem__rootSecondary--mbbSv",outline:"vkitRoundedGroupItem__rootOutline--jj3hf"},m={border:void 0,shadow:void 0,overlay:void 0,avatarOverlay:void 0,negative:void 0,accent:void 0,transparent:"vkitRoundedGroupItem__wrapperTransparent--gXRKE",contrast:void 0,secondary:void 0,outline:void 0},b={negative:p,default:void 0},f={negative:p,default:void 0};var v=s(704399);const y="vkitRoundedGroupSeparatorSpacing__rootVertical--ZQC0k",_="vkitRoundedGroupSeparatorSpacing__rootHorizontal--VYBtX",k={vertical:y,"vertical-left":y,"vertical-right":y,horizontal:_,"horizontal-left":_,"horizontal-center":_,"horizontal-right":_},w={vertical:"horizontal","vertical-left":"horizontal","vertical-right":"horizontal",horizontal:"vertical","horizontal-left":"vertical","horizontal-center":"vertical","horizontal-right":"vertical"},x="vkitRoundedGroup__root--D0duh",S="vkitRoundedGroup__rootLeft--06VTa",C="vkitRoundedGroup__rootRight--JDq28",M="vkitRoundedGroup__rootWithGap--J9ZFE",U="vkitRoundedGroup__rootHorizontal--1nkw8",E="vkitRoundedGroup__rootCenter--fsRMD",L="vkitRoundedGroup__rootVertical--cVB7h",N={vertical:L,"vertical-left":(0,a.$)(L,S),"vertical-right":(0,a.$)(L,C),horizontal:U,"horizontal-left":(0,a.$)(U,S),"horizontal-center":(0,a.$)(U,E),"horizontal-right":(0,a.$)(U,C)},A=Object.assign((({gap:e,direction:t,...s})=>{const n=(0,r.useMemo)((()=>({direction:t})),[t]),c={"--rounded-group-gap":`${e??0}px`};return(0,i.Y)(o,{value:n,children:(0,i.Y)("div",{"data-testid":"roundedgroup",className:(0,a.$)(x,e&&M,N[t]),style:c,...s})})}),{Item:({mode:e="shadow",appearance:t="default",spacing:s=0,bottom:r,stretched:n,getRootRef:o,children:p,className:v})=>{const y={"--rounded-spacing":`${s}px`},_=(0,i.Y)("div",{ref:o,className:(0,a.$)(l,u[e],b[t],n&&h,v),style:y,children:p});return r?(0,i.FD)("div",{"data-testid":"roundedgroupitem",className:(0,a.$)(d,m[e],f[t]),children:[_,(0,i.Y)(c.tW,{"data-testid":"roundedgroupitem-bottom",className:g,weight:"1",children:r})]}):_},SeparatorSpacing:e=>{const{direction:t}=(0,r.useContext)(n);return(0,i.Y)(v.F,{className:k[t],mode:w[t],direction:w[t],...e})}})},954828:(e,t,s)=>{s.d(t,{K:()=>O});var i=s(221020),a=s(42107),r=s(946918),n=s(370633),o=s(721990),c=s(999051),d=s(516427),l=s(356035),h=s(504835),g=s(685441),p=s(837002),u=s(505174),m=s(409698),b=s(794135);const f=({conversations:e,selected:t,moreCount:s,clickable:a,pending:o,pendingMembers:l,onRemove:f,onAdd:v,onMoreClick:y})=>{const _=(0,r.B)();return e.length?(0,i.FD)(n.Y,{mode:"plain",children:[(0,i.Y)(g.Y,{mode:"tertiary","data-testid":"conversation-caption",children:_.getLang("widgets_privacy_best_friends_edit_box_conversations_header")}),e.map((e=>(0,i.Y)(p.f,{"data-testid":"conversation-cell",Component:"label",hasActive:a,hasHover:a,before:(0,i.Y)(u.e,{size:40,src:e.photoUrl,gradientColor:(0,d.NTc)(e.id),initials:e.name.length?e.name[0]:""}),subtitle:_.numeric(e.usersCount,_.getLang("global_app_friends_count",!0)),after:!a&&(t?.includes(e.id)?(0,i.Y)(m.$,{mode:"tertiary","data-testid":"conversation-undo-btn",onClick:()=>f?.(e.id),children:_.getLang("global_undo")}):(0,i.Y)(m.$,{mode:"secondary","data-testid":"conversation-add-btn",loading:l?.[e.id]?.requested&&l?.[e.id].pending,onClick:()=>v?.(e.id),children:_.getLang("global_add")})),onClick:()=>a&&v?.(e.id),children:e.name},e.id))),!!s&&(0,i.Y)(b.D,{disabled:o,"data-testid":"conversations-more-btn",before:o?(0,i.Y)(c.y,{}):(0,i.Y)(h.r,{}),onClick:()=>!o&&y?.(),children:_.numeric(s,_.getLang("widgets_privacy_best_friends_edit_box_conversations_load_more_button_text",!0))})]}):(0,i.Y)(d.wi6,{children:_.getLang("widgets_privacy_conversations_empty")})};var v=s(167957),y=s(331635),_=s(993006),k=s(877351),w=s(63366),x=s(327813),S=s(275860),C=s(601884);function M(e){return{id:e.peer.id,name:e.chat_settings?.title??"",photoUrl:e.chat_settings?.photo?.photo_200??"",usersCount:e.chat_settings?.friends_count??0}}var U=s(797719);var E=s(14120);class L{get events(){return this.emitter.listenable}async fetch(){this.setPending(!0),await this.fetchConversations(),this.setPending(!1)}updateSelectedConversations(e){if(this.selectedIds=e.map((e=>e.id)),this.skipUpdateSelectedConversations)return;const t=[];Object.keys(this.conversationsMembers).forEach((e=>{const s=parseInt(e),i=this.conversationsMembers[s]||[];this.getSelectedMembers(i)&&t.push(s)})),this.setSelected(t)}conversationAdd(e){if(this.selected.includes(e))return;if(this.pendingMembers[e].pending)return void(this.pendingMembers[e].requested||this.setRequestedConversationMembers(e,!0));const t=this.conversationsMembers[e]??[];this.setSelected([...this.selected,e]),this.skipUpdateSelectedConversations=!0,this.emitter.emit("addSelectedUsers",t),this.skipUpdateSelectedConversations=!1}conversationRemove(e){const t=this.selected.indexOf(e);if(-1===t)return;const s=[...this.selected];s.splice(t,1),this.setSelected(s);const i=this.conversationsMembers[e]??[];this.skipUpdateSelectedConversations=!0,this.emitter.emit("removeSelectedUsers",i),this.skipUpdateSelectedConversations=!1}async fetchSearch(e){this.search=e,this.conversationsSearch=[],this.search&&(this.setPending(!0),await this.fetchConversationsSearch(),this.setPending(!1))}async fetchConversations(){if(!this.pending&&this.availableMoreConversations){this.setPending(!0);try{const{items:e,count:t}=await this.messagesApi.getConversations({offset:this.conversations.length,count:L.MAX_COUNT_MORE_CONVERSATIONS,extended:1,filter:"chats"}),s=e.every((e=>{const t=e.conversation.chat_settings?.friends_count;return"number"==typeof t&&t>0}));if(s){const s=await Promise.all(e.map((async e=>(this.fetchConversationUsers(e.conversation),M(e.conversation)))));this.updateConversations(s,t)}else this.updateConversations([],0)}catch(e){this.emitter.emit("error",new Error(E.e.FAIL_FETCH_CONVERSATIONS,{cause:e}))}this.setPending(!1)}}async fetchConversationsSearch(){try{const{items:e}=await this.messagesApi.searchConversations({q:this.search}),t=e.reduce(((e,t)=>{if("chat"===t.peer.type&&t.chat_settings?.friends_count){this.fetchConversationUsers(t);const s=M(t);s.usersCount&&e.push(s)}return e}),[]);this.updateConversationsSearch(t)}catch(e){this.emitter.emit("error",new Error(E.e.FAIL_FETCH_CONVERSATIONS,{cause:e}))}}async fetchConversationUsers(e){const t=e.peer.id;if(!(t in this.conversationsMembers)&&!this.pendingMembers[t]?.pending&&e.chat_settings?.friends_count)try{this.setPendingConversationMembers(t,!0);const{items:e,profiles:s}=await this.messagesApi.getConversationMembers({peer_id:t,filter:"friends",fields:C.b.join(),extended:1},{version:"5.243"}),i=function(e,t){return e.reduce(((e,s)=>{const i=t?.find?.((e=>e.id===s.member_id));if(i){const t=(0,U.G)(i);e.push(t)}return e}),[])}(e,s);this.setConversationMembers(t,i),this.setPendingConversationMembers(t,!1),this.onConversationMembersReceived(t)}catch(e){this.setPendingConversationMembers(t,!1),this.emitter.emit("error",new Error(E.e.FAIL_FETCH_CONVERSATION_USERS,{cause:e}))}}setSelected(e){this.selected=e,this.emitter.emit("selected",this.selected)}setPending(e){this.pending=e,this.emitter.emit("pending",this.pending)}setPendingConversationMembers(e,t){this.pendingMembers={...this.pendingMembers,[e]:{...this.pendingMembers[e]||{},pending:t}}}setRequestedConversationMembers(e,t){this.pendingMembers={...this.pendingMembers,[e]:{...this.pendingMembers[e]||{},requested:t}}}setConversationMembers(e,t){this.conversationsMembers[e]=t}getSelectedMembers(e){return e.length>0&&e.every((e=>this.selectedIds.includes(e.id)))}onConversationMembersReceived(e){const t=this.conversationsMembers[e]||[];(this.getSelectedMembers(t)||this.pendingMembers[e]?.requested)&&this.conversationAdd(e)}updateConversations(e,t){this.conversations=[...this.conversations,...e],this.availableMoreConversations=Math.max(Math.min(t-this.conversations.length,L.MAX_COUNT_MORE_CONVERSATIONS),0)}updateConversationsSearch(e){this.conversationsSearch=[...this.conversationsSearch,...e]}constructor(e){this.messagesApi=e,this.search="",this.selected=[],this.availableMoreConversations=L.MAX_COUNT_MORE_CONVERSATIONS,this.pending=!1,this.pendingMembers={},this.conversations=[],this.conversationsMembers={},this.conversationsSearch=[],this.skipUpdateSelectedConversations=!1,this.selectedIds=[],this.emitter=new S.v,(0,x.l_)(this,{selected:x.sH.ref,conversations:x.sH.ref,conversationsMembers:x.sH.ref,conversationsSearch:x.sH.ref,pendingMembers:x.sH.ref})}}L.MAX_COUNT_MORE_CONVERSATIONS=2;var N=s(30321),A=s(597100);class R{async[a.Ts]({config:e,scrollRef:t}){this.config=e,this.scrollRef=t,this.listenErrors(),this.listenNextPage(),this.listenSelectedUsers(),this.listenConversationAddUsers(),this.listenConversationRemoveUsers(),await this.fetch(),this.config?.usersSelected?.length||this.selectableUsersList.addSelectedUsers(this.selectableUsersList.users.slice(0,10))}async[a.zr](){this.subscriptions.forEach((e=>e())),this.subscriptions=[]}setSearch(e){if(this.search=e,this.config?.emitter?.emit("availableSave",!this.search),!this.search)return this.selectableUsersList.fetchSearch(this.search),void this.conversationsList.fetchSearch(this.search);this.setPending(!0),this.fetchSearchHandler()}conversationAdd(e){this.conversationsList.conversationAdd(e),this.clearSearch()}setUserChecked(e,t){return!!this.selectableUsersList.setUserChecked(e,t)&&(this.clearSearch(),!0)}clearSearch(){this.search&&this.setSearch("")}async fetchSearch(){this.setPending(!0),await Promise.all([this.selectableUsersList.fetchSearch(this.search),this.conversationsList.fetchSearch(this.search)]),this.setPending(!1)}setPending(e){this.pending=e,this.config?.emitter?.emit("pending",this.pending)}listenErrors(){const e=e=>this.config?.emitter?.emit("error",e);this.selectableUsersList.events.on("error",e),this.conversationsList.events.on("error",e)}listenNextPage(){const e=()=>this.selectableUsersList.fetchUsers();this.config?.emitter?.listenable.on("nextPage",e),this.subscriptions.push((()=>{this.config?.emitter?.listenable.off("nextPage",e)}))}listenSelectedUsers(){const e=e=>{this.config?.emitter?.emit("usersSelected",e),this.conversationsList.updateSelectedConversations(e)};this.selectableUsersList.events.on("selected",e),this.subscriptions.push((()=>{this.selectableUsersList.events.off("selected",e)}))}listenConversationAddUsers(){const e=e=>{this.selectableUsersList.addSelectedUsers(e)};this.conversationsList.events.on("addSelectedUsers",e),this.subscriptions.push((()=>{this.conversationsList.events.off("addSelectedUsers",e)}))}listenConversationRemoveUsers(){const e=e=>{this.selectableUsersList.removeSelectedUsers(e)};this.conversationsList.events.on("removeSelectedUsers",e),this.subscriptions.push((()=>{this.conversationsList.events.off("removeSelectedUsers",e)}))}async fetch(){this.setPending(!0);const e=this.config?.usersSelected??[];this.selectableUsersList.addSelectedUsers(e),await Promise.all([this.selectableUsersList.fetchUsers(!0),this.conversationsList.fetchConversations()]),this.setPending(!1)}constructor(e,t){this.messagesApi=e,this.friendsApi=t,this.conversationsList=new L(this.messagesApi),this.selectableUsersList=new N.K(this.friendsApi),this.search="",this.pending=!1,this.fetchSearchHandler=(0,w.A)(this.fetchSearch.bind(this),300),this.subscriptions=[],(0,x.l_)(this,{config:x.sH.ref}),this.selectableUsersList.config={maxSelectableBestFriendsCount:A.B}}}R=(0,y.Cg)([a.z8.transient(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===_.h?Object:_.h,void 0===k._?Object:k._])],R);const{Provider:j,useModel:z}=(0,a.Qd)(R,{initInEffect:!1,isolatedContext:!1,onlyTransient:!0}),I="PrivacyBestFriends__scroll--B35n7",q=(0,l.P)((function(){const e=(0,r.B)(),t=z(),s=t.search?t.conversationsList.conversationsSearch:t.conversationsList.conversations,a=t.search?t.selectableUsersList.usersSearch:t.selectableUsersList.users,l=Boolean(s.length||a.length);return(0,i.FD)(i.FK,{children:[(0,i.Y)(n.Y,{mode:"plain",separator:"hide",children:(0,i.Y)(o.v,{value:t.search,onChange:e=>t.setSearch(e.target.value),"data-testid":"best-friends-search"})}),t.pending?(0,i.Y)(c.y,{}):!l&&t.search?(0,i.Y)(d.wi6,{children:e.getLang("widgets_privacy_request_not_found")}):(0,i.FD)("div",{ref:t.scrollRef,className:t.scrollRef?I:"",children:[!t.search&&l&&(0,i.Y)(d.wi6,{children:e.getLang("widgets_privacy_best_friends_edit_box_description")}),s.length?(0,i.Y)(f,{clickable:!!t.search,conversations:s,selected:t.conversationsList.selected,moreCount:t.search?0:t.conversationsList.availableMoreConversations,pending:t.conversationsList.pending,pendingMembers:t.conversationsList.pendingMembers,onAdd:e=>t.conversationAdd(e),onRemove:e=>t.conversationsList.conversationRemove(e),onMoreClick:()=>t.conversationsList.fetchConversations()}):null,(0,i.Y)(v.Z,{clickable:!!t.search,users:a,selected:t.selectableUsersList.selected,pending:t.selectableUsersList.pending,onClearClick:()=>t.selectableUsersList.clearSelectedUsers(),onUserChecked:(e,s)=>t.setUserChecked(e,s)})]})]})})),O=(0,a.jn)(j,q)},597100:(e,t,s)=>{s.d(t,{B:()=>i});const i=100},167957:(e,t,s)=>{s.d(t,{Z:()=>m});var i=s(221020),a=s(516427),r=s(370633),n=s(685441),o=s(409698),c=s(837002),d=s(505174),l=s(187233),h=s(999051),g=s(946918);const p="SelectableUsersList__scroll--OqdvT",u="SelectableUsersList__scrollContainer--O6eBJ",m=({clickable:e,users:t,selected:s,pending:m,onClearClick:b,onUserChecked:f,scrollRef:v})=>{const y=(0,g.B)();return t.length?(0,i.FD)(r.Y,{mode:"plain",padding:"none",className:v?u:"",children:[(0,i.Y)(n.Y,{mode:"tertiary","data-testid":"selectable-user-list-caption",aside:!e&&(0,i.Y)(o.$,{mode:"link","data-testid":"selectable-user-list-clear-btn",onClick:b,children:y.getLang("global_clear")}),children:y.getLang("global_friends")}),(0,i.FD)("div",{ref:v,className:v?p:"",children:[t.map((t=>{const r=s?.some((e=>e.id===t.id));return(0,i.Y)(c.f,{Component:"label","data-testid":"selectable-user-cell",mode:e?void 0:"selectable",checked:e?void 0:r,onChange:e=>{f&&!f(t,e.target.checked)&&e.preventDefault()},onClick:s=>{e&&(f?.(t,!0),s.preventDefault())},before:(0,i.Y)(d.e,{"data-testid":"selectable-user-cell-avatar",size:40,src:t.photoUrl,gradientColor:(0,a.NTc)(t.id),initials:t.name.length?t.name[0]:""}),children:t.name},t.id)})),m&&(0,i.Y)(l.i,{mode:"horizontal",spacing:0,"data-testid":"selectable-user-list-pending",children:(0,i.Y)(h.y,{})})]})]}):(0,i.Y)(a.wi6,{children:y.getLang("widgets_privacy_friends_empty")})}},14120:(e,t,s)=>{s.d(t,{e:()=>i});var i=function(e){return e.FAIL_FETCH_CONVERSATIONS="FAIL_FETCH_CONVERSATIONS",e.FAIL_FETCH_CONVERSATION_USERS="FAIL_FETCH_CONVERSATION_USERS",e}({})},30321:(e,t,s)=>{s.d(t,{K:()=>c});var i=s(327813),a=s(275860),r=s(797719),n=s(601884);function o(e,t,s){return t.reduce(((t,i)=>(e.some((e=>e.id===i.id))||(s?t.unshift(i):t.push(i)),t)),[...e])}class c{get events(){return this.emitter.listenable}async init(e){this.setPending(!0),this.setSelected(e),this.setUsers(e),await this.fetchUsers(!0),this.setPending(!1)}clearSelectedUsers(){this.selected.length&&this.setSelected([])}setSelected(e){this.selected=e,this.emitter.emit("selected",this.selected)}setUserChecked(e,t){const s=this.selected.findIndex((t=>t.id===e.id));if(t){if(-1===s){if(this.config?.maxSelectableBestFriendsCount&&this.selected.length>=this.config.maxSelectableBestFriendsCount)return this.emitter.emit("error",new Error(n.C.MAX_SELECTABLE_BEST_FRIENDS_COUNT)),!1;if(this.search){const t=this.users.findIndex((t=>t.id===e.id));if(-1===t)this.setUsers([e,...this.users]);else{const e=[...this.users],s=e.splice(t,1);this.setUsers([...s,...e])}}this.setSelected([...this.selected,e])}}else if(-1!==s){const e=[...this.selected];e.splice(s,1),this.setSelected(e)}return!0}async fetchSearch(e){if(this.search=e,this.usersSearch=[],this.availableMoreUsersSearch=0,this.search)return this.fetchUsersSearch()}async fetchUsers(e){if(!this.pending&&(e||this.availableMoreUsers)){this.setPending(!0);try{const{items:e,count:t}=await this.friendsApi.get({order:"hints",offset:this.usersLoadedCount,count:30,fields:n.b.join()});this.updateUsers(e,t)}catch(e){this.emitter.emit("error",new Error(n.C.FAIL_FETCH_USERS,{cause:e}))}this.setPending(!1)}}addSelectedUsers(e){const t=e.reduce(((e,t)=>(this.selected.some((e=>e.id===t.id))||e.push(t),e)),[]);if(!t.length)return;const s=o(this.users,t,!0);this.setSelected([...this.selected,...t]),this.setUsers(s)}removeSelectedUsers(e){const t=e.reduce(((e,{id:t})=>{const s=e.findIndex((e=>e.id===t));return-1!==s&&e.splice(s,1),e}),[...this.selected]);this.setSelected(t??[])}async fetchUsersSearch(){this.setPending(!0);try{const{items:e,count:t}=await this.friendsApi.search({q:this.search,offset:this.usersSearch.length,count:30,fields:n.b.join()}),s=(0,r.R)(e);this.setUsersSearch(s,t)}catch(e){this.emitter.emit("error",new Error(n.C.FAIL_FETCH_USERS,{cause:e}))}this.setPending(!1)}setPending(e){this.pending=e,this.emitter.emit("pending",this.pending)}updateUsers(e,t){const s=(0,r.R)(e),i=o(this.users,s);this.usersLoadedCount+=s.length,this.availableMoreUsers=this.usersLoadedCount<t,this.setUsers(i)}setUsers(e){this.users=e}setUsersSearch(e,t=this.availableMoreUsersSearch){this.usersSearch=e,this.availableMoreUsersSearch=Math.max(t-e.length,0)}constructor(e){this.friendsApi=e,this.search="",this.selected=[],this.availableMoreUsers=!1,this.availableMoreUsersSearch=0,this.pending=!1,this.users=[],this.usersSearch=[],this.usersLoadedCount=0,this.emitter=new a.v,(0,i.l_)(this,{users:i.sH.ref,usersSearch:i.sH.ref,selected:i.sH.ref})}}},601884:(e,t,s)=>{s.d(t,{C:()=>a,b:()=>i});const i=["id","first_name","last_name","photo_200"];var a=function(e){return e.FAIL_FETCH_USERS="FAIL_FETCH_USERS",e.MAX_SELECTABLE_BEST_FRIENDS_COUNT="MAX_SELECTABLE_BEST_FRIENDS_COUNT",e}({})},797719:(e,t,s)=>{function i(e){return e.reduce(((e,t)=>{const s=a(t);return e.push(s),e}),[])??[]}function a({id:e,first_name:t,last_name:s,photo_200:i}){return{id:e,name:`${t} ${s}`,photoUrl:i??""}}s.d(t,{G:()=>a,R:()=>i})},89274:(e,t,s)=>{function i(e,t){const s=[];return e.forEach((({id:e})=>{t.some((t=>t.id===e))||s.push({op:"add",user_id:e})})),t.forEach((({id:t})=>{e.some((e=>e.id===t))||s.push({op:"delete",user_id:t})})),s}s.d(t,{U:()=>i})}}]),"undefined"!=typeof window&&window.stManager?.done?.("dist/core_spa/chunks/55024.16fe271e.js")}catch(e){throw"undefined"!=typeof window&&window.stManager?.fail?.("dist/core_spa/chunks/55024.16fe271e.js",e),e}