try{(self.webpackChunkvk=self.webpackChunkvk||[]).push([[74660],{375932:(e,t,i)=>{i.d(t,{t:()=>d});var s=i(161933),n=i(932216),a=i(9467),o=i(38191),r=i(37227);async function p(){if((0,r.Q)())return(0,o.w)();const{lifecycle:e}=await Promise.all([i.e(6086),i.e("langs/core_spa/MiniAppsLifecycle")]).then(i.bind(i,743873));if(!(0,a.z2)("mini_apps_replace_cur_app_with_get_current_app"))return window.cur.app;const t=e.miniApp.apps.getState(),[s]=e.miniApp.stack.getState();return t.get(s)?.app??null}function c(e=window){if(e.fastXDM)return;let t={},i=[],a={};function o(e,t,i,s,n){e[t]?i.apply(s):(n=n||0)<1e3&&setTimeout((function(){o(e,t,i,s,n+1)}),0)}function r(t){setTimeout((function(){let i=document.createElement("script");i.type="text/javascript",i.src=t||e.fastXDM.helperUrl,o(document,"body",(function(){document.getElementsByTagName("HEAD")[0].appendChild(i)}))}),0)}function c(e,t){let i;switch(typeof e){case"string":i=t?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):e.replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");break;case"object":if("[object Array]"===Object.prototype.toString.apply(e)){i=[];for(let s=0,n=e.length;s<n;s++)i[s]=c(e[s],t)}else{i={};for(let s in e)Object.hasOwnProperty.call(e,s)&&(i[s]=c(e[s],t))}break;default:i=e}return i}function d(e,t){a.loaded?e.apply(t,[a]):i.push([t,e])}function l(){a.loaded=!0;for(let e=0,t=i.length;e<t;e++)i[e][1].apply(i[e][0],[a])}function h(e,t){d((function(i){let s=i.json.parse(e);if(s[0]){s[1]||(s[1]=[]);for(let e=0,i=s[1].length;e<i;e++)if(s[1][e]&&s[1][e]._func){let i=s[1][e]._func;s[1][e]=function(){let e=Array.prototype.slice.call(arguments);e.unshift("_func"+i),t.callMethod.apply(t,e)}}else t.options.safe&&(s[1][e]=c(s[1][e],!0));setTimeout((function(){t.methods[s[0]]?t.methods[s[0]].apply(t,s[1]):console.warn("fastXDM: Method "+s[0]+" is undefined")}),0)}}))}function u(e,t){for(let i in t)e[i]&&"object"==typeof e[i]?u(e[i],t[i]):e[i]=t[i]}e.fastXDM={_id:0,helperUrl:"https://vk.com/js/api/xdmHelper.js",Server:function(i,s,n){this.methods=i||{},this.filter=s,this.options=n||{},this.id=e.fastXDM._id++,this.key=function(){let e="";for(let t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}(),this.frameName="fXD"+this.key,this.frameId="fXD"+this.key,this.server=!0,this.methods["%init%"]=this.methods.__fxdm_i=function(){e.fastXDM.run(this.id),this.methods.onInit&&this.methods.onInit()},t[this.key]=[h,this]},Client:function(i,s){if(this.methods=i||{},this.options=s||{},this.id=e.fastXDM._id++,this.client=!0,e.fastXDM.run(this.id),0!==window.name.indexOf("fXD"))throw Error("Wrong window.name property.");this.key=window.name.substring(3,8),this.caller=window.parent,t[this.key]=[h,this],e.fastXDM.on("helper",(function(){e.fastXDM.onClientStart(this)}),this),d((function(e){e.send(this,e.json.stringify(["%init%"]));let t=this.methods;setTimeout((function(){t.onInit&&t.onInit()}),0)}),this)},onMessage:function(i){i.origin!==e.location.origin&&cur&&p().then((e=>{let t=e&&e.options&&e.options.src?e.options.src:"";if(!t)return!1;i.origin!==t&&i.origin+"/"!==t.substring(0,i.origin.length+1)&&console.warn&&console.warn("Warning: message from "+i.origin+" will be disable in future")}));let s=i.data;if(!s)return!1;if("string"!=typeof s&&!(s instanceof String))return!1;let a=s.substr(0,5);if(t[a]){let e=t[a][1];if(e&&(!e.filter||e.filter(i.origin)))try{t[a][0](s.substr(6),e)}catch(i){const e={environment:"xdm",breadcrumb:{message:"xdm handler call error",data:{inputKey:a,inputValue:s},category:"custom"}};throw(0,n.vV)(i,e),i}}},setJSON:function(e){a.json=e},getJSON:function(e){if(!e)return a.json;d((function(t){e(t.json)}))},setEnv:function(e){for(let t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);l()},_q:{},on:function(e,t,i){this._q[e]||(this._q[e]=[]),-1==this._q[e]?t.apply(i):this._q[e].push([t,i])},run:function(e){let t=(this._q[e]||[]).length;for(let i=0;i<t;i++)this._q[e][i][0].apply(this._q[e][i][1]);this._q[e]=-1},waitFor:o},e.fastXDM.Server.prototype.start=function(t,i){if(t.contentWindow)this.caller=t.contentWindow,this.frame=t,e.fastXDM.on("helper",(function(){e.fastXDM.onServerStart(this)}),this);else{let e=this;(i=i||0)<50&&setTimeout((function(){e.start.apply(e,[t,i+1])}),100)}},e.fastXDM.Server.prototype.destroy=function(){delete t[this.key]},e.fastXDM.Server.prototype.sendFrameSettings=function(e){const t=()=>{e.removeEventListener("load",t),p()};e.addEventListener("load",t)},e.fastXDM.Server.prototype.setFrame=function(e){this.sendFrameSettings(e),this.options.layer?this.start(e):setTimeout(this.start.bind(this,e))},e.fastXDM.Server.prototype.append=function(e,t,i){let n=document.createElement("DIV");n.innerHTML='<iframe name="'+this.frameName+'"  id="'+this.frameId+'" '+(i||"")+"></iframe>";let a=n.firstChild;p();let o=this,r=function(){a.frameBorder="0",t&&u(a,t),e.insertBefore(a,e.firstChild),o.start(a)};return!(0,s.HS)()&&~e.className.indexOf("app_container--vk-app")&&delete t.scrolling,o.options.layer?r():setTimeout((function(){r()}),0),a},e.fastXDM.Client.prototype.callMethod=e.fastXDM.Server.prototype.callMethod=function(){let t=Array.prototype.slice.call(arguments),i=t.shift();for(let e=0,i=t.length;e<i;e++)if("function"==typeof t[e]){this.funcsCount=(this.funcsCount||0)+1;let i=t[e],s="_func"+this.funcsCount;this.methods[s]=function(){i.apply(this,arguments),delete this.methods[s]},t[e]={_func:this.funcsCount}}else this.options.safe&&(t[e]=c(t[e],!1));o(this,"caller",(function(){e.fastXDM.on(this.id,(function(){d((function(e){e.send(this,e.json.stringify([i,t]))}),this)}),this)}),this)},e.JSON&&"object"==typeof e.JSON&&e.JSON.parse&&e.JSON.stringify&&'{"a":[1,2,3]}'===e.JSON.stringify({a:[1,2,3]}).replace(/ /g,"")?a.json={parse:e.JSON.parse,stringify:e.JSON.stringify}:e.fastXDM._needJSON=!0,e.postMessage?(a.protocol="p",a.send=function(e,t){let i=e.frame?e.frame.contentWindow:e.caller;if(i)try{i.postMessage(e.key+":"+t,"*")}catch(s){window.postMessage.call(i,e.key+":"+t,"*")}},e.addEventListener?e.addEventListener("message",e.fastXDM.onMessage,!1):e.attachEvent("onmessage",e.fastXDM.onMessage),e.fastXDM._needJSON?(e.fastXDM._onlyJSON=!0,r()):l()):r()}const d=(0,i(860656).b)("mini_apps_fast_xdm",(()=>(window.fastXDM||c(window),window.fastXDM)),{version:1});c(window)},686422:(e,t,i)=>{i.d(t,{A:()=>y});var s=i(221020),n=i(214578),a=i(799835),o=i(917128),r=i(956905),p=i(719273),c=i(2096),d=i(178009),l=i(323263);var h=i(404891),u=i(9467),g=i(761534),_=i(205338),m=i(801534),S=i(78208),A=i(595253),v=i(857431),f=i(541832);const y={deleteGift:function(e,t,i,s={}){window.ajax.post("al_gifts.php",{act:"delete",mid:s.mid,gift:i,hash:s.hash},{onDone:function(e){const i=(0,d.ge)("gift"+t);i&&((0,d.qA)((0,d.yQ)(i))?(0,d.qA)((0,d.yQ)(i)).innerHTML=e:(i.appendChild((0,d.ce)("div",{className:"gift_deleted",innerHTML:e})),(0,d.jD)((0,d.yQ)(i)),window.Pagination&&!(0,c.kI)()&&window.Pagination.recache(-1)),"profile"!==window.cur.module||window.Profile?.updateGiftBlock())},showProgress:()=>{e.classList.add("gift_delete--loading"),e.innerHTML="",e.appendChild((0,d.ce)("div",{className:"gift_delete__spinner",innerHTML:(0,l._)().icon}))},hideProgress:()=>{e.classList.remove("gift_delete--loading"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg>'}})},restoreGift:function(e,t,i,s){s=s||{},ajax.post("al_gifts.php",{act:"restore",mid:s.mid,gift:i,hash:s.hash},{onDone:function(){const e=(0,d.ge)("gift"+t);e&&(0,d.qA)((0,d.yQ)(e))&&((0,d.re)((0,d.qA)((0,d.yQ)(e))),(0,d.WU)((0,d.yQ)(e)),"profile"!==window.cur.module||window.Profile?.updateGiftBlockAfterRestore())}})},markSpamGift:function(e,t,i,s){s=s||{},ajax.post("al_gifts.php",{act:"mark_spam",mid:s.mid,gift:i,hash:s.hash},{onDone:function(e){(0,d.ge)("gift_mark_spam"+t).innerHTML=e}})},initGiftsBox:function(e,t){if((0,f.H)()){return void(0,A.X)().resolve(v.h).open("userGiftsModal",{layerParams:{userId:t.mid.toString()},replace:!0})}e.setOptions({width:638,bodyStyle:"padding: 0",grey:!0,hideButtons:!0,onShow:function(){cur.gftbxWasScroll&&(boxLayerWrap.scrollTop=cur.gftbxWasScroll,cur.gftbxWasScroll=!1)}}),t.lang&&(cur.lang=(0,p.X)(cur.lang||{},t.lang)),(0,p.X)(cur,{gftbxOffset:t.offset,gftbxAutoload:!0,gftbxWasScroll:!1,gftbxMid:t.mid}),ajax.preload("al_gifts.php",{act:"box",mid:t.mid,offset:t.offset},t.preload),window.uiScrollBox&&window.uiScrollBox.init(e,{onShow:function(){(0,r.W2)(boxLayerWrap,"scroll",y.onGiftsScroll),setTimeout(cur.chooseAudioScroll,0)},onHide:function(){(0,r.Nn)(boxLayerWrap,"scroll",y.onGiftsScroll)}}),(0,r.W2)(boxLayerWrap,"scroll",y.onGiftsScroll);const i=boxLayerWrap.scrollTop;(0,d.aE)((0,d.vo)("_scroll_node",e.bodyNode)),boxLayerWrap.scrollTop=i,onBodyResize(),y.onGiftsScroll()},moreGifts:function(){if((0,f.H)()){return void(0,A.X)().resolve(v.h).open("userGiftsModal",{layerParams:{userId:cur.gftbxMid.toString()},replace:!0})}const e=(0,d.ge)("gifts_more_link");(0,n.vC)(e)||(ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{onDone:function(t,i,s){const n=(0,d.ce)("div",{innerHTML:t}),a=(0,d.ge)("gifts_rows");if(a){for(let e=(0,d.yQ)(n);e;e=(0,d.yQ)(n))a.appendChild(e);cur.gftbxOffset=i,s?y.preloadGifts():(0,d.jD)(e)}},showProgress:n.UG.pbind(e),hideProgress:n.XB.pbind(e),cache:1}),cur.gftbxAutoload=!0)},preloadGifts:function(){if((0,f.H)()){(0,A.X)().resolve(v.h).open("userGiftsModal",{layerParams:{userId:cur.gftbxMid.toString()},replace:!0})}else ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{cache:1})},onGiftsScroll:function(){if(!cur.gftbxAutoload)return;const e=lastWindowHeight,t=(0,d.ge)("gifts_more_link");(0,d.zN)(t)&&e>(0,d.Uz)(t,!0)[1]&&t.click()},showGiftBox:function(e,t,i){return window.Profile?window.Profile.showGiftBox(e,t,i):(cur.gftbxWasScroll=boxLayerWrap.scrollTop,boxLayerWrap.scrollTop=0,cur.viewAsBox?cur.viewAsBox():(0,u.z2)("new_gifts_catalog")?void(0,h.V)({layerQuery:{ref:i,recipient_ids:String(e)}}):!(0,o.rL)("al_gifts.php",{act:"get_gift_box",mid:e,fr:e==vk.id?1:0,ref:i},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"],cache:1},t))},processBoxOptions(e,t){-1e3!=t&&t&&(requestAnimationFrame((()=>{(0,c.dk)()})),(0,p.X)(cur,{paymentsOfferPreview:t.paymentsOfferPreview,paymentsPreload:t.paymentsPreload,paymentsAppOrder:t.paymentsAppOrder,paymentsOfferPreload:t.paymentsOfferPreload}),t.orderData&&Promise.all([i.e(73647),i.e("langs/core_spa/app_order_box")]).then(i.bind(i,811983)).then((({AppOrderBox:e})=>{e.initialize(t.orderData.orderId,t.orderData.appId,t.orderData.testMode,t.orderData.hash,t.orderData.votes,t.orderData.discount,t.orderData.billPeriod)})),(0,p.X)(cur,{paymentsAuthPayment:t.paymentsAuthPayment,paymentsOrderNotice:t.paymentsOrderNotice,paymentsTryCompleteOrder:t.paymentsTryCompleteOrder,isPaymentsAppOrder:t.isPaymentsAppOrder,paymentsOfferApp:t.paymentsOfferApp,checkoutEnabled:t.checkoutEnabled}),Promise.all([i.e(58356),i.e("langs/core_spa/payments_box")]).then(i.bind(i,601092)).then((({PaymentsBox:i})=>{t.showProgress&&i.showProgress(""),(0,p.X)(cur,{votesAmountsData:t.votesAmountsData,paymentsPreferVotes:t.paymentsPreferVotes,votesTypeInit:t.votesTypeInit,psList:t.psList,paymentsWideBox:t.paymentsWideBox,paymentsTooltips:t.paymentsTooltips,paymentsChangeType:0===t.paymentsWideBox?(0,a.Xo)("payments_go_change_pay_type"):"",payments_get_votes:(0,a.Xo)("payments_get_votes_new"),getVotesDoneHide:!0,paymentsWaitingCache:{},isPaymentComplete:!1,isPaymentAttemted:!1,usdRate:t.usdRate,paymentsHash:t.paymentsHash,paymentComplete:i.complete,paymentCanceled:i.paymentCanceled,paymentsShowProgress:i.showProgress,statSessionId:t.statSessionId,foreignCardPaymentOption:t.foreignCardPaymentOption,skipVoteAmountRadioButtons:t.skipVoteAmountRadioButtons}),i.initialize(e),cur.checkoutEnabled||(i.initPhoneCountry(t.countries,t.country),i.initPhoneNumber((0,d.ge)("phone"))),(0,p.X)(cur,{paymentsTypesSum:t.paymentsTypesSum,instantNeedCVV:t.instantNeedCVV,votesType:t.votesType,paymentsWPreload:t.paymentsWPreload,isMidas:t.isMidas,isHideButtonBackAndText:t.isHideButtonBackAndText}),t.getVotesAmountsOnDone&&i.getVotesAmountsOnDone.apply(this,cur.paymentsWPreload)})))},showGetMoneyBox(e=null){return(0,o.rL)("al_gifts.php",{act:"get_money",...e},{onDone:this.processBoxOptions})}};(0,g.tq)().setStartupHandler("Gifts/gift_init",(({payload:{target:e,data:t}})=>{if(!e)return;const i=(0,_.createRoot)(e);i.render((0,s.Y)(A.R,{children:(0,s.Y)(S.H,{children:(0,s.Y)(m.Y,{gift:t.gift,size:256})})}));const n=(0,c.kI)();n&&n.setOptions({onDestroy:()=>{i?.unmount()}})}))},970343:(e,t,i)=>{i.d(t,{de:()=>p,or:()=>c,yE:()=>r});var s=i(99758),n=i(435337),a=i(412591);const o={"144p":"mp4_144","240p":"mp4_240","360p":"mp4_360","480p":"mp4_480","720p":"mp4_720","1080p":"mp4_1080","1440p":"mp4_1440","2160p":"mp4_2160"};function r({files:e,live_settings:t}){const i={};let n=t?.playback_duration??t?.max_rewind_duration;n&&(n*=a.Z2);const r=Boolean(t),p=!n;if(!e)return i;const c={};for(const[t,i]of Object.entries(o))i in e&&(c[t]=e[i]);return Object.keys(c).length>0?i.MPEG=c:e.src&&(i.MPEG={"Invariant quality":e.src}),e.dash_sep&&(i[s.T4.DASH_SEP]={type:"url",url:e.dash_sep}),e.dash_webm&&(i[s.T4.DASH_WEBM]={type:"url",url:e.dash_webm}),e.dash_webm_av1&&(i[s.T4.DASH_WEBM_AV1]={type:"url",url:e.dash_webm_av1}),e.dash_streams&&(i[s.T4.DASH_STREAMS]={type:"url",url:e.dash_streams}),e.cmaf&&(i[s.T4.DASH_LIVE_CMAF]={type:"url",url:e.cmaf}),e.hls&&!r&&(i[s.T4.HLS]={type:"url",url:e.hls}),e.dash_live&&p&&(i[s.T4.DASH_LIVE]={type:"url",url:e.dash_live}),!e.dash_live_playback||p&&e.dash_live||(i[s.T4.DASH_LIVE]={type:"url",url:e.dash_live_playback}),e.hls_live&&p&&(i[s.T4.HLS_LIVE]={type:"url",url:e.hls_live}),!e.hls_live_playback||p&&e.hls_live||(i[s.T4.HLS_LIVE]={type:"url",url:e.hls_live_playback,maxSeekBackTime:n}),e.dash_ondemand&&(i[s.T4.DASH_ONDEMAND]={type:"url",url:e.dash_ondemand}),e.hls_ondemand&&(i[s.T4.HLS_ONDEMAND]={type:"url",url:e.hls_ondemand}),e.hls_live_ondemand&&(i[s.T4.HLS_LIVE_CMAF]={type:"url",url:e.hls_live_ondemand,maxSeekBackTime:n}),e.ws&&(i[s.T4.WEB_RTC_LIVE]={type:"url",url:e.ws}),i}function p(e){const t=r(e),i=e.image?.sort(((e,t)=>e.height-t.height))??[],s=i.find((({height:e})=>e>500))??i.at(-1),n=e.restriction?{restriction:e.restriction}:{};return{...Object.keys(t).length>0?{sources:t}:{},...e.live_status?{live:{status:e.live_status,startTime:e.live_start_time}}:{},title:e.title??"",thumbUrl:s?.url,unitedVideoId:parseInt(e.ov_id??"0",10),duration:e.duration??0,videoEpisodes:e.episodes?.map((({time:e,text:t})=>({time:e??0,text:t??""}))),previewThumbsData:e.timeline_thumbs?{countPerImage:e.timeline_thumbs.count_per_image??1,countPerRow:e.timeline_thumbs.count_per_row??1,countTotal:e.timeline_thumbs.count_total??1,frameHeight:e.timeline_thumbs.frame_height??0,frameWidth:e.timeline_thumbs.frame_width??0,frequency:e.timeline_thumbs.frequency??1,isUV:e.timeline_thumbs.is_uv??!1,links:e.timeline_thumbs.links??[]}:void 0,subtitles:e.subtitles?.filter((e=>Boolean(e.url))).map((({is_auto:e,title:t,lang:i,manifest_name:s,url:n,storage_index:a})=>({isAuto:e,id:[t,i,a].filter(Boolean).join("_"),language:i,label:s,url:n}))),subtitlesForcedLanguage:e.force_subtitles,...n}}function c(e,t){const i=e.map((e=>p(e))),s=e[0],a={videos:i??[]};return t&&(a.interactiveData={...t,videoLoader:async(e,i)=>{const s=t?.accessKeysMap||{};return c((await(0,n.Y)(parseInt(e,10),parseInt(i,10),s[i]||"")).items)}}),s?.album_id&&(a.albumId=s.album_id.toString(10)),s?.uv_stats_place&&(a.statPlace=s.uv_stats_place),s?.track_code&&(a.statTrackCode=s.track_code),2===s?.can_download&&(a.canDownload=!0),s?.files?.failover_host&&(a.failoverHosts=[s?.files?.failover_host]),s?.restriction?.mute_info_link&&(a.isAudioDisabled=Boolean(s?.restriction?.mute_info_link)),s?.volume_multiplier&&(a.volumeMultiplier=s?.volume_multiplier),a}},801534:(e,t,i)=>{i.d(t,{Y:()=>m});var s=i(221020),n=i(431941),a=i(180329),o=i(516427),r=i(962644),p=i(46284),c=i(237582),d=i(837844);var l=i(16437),h=i(455356),u=i(946918),g=i(695942),_=i(815287);function m({gift:e,size:t,borderRadius:i=10,padding:c=8,"data-testid":d,noBackground:g,onViewReady:m}){const A=(0,u.B)(),v=(0,n.K)(),f=t-c,y=function(e,t){return(e.animation?.sources.find((e=>e.theme===t))??e.animation?.sources?.[0])?.url||""}(e,v),b=g?"":(0,l.$r)(e,v),{lottieContainerRef:C,lottieLoading:w,lottieError:I,lottieRendered:E}=(0,h.X)({group:"gift",width:f,height:f,loop:!0,autoplay:!0,upscale:!0,name:y||"",animationUrl:y}),[T,O]=(0,_.useState)(!0),M=()=>{O(!1)},D=!y||I,P=(w||!E)&&T;return(0,_.useEffect)((()=>{D&&T||m?.()}),[T,D]),(0,s.FD)(a.s,{justify:"center",align:"center",style:{width:`${t}px`,height:`${t}px`,backgroundColor:P?"":b,borderRadius:i,position:"relative"},getRootRef:C,"aria-live":"polite","aria-busy":P,children:[(0,s.Y)(o.s6o,{children:A.getLang("gifts_gift_image_alt_text")}),P&&(0,s.Y)(r.h,{Component:p.E,width:t,height:t,borderRadius:i}),D&&(0,s.Y)(S,{gift:e,size:f,onLoad:M,onError:M,"data-testid":d})]})}function S({gift:e,size:t,onLoad:i,onError:n,"data-testid":a}){const o=(0,u.B)(),r=(0,d.oI)(e,t,t);return(0,s.Y)(c.v,{src:r?.url??"",size:t,alt:o.getLang("gifts_gift_image_alt_text"),withTransparentBackground:!0,noBorder:!0,fallbackIcon:(0,s.Y)(g.v,{}),onLoad:i,onError:n,"data-testid":a})}},153041:(e,t,i)=>{i.d(t,{k:()=>o});var s=i(860656),n=i(399902);function a(){const e={},t={};return{registerWebHandler:t=>{e.web=t},registerGiftSentHandler:(e,i)=>{t[e]=i},handle:({isMvk:t,productIds:i,productType:s,recipientIds:a,ref:o,navigate:r})=>{if(t)"gift"===s&&i.length&&r(function({giftId:e,recipientIds:t,ref:i}){const s=t?.length?"/gifts"+t[0]:"/gifts";return(0,n.G)(s,{act:"send",gift:e,...i?{ref:i}:{}})}({giftId:i[0],recipientIds:a,ref:o})),"sticker"===s&&i.length&&r(function({giftIds:e,recipientIds:t,ref:i}){return e.length?t?.length?(0,n.G)("/attachments",{act:"stickers_gift",stickers_id:e[0],target:"mail"+t[0],...i?{ref:i}:{}}):(0,n.G)("/gifts",{act:"send",gift:-e[0],...i?{ref:i}:{}}):""}({giftIds:i,recipientIds:a,ref:o}));else if(e.web)return e.web({isMvk:t,productIds:i,productType:s,recipientIds:a,ref:o,navigate:r})},handleGiftSent:({isMvk:e,canWritePrivateMessage:i,canViewGifts:s,recipientId:n})=>{e?t.mvk&&t.mvk({isMvk:e,canWritePrivateMessage:i,canViewGifts:s,recipientId:n}):t.web&&t.web({isMvk:e,canWritePrivateMessage:i,canViewGifts:s,recipientId:n})}}}const o=(0,s.b)("global/openGift",(()=>a()),{version:2})},16437:(e,t,i)=>{i.d(t,{$r:()=>n,GF:()=>a});var s=i(837844);function n(e,t){return(e.backgrounds?.find((e=>e.theme===t))??e.backgrounds?.[0])?.color??""}function a(e,t,i="light"){const n=e.backgrounds?.find((e=>(e.theme??"light")===i))??e.backgrounds?.[0];if(n)return n.image&&(0,s.tj)(n.image.sources,t,i).url||""}},837844:(e,t,i)=>{i.d(t,{oI:()=>o,tj:()=>r});var s=i(998168),n=i(300806);function a(e){const t=[];return e.thumb_512&&t.push({width:512,height:512,url:e.thumb_512}),e.thumb_256&&t.push({width:256,height:256,url:e.thumb_256}),e.thumb_96&&t.push({width:96,height:96,url:e.thumb_96}),e.thumb_48&&t.push({width:48,height:48,url:e.thumb_48}),t}function o(e,t,i){const n=a(e),o=(0,s.m)();return n.find((e=>e.width>=t*o&&e.height>=i*o))??n.find((e=>e.width>=t&&e.height>=i))??n[n.length-1]}const r=(e,t,i="light")=>{const o=Array.isArray(e)?e:a(e);let r=o.filter((e=>(e.theme??"light")===i));"dark"!==i||r.length||(r=o.filter((e=>"light"===(e.theme??"light"))));const p=r.filter((e=>e.url.endsWith(".png")&&e.width>=t));return function(e,t,i){const a=(0,s.m)(),o=t*a,r=i?i*a:void 0;return(0,n.q)(e??[],o,r)??{url:"",width:0,height:0}}(p.length>0?p:r,t)}},385626:(e,t,i)=>{i.d(t,{W:()=>n});var s=i(649852);const n=(0,i(860656).b)("vkcom-messenger::web",(()=>({externalEvents:new s.r})),{version:0})},651566:(e,t,i)=>{i.d(t,{b:()=>_});var s=i(221020),n=i(516427),a=i(370633),o=i(982444),r=i(180329),p=i(405697),c=i(409698),d=i(634164),l=i(785920),h=i(946918);const u="AppNotFoundScreen__container--DeU3H",g="AppNotFoundScreen__containerWithBackground--jQdIa",_=({stretched:e})=>{const{viewWidth:t=n.Gcd.MOBILE}=(0,n.LtX)(),i=(0,h.B)(),_=t<n.Gcd.TABLET;return(0,s.FD)(a.Y,{mode:"card",stretched:e,padding:"none",separator:e?"hide":"show",children:[!e&&(0,s.Y)(o.K,{size:72}),(0,s.Y)(r.s,{className:(0,d.$)(e&&u,e&&_&&g),children:(0,s.Y)(p.O,{stretched:!0,action:(0,s.Y)(c.$,{href:"/services",children:i.getLang("apps_placeholder_info_action_button_title_go_to_apps_catalog")}),header:i.getLang("apps_app_not_exists"),icon:(0,s.Y)(l.z,{})})}),!e&&(0,s.Y)(o.K,{size:72})]})}},109911:(e,t,i)=>{i.d(t,{Z:()=>c});var s=i(331635),n=i(262424),a=i(57894),o=i(645189),r=i(42107),p=i(365815);class c extends n.y{async runHandler(e,t){const{[e.handlerName]:i}=await this.getBridgeHandlers();if(i&&(!i.isEnabled||i.isEnabled(this.env))){const s=this.containerProvider.getContainer().resolve(i);return s.setContext?.(t),s.handle(e)}return this.legacyProvider?.runHandler(e,t)||this.getHandlerError(e.handlerName)}async getBridgeHandlers(){const{bridgeHandlers:e}=await Promise.all([i.e(32413),i.e("langs/core_spa/sharedMiniAppHandlers")]).then(i.bind(i,690720));return e}getHandlerError(e){return{type:`${e}Failed`,data:{error_type:"client_error",error_data:{error_code:p.OQ.UNSUPPORTED_PLATFORM,error_reason:p.XY.unsupportedPlatform(e)}}}}constructor(e,t){super(),this.env=e,this.containerProvider=t,this.setLegacyProvider=e=>{this.legacyProvider=e}}}c=(0,s.Cg)([r.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.J?Object:o.J,void 0===a.a?Object:a.a])],c)},985917:(e,t,i)=>{i.d(t,{h:()=>d});var s=i(327813),n=i(725308),a=i(456603),o=i(578345),r=i(878136),p=i(161933);class c{get isAdPlaying(){return this._isAdPlaying}get platformAdsConfig(){return{rewarded:{callbacks:{onRewardAdsShown:()=>{this._isAdPlaying=!0},onRewardAdsFinished:()=>{this._isAdPlaying=!1}},motion:!0},interstitial:{callbacks:{onInterstitialAdsShown:()=>{this._isAdPlaying=!0},onInterstitialAdsHidden:()=>{this._isAdPlaying=!1}},leadAdsModal:!0,motion:!0},banner:{bannerAvailability:{isAvailable:this.checkBannerAdAvailability(),animated:!(0,p.HS)(),position:{top:this.checkBannerAdAvailabilityTopPosition()},heightType:{compact:(0,p.HS)()},verticalOverlay:!(0,p.HS)(),verticalRight:this.checkBannerAdAvailabilityVerticalRightPosition()}}}}get appData(){return this.getAppData()}checkBannerAdAvailability(){return(0,p.HS)()||!this.appData?.isInternalApp}checkBannerAdAvailabilityTopPosition(){return!(0,p.HS)()||this.appData?.mobileControlsType===r.y.DIRECT_GAME}checkBannerAdAvailabilityVerticalRightPosition(){const e=this.appData?.mobileControlsType;return!((0,p.HS)()&&(e===r.y.VK_APP||void 0===e))}constructor(e,t){this.userEnv=e,this.getAppData=t,this._isAdPlaying=!1,(0,s.l_)(this)}}class d{get actorId(){return this.props.current.actorId??null}get connector(){return this.connectorService}get actorIsViewerId(){return this.authService.userId===this.actorUserId}get actorIsUserId(){return!!this.actorId&&n.z.isUserId(this.actorId)}get actorIsGroupId(){return!!this.actorId&&n.z.isGroupId(this.actorId)}get actorGroupId(){if(this.actorId&&this.actorIsGroupId)return Math.abs(this.actorId)}get actorUserId(){if(this.actorIsUserId)return this.actorId}get isAppDataLoaded(){return Boolean(this.appData)}get platformId(){const{platformId:e}=this.metaData.get();return e}get appState(){return this.appsService.getAppState(this.appId)}get appData(){return this.appState?.appData}get appTitle(){return this.appData?.title||"Mini App"}get isWidescreenAvailable(){return this.isSplashScreenHidden&&this._platformScreenType===a.ZJ.NONE}get isWidescreen(){return this.isWidescreenAvailable&&!!this.appData?.isWidescreen}get isWithoutHeader(){return this.isWithoutTitle||this.appData?.withoutHeader}get isWithoutFooter(){return this.isWithoutTitle||this.appData?.withoutFooter}get isWithoutTitle(){return 14===this.appData?.placeholderInfo?.reason}get isWithoutLayerControls(){return this.appData?.hideControlsInLayer}get isWithoutLayerCloseButton(){return this.isWithoutLayerControls&&!this.appData?.forceCloseControlInLayer}get vkRef(){return(0,o.jr)(this.appData?.url??"").get("vk_ref")??void 0}get appId(){return this.props.current.appId}get controlType(){return this.appData?.mobileControlsType??r.y.VK_APP}get isControlsVisible(){return this.isAppDataLoaded&&this._platformScreenType!==a.ZJ.NOT_FOUND}get isInternalApp(){return this.appData?.isInternalApp}get isWithoutSplashScreen(){return!this.appData?.splashScreen||this.appData?.isInternalApp}get isMiniAppWrapperPlain(){const e=Boolean(this.appData?.placeholderInfo?.suggestedAppsIds?.length),t=this._platformScreenType===a.ZJ.INSTALL||this._platformScreenType===a.ZJ.UNAVAILABLE,i=this._platformScreenType===a.ZJ.UNAVAILABLE;return(this.isInternalApp||this.isWithoutHeader)&&!t||this.isWidescreen||this._platformScreenType===a.ZJ.NOT_FOUND||e&&i}get isControlPanelGroupMode(){return(this.isInternalApp||this.isWithoutHeader)&&this._platformScreenType===a.ZJ.NONE}get isControlPanelOnTop(){return this._platformScreenType===a.ZJ.INSTALL||this._platformScreenType===a.ZJ.UNAVAILABLE}get allowResize(){return this._platformScreenType===a.ZJ.NONE&&!this.isWidescreen&&this.isAppDataLoaded}get legalDocuments(){return this.appData?.legalDocuments}get withPolicyPanel(){return this._platformScreenType!==a.ZJ.UNAVAILABLE}get pageTitle(){return this._platformScreenType!==a.ZJ.UNAVAILABLE||this.appData?this._platformScreenType===a.ZJ.NOT_FOUND?this.langs.getLang("apps_app_not_exists"):this._pageTitle?this._pageTitle:this.isWithoutTitle?this.langs.getLang("global_vkontakte"):this.appTitle:this.langs.getLang("global_vkontakte")}get isPlatformScreenShown(){return this._platformScreenType!==a.ZJ.NONE}get platformScreen(){return this._platformScreenType}get isInstallPlatformScreenType(){return this._platformScreenType===a.ZJ.INSTALL}get hasSplashScreen(){return this.appData?.isSplashScreenEnabled}get isSplashScreenHidden(){return this._isSplashScreenHidden||this.isAppDataLoaded&&!this.hasSplashScreen}get isAuthorized(){return this.authService.isAuthorized}get appType(){return this.appData?.isAnyGame?"game":this.appData?.type||"mini_app"}constructor(e,t,i,n,o,r,p,d){this.userEnv=e,this.langs=t,this.authService=i,this.appsService=n,this.metaData=o,this.connectorService=r,this.props=p,this.handlerProvider=d,this._platformScreenType=a.ZJ.NONE,this._isSplashScreenHidden=!1,this._pageTitle="",this.onPlatformScreenChange=e=>{this._platformScreenType=e},this.onSplashScreenHide=()=>{this._isSplashScreenHidden=!0},this.onAppMessage=({message:{handler:e,params:t}})=>{if("VKWebAppSetTitle"===e){const e=t.title;e&&(this._pageTitle=e)}},this.miniAppAds=new c(this.userEnv,(()=>this.appData)),(0,s.l_)(this)}}},352201:(e,t,i)=>{i.d(t,{H:()=>me});var s=i(331635),n=i(42107),a=i(254531),o=i(375932),r=i(591332),p=i(257263);class c extends a.W{emitExternalEvent(e){this.externalEventEmitter.emit(e)}addExternalEventListener(e,t){this.externalEventEmitter.addOnceListener(e,t)}generateIframeName(){return`fXD${[...new Array(5)].reduce((e=>e+Math.ceil(15*Math.random()).toString(16)),"")}`}saveJsSDKStats(e,t=[]){(0,p.bl)({name:"js_sdk_funcs_call",value:1,keys:[e,...t]})}constructor(...e){super(...e),this.externalEventEmitter=new r.A,this.initXDMClient=(e,t)=>new(0,(0,o.t)().Server)(e,t)}}c=(0,s.Cg)([n.z8.global()],c);var d=i(18528);class l extends d.b{get isLayer(){const{appData:e}=this.launchDataProvider;return Boolean(e?.layer)}set(e,t=!0){const{launchProps:i}=this.launchDataProvider;i&&this.isLayer&&this.launchService.updateLayerParams({...i,location:this.omitLeadingHashSymbol(e)},t)}clearTechnicalQuery(){return this.isLayer?super.clearTechnicalQuery():void 0}}l=(0,s.Cg)([n.z8.container()],l);class h extends d.b{set(e,t=this.env.partConfigEnabled("frontend.mini_apps_sync_set_location_logic")){const i=window.nav.objLoc;if(e===i["#"])return;const s={replace:t,state:{}},n=window.nav.toStr({...this.omitQueryParams(i),"#":e});window.nav.setLoc?window.nav.setLoc(n,s):window.nav.go(n,null,s)}}h=(0,s.Cg)([n.z8.container()],h);var u=i(686422);class g{showVotesPaymentPage(){u.A.showGetMoneyBox()}}g=(0,s.Cg)([n.z8.global()],g);var _=i(259618),m=i(54952),S=i(25313),A=i(722934),v=i(289375),f=i(97929),y=i(273193),b=i(35620);class C extends _.Q{get closeEvent(){return b.lG.CLOSE}async openSettings(e){this.appsModalsService.show({type:"SettingsModal",data:{appId:e},actions:{}})}constructor(e,t,i,s,n,a){super(s,n,a),this.appsService=e,this.appsApi=t,this.appsModalsService=i}}C=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===m.m?Object:m.m,void 0===A.V?Object:A.V,void 0===S.F?Object:S.F,void 0===v.X?Object:v.X,void 0===f.q?Object:f.q,void 0===y.Y?Object:y.Y])],C);var w=i(791625),I=function(e){return e[e.ORD_APP_ID=51707812]="ORD_APP_ID",e[e.VMOJI_CONSTRUCTOR_APP_ID=7929683]="VMOJI_CONSTRUCTOR_APP_ID",e[e.ONE_TIME_DONUT_APP_ID=51528700]="ONE_TIME_DONUT_APP_ID",e[e.GIFTS_CATALOG_APP_ID=53670660]="GIFTS_CATALOG_APP_ID",e}({}),E=function(e){return e.ORD_DATA="ord_data",e.VMOJI_CHARACTER_RECREATE_OLD="vmoji_character_recereate",e.VMOJI_CHARACTER_RECREATE="vmoji_character_recreate",e.OPEN_GIFT_SEND_SCREEN="giftsCatalog.openGiftSendScreen",e.IS_NEW_GIFTS_SEND_ENABLED="giftsCatalog.isNewGiftsSendEnabled",e.GIFT_SENT="giftsCatalog.giftSent",e}({}),T=i(645189),O=i(385626),M=i(704366);class D{handler(e,t){if(e.action===E.ORD_DATA&&(this.onOrdData(e),this.userEnv.partConfigEnabled("messages_enable_vk_web_app_custom_message_processing"))){(0,O.W)().externalEvents.send(t,e)}}onOrdData({payload:{isAd:e=!1,predId:t="",erId:i=""}}){this.userEnv.partConfigEnabled("spa_ord_miniapp_open")||(0,M.K)().onOrdData({is_ad:e,ord_pred_id:t,erid:i})}constructor(e){this.userEnv=e}}D=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===T.J?Object:T.J])],D);class P extends w.E{registerHandler(e,t){this.handlers.set(e,t)}getHandler(e){return this.handlers.get(e)}constructor(e){super(),this.ordCustomHandler=e,this.handlers=new Map,this.registerHandler(I.ORD_APP_ID,this.ordCustomHandler.handler.bind(this.ordCustomHandler))}}P=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===D?Object:D])],P);var k=i(153041);class L{async handler(e){if(e.action===E.IS_NEW_GIFTS_SEND_ENABLED)return this.handleIsNewGiftsSendEnabled();e.action!==E.GIFT_SENT?e.action===E.OPEN_GIFT_SEND_SCREEN&&await this.openGifts(e):await this.handleGiftSent(e)}async handleIsNewGiftsSendEnabled(){return{result:!0,is_enabled:this.userEnv.isToggleEnabled("vas_web_new_gifts_send")||this.userEnv.isToggleEnabled("vas_mvk_new_gifts_send")}}async handleGiftSent(e,t=!1){if(e.action===E.GIFT_SENT){const{recipient:i}=e.payload;if(!i)return;const{id:s,can_write_private_message:n,can_view_gifts:a}=i;(0,k.k)().handleGiftSent({isMvk:t,canViewGifts:a,recipientId:s,canWritePrivateMessage:n})}}async openGifts(e,t=!1){e.action===E.OPEN_GIFT_SEND_SCREEN&&await(0,k.k)().handle({productIds:e.payload.product_ids,productType:e.payload.product_type,recipientIds:e.payload.recipient_ids??[],ref:e.payload.ref,navigate:window.nav.go,isMvk:t})}constructor(e){this.userEnv=e}}L=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===T.J?Object:T.J])],L);var N=i(312020),W=i(932216),B=i(181048),R=i(799835);const x=async({productIds:e,productType:t,recipientIds:s,ref:n})=>{if(!e.length)throw N.b2.INVALID_PARAMS;switch(t){case"gift":try{const{showGiftModal:t}=await Promise.all([i.e(55272),i.e("langs/core_spa/GiftModal")]).then(i.bind(i,417732));t({giftId:e[0],recipientIds:s,referrer:n},!1,!1)}catch(e){throw(0,W.vV)(e),N.b2.UNKNOWN_ERROR}break;case"sticker":try{const{showStickersGiftModal:t}=await Promise.resolve().then(i.bind(i,951180));t({giftIds:e?.map((e=>-e)),recipientIds:s,referrer:n})}catch(e){throw(0,W.vV)(e),N.b2.UNKNOWN_ERROR}break;default:throw N.b2.INVALID_PARAMS}},V=({canWritePrivateMessage:e,canViewGifts:t,recipientId:i})=>{(0,B.td)({type:"ok",text:(0,R.Xo)("notify_gift_sent")}),e&&window.nav.go(`/im/convo/${i}`),!e&&t&&window.nav.go(`/gifts${i}`)};(0,k.k)().registerWebHandler(x),(0,k.k)().registerGiftSentHandler("web",V);class H extends L{async handler({action:e,payload:t}){return(0,k.k)().registerWebHandler(x),(0,k.k)().registerGiftSentHandler("web",V),e===E.IS_NEW_GIFTS_SEND_ENABLED?this.handleIsNewGiftsSendEnabled():e===E.GIFT_SENT?this.handleGiftSent({action:e,payload:t}):void(e===E.OPEN_GIFT_SEND_SCREEN&&await this.openGifts({payload:t,action:e}))}}var G=i(400338),K=i(446362);class F{async handler({payload:{promo:e,page:t},action:s}){if((s===E.VMOJI_CHARACTER_RECREATE||s===E.VMOJI_CHARACTER_RECREATE_OLD)&&e&&(0,K.yf)()&&(window.StickerPickerViewer?.showLastPicker(G.M1.VMOJI),!t?.match("/preview"))){const{showAddedToStickerSnackbar:e}=await Promise.all([i.e(70609),i.e(38766),i.e(22519),i.e("langs/core_spa/VmojiChunk")]).then(i.bind(i,438766));e()}}}F=(0,s.Cg)([n.z8.container()],F);class j{handler({action:e,payload:t}){window.VKWebAppCustomMessageExternalHandlers[e]?.(t)}}j=(0,s.Cg)([n.z8.container()],j);class U extends P{constructor(e,t,i,s){super(e),this.giftsCatalogCustomHandler=t,this.vmojiCustomHandler=i,this.donutCustomHandler=s,this.registerHandler(I.GIFTS_CATALOG_APP_ID,this.giftsCatalogCustomHandler.handler.bind(this.giftsCatalogCustomHandler)),this.registerHandler(I.VMOJI_CONSTRUCTOR_APP_ID,this.vmojiCustomHandler.handler.bind(this.vmojiCustomHandler)),this.registerHandler(I.ONE_TIME_DONUT_APP_ID,this.donutCustomHandler.handler.bind(this.donutCustomHandler))}}U=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===D?Object:D,void 0===H?Object:H,void 0===F?Object:F,void 0===j?Object:j])],U);var Y=i(474461),z=i(365815);class J extends Y.m{showInviteFriendsBox(e,t){return new Promise(((i,s)=>{this.modalService.show({type:"InviteFriendsModal",data:{appId:e,requestKey:t},actions:{onClose:()=>s({error_code:z.OQ.USER_DENIED,error_reason:z.XY.userDenied()}),onSuccess:e=>i(e||[])}})}))}constructor(e){super(),this.modalService=e}}J=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===S.F?Object:S.F])],J);var q=i(996385);class X extends q.a{showRequestBox({data:e,actions:t}){let i;const s=()=>{i?.({shouldClosed:!0})};i=this.appsModalsService.show({type:"ShowRequestBox",data:e,actions:{onDone:()=>{t.onDone(),s()},onError:()=>{t.onError({error_code:z.OQ.UNKNOWN,error_reason:z.XY.unknown()}),s()},onClose:()=>{t.onClose(),s()}}})}constructor(e){super(),this.appsModalsService=e}}X=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===S.F?Object:S.F])],X);var Q=i(969645),$=i(68972),Z=i(869773);class ee extends Q.I{async joinCallByLink(e,t){await this.callsAppService.joinCallByLink({joinLink:t,isWithVideo:!1,entryPoint:Z._P.MINI_APP,miniAppId:e})}isInActiveCall(){return Boolean(this.callsAppService.isInActiveCall)}async startCall(e){return await this.appsApi.startCall({app_id:e})}subscribeEvent(e,t){this.callsAppService.eventBus?.on(e,t)}get lastCallData(){return this.callsAppService.store?.getState().lastCallData}constructor(e,t){super(),this.appsApi=e,this.callsAppService=t}}ee=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===A.V?Object:A.V,void 0===$.Q?Object:$.Q])],ee);class te{runHandler(e,t){return new Promise((async s=>{const{handlerName:n,originalHandlerName:a,...o}=e,{[n]:r}=await Promise.all([i.e(51220),i.e(14046),i.e(36982),i.e(44691),i.e(4267),i.e(51203),i.e("langs/core_spa/miniAppsActionHandlers")]).then(i.bind(i,851217)),p=new r(e),c=function(e){return{appId:e.app.id,isTextliveApp:e.app.isTextliveApp,isVkPayApp:e.app.isVkPayApp,isMiniAppWidget:e.app.isMiniAppWidget,vkApp:{lockModalType:e.modalManager?.lock.bind(e.modalManager),unlockModalType:e.modalManager?.unlock.bind(e.modalManager),isModalTypeLocked:e.modalManager?.isLocked.bind(e.modalManager),options:{app_name:e.app.title,is_install_to_group_available:e.app.launchParams?.user_actions?.can_install_to_group??!1,is_vkpay_app:e.app.isVkPayApp,vk_app_connect_host:e.app.vkAppConnectHost,is_internal_app:e.app.isInternalApp,...e.app.securityHash,...e.app.launchParams},sessionUuid:e.app.sessionUuid},params:{whitelist_scopes:e.app.whitelistScopes,group_whitelist_scopes:e.app.groupWhitelistScopes,need_policy_confirmation:e.app.needPolicyConfirmation},bridgeMethodsToBeLogged:e.app.bridgeMethodsToBeLogged,containerId:e.containerId,sendEventToMiniApp:e.sendEventToMiniApp,showModal:e.showModal}}(t),d={...o,pic:t.app.appImage,containerId:c.containerId};p.handler(d,c,s)}))}}te=(0,s.Cg)([n.z8.global()],te);var ie=i(808911),se=i(754694),ne=i(774048),ae=i(38191),oe=i(787187);const re=e=>{const t=e.app.launchParams||{},{allowed_origin_regexp:i,is_counter_cell_available:s,is_recommended_available:n,vkpay_not_layer_services:a,is_can_quit_vk_app:o,is_need_bookmark_button_in_menu:r,is_valid_make_order_hash:p,is_valid_confirm_order_hash:c,is_valid_mini_app_order_hash:d,share_info:l}=t,{orderId:h,itemId:u,confirmOrder:g}=e.app.orderParams||{};return{containerId:e.containerId,url:e.app.url,sessionUuid:e.app.sessionUuid??"",get cont(){return document.getElementById(e.containerId)},options:{aid:e.app.id,type:e.app.isIframeMode?oe.W:0,src:e.app.url,layer:e.app.layer,is_calls_available:e.app.isCallsAvailable,gid:e.groupId,app_image:e.app.appImage||"",app_name:e.app.title,profile_buttons:{available:e.app.profileButtons?.available??!1,installed:e.app.profileButtons?.installed??!1,hash:e.app.securityHash.profile_buttons_hash??""},embed:e.app.embed,vkApp:e.app.isMiniApp,bridge_methods_to_be_logged:e.app.bridgeMethodsToBeLogged,is_internal_app:e.app.isInternalApp,app_group_id:e.app.appGroupId,is_recommended:e.app.isRecommended,is_install_to_group_available:e.app.launchParams?.user_actions?.can_install_to_group??!1,is_favorite:Boolean(e.app.isFavorite),is_notifications_enabled:Boolean(e.app.notificationsEnabled),is_vkpay_app:e.app.isVkPayApp,vk_app_connect_host:e.app.vkAppConnectHost,is_textlive_app:e.app.isTextliveApp,is_mini_app_flow:e.app.isMiniAppFlow?1:0,...e.app.securityHash,allowed_origin_regexp:i,is_counter_cell_available:s,is_recommended_available:n,vkpay_not_layer_services:a,is_can_quit_vk_app:o,is_need_bookmark_button_in_menu:r,need_make_order:p,need_confirm_order:c,need_confirm_miniapp_order:d,need_order_id:h,need_order_item_id:u,need_miniapp_order_id:h,need_miniapp_order_item_id:u,need_order_confirm_hash:g,need_miniapp_order_confirm_hash:g,mini_apps_web_call_api_form_data:e.app.callApiFormData,tc:e.statsConfig.data?.trackCode},params:{whitelist_scopes:e.app.whitelistScopes,group_whitelist_scopes:e.app.groupWhitelistScopes,need_policy_confirmation:e.app.needPolicyConfirmation,viewer_id:e.app.viewerId??void 0,api_id:e.app.id,access_token:e.accessToken??""},get frame(){return e.iframe??(t=e.containerId,document.querySelector(`#${t} iframe`)??void 0);var t},lockModalType:e.modalManager.lock,unlockModalType:e.modalManager.unlock,isModalTypeLocked:e.modalManager.isLocked,RPC:e.RPC,funcs:{},isDirectGame:e.app.isDirectGame,updateAppData:e.updateAppData,getSDKBridgeHandler:e.app.getSDKBridgeHandler,shareInfo:l}};class pe extends ne.Q{setCurrentApp(e){const t=this.state.value?.cont===e?.cont,i=this.getCurrentApp(),s=i?.options.layer;!s||t?(t||(this.prevState=this.state.value),this.state.value=e,window.cur.app=e):this.prevState=e}getCurrentApp(){return this.state.value}clearCurrentAppInstance(){this.state.value=this.prevState??null,window.cur.app=this.prevState??null,delete this.prevState,window.cur.clearVKMiniAppsLayerPopups&&window.cur.clearVKMiniAppsLayerPopups()}updateCurrentAppInstance(){if(!this.appContext)return;const e=re(this.appContext);this.setCurrentApp(e)}checkAppInstanceMatch(){const e=this.getCurrentApp();return!(!this.appContext||!e||this.appContext?.app?.id!==e?.options?.aid)}addLegacyApiCallbacks(){const e=this.getCurrentApp();if(!e||!this.legacyApi)return;Object.keys(this.legacyApi).forEach((t=>{e[t]=this.legacyApi?.[t].bind(e)??se.l}))}addLegacyFuncsCallbacks(){const e=this.getCurrentApp();if(!e||!this.legacyFuncs)return;Object.keys(this.legacyFuncs).forEach((t=>{e.funcs[t]=this.legacyFuncs?.[t].bind(e)??se.l}))}constructor(...e){super(...e),this.state=(0,ae.N)(),this.legacyApi={runCallback:se.l,api:se.l,checkMethod:se.l,checkMethodResult:se.l,showWallPostBox:se.l},this.legacyFuncs={setLocation:se.l,showWallPostBox:se.l,getLocationProtocol:se.l,debug:se.l,startHandleDeviceOrientation:se.l}}}var ce=i(464229);class de extends pe{async ensure(){if(this.loaded)return;const{setLocation:e,showWallPostBox:t,showInviteBox:s,showRequestBox:n,showLeaderBoard:a,showProfilePhotoBox:o,selectChatsBox:r,showOrderBox:p,getLocationProtocol:c,showPaymentBox:d,showLeadsPaymentBox:l,debug:h,startHandleDeviceOrientation:u,scrollWindow:g,scrollTop:_,scrollSubscribe:m,showSubscriptionBox:S,default:A}=await(0,ie.p)((()=>Promise.all([i.e(51220),i.e(26645),i.e(69171),i.e(4832),i.e(14046),i.e(23349),i.e(36982),i.e(44691),i.e(4267),i.e(27579),i.e(66902),i.e(17918),i.e("langs/core_spa/mini_apps_vk_app_web")]).then(i.bind(i,18749))),3);this.legacyApi={registerVkBridgeCallback:A.prototype.registerVkBridgeCallback,runCallback:A.prototype.runCallback,initClientExternalApp:A.prototype.initClientExternalApp,api:A.prototype.api,checkMethod:A.prototype.checkMethod,checkMethodResult:A.prototype.checkMethodResult,startHandleWheelEvent:A.prototype.startHandleWheelEvent,stopHandleWheelEvent:A.prototype.stopHandleWheelEvent,setLocation:A.prototype.setLocation,showRequestBox:A.prototype.showRequestBox,showInviteBox:A.prototype.showInviteBox,showOrderBox:A.prototype.showOrderBox,showWallPostBox:A.prototype.showWallPostBox,isOpenInLayer:A.prototype.isOpenInLayer,showBox:ce.G},this.legacyFuncs={setLocation:e,showWallPostBox:t,showInviteBox:s,showRequestBox:n,showLeaderBoard:a,showProfilePhotoBox:o,selectChatsBox:r,showOrderBox:p,getLocationProtocol:c,showPaymentBox:d,showLeadsPaymentBox:l,debug:h,startHandleDeviceOrientation:u,scrollWindow:g,showSubscriptionBox:S,scrollTop:_,scrollSubscribe:m},this.loaded=!0}updateCurrentAppInstance(){this.appContext&&(super.updateCurrentAppInstance(),this.checkAppInstanceMatch()&&this.addWebCallbacks())}clearCurrentAppInstance(){super.clearCurrentAppInstance(),this.getCurrentApp()&&this.addWebCallbacks()}addWebCallbacks(){const e=this.getCurrentApp();e&&(e.vkBridgeCallbacks={},this.addLegacyApiCallbacks(),this.addLegacyFuncsCallbacks())}constructor(...e){super(...e),this.loaded=!1}}de=(0,s.Cg)([n.z8.global()],de);var le=i(651313),he=i(882567);class ue{constructor(e){this.appsService=e,this.reactions=new Map,this.addReaction=(e,t)=>{if(!t)return;const i=this.reactions.get(e);i?i.add(t):this.reactions.set(e,new Set([t]))},this.removeReaction=(e,t)=>{const i=this.reactions.get(e);t&&i&&i.delete(t)},this.getReactions=e=>new Set(this.reactions.get(e)),this.setStartReactions=()=>{this.addCommonReactions()},this.addCommonReactions=()=>{this.addReaction(he.od.VKWebAppAddToFavorites,(({appId:e})=>{this.appsService.updateAppData(e,{isFavorite:!0})}))}}}ue=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===m.m?Object:m.m])],ue);var ge=i(581922);class _e extends ue{constructor(e,t){super(t),this.internalApi=e,this.setStartReactions=()=>{this.addCommonReactions(),this.addReaction(he.od.VKWebAppAddToFavorites,(async e=>{if(!e.data.result)return;const t=await this.internalApi.getWebLeftMenu({});(0,ge.xG)({method:"internal.getWebLeftMenu",request:null,response:t,error:null})}))},this.setStartReactions()}}_e=(0,s.Cg)([n.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===le.O?Object:le.O,void 0===m.m?Object:m.m])],_e);const me=({isLayer:e})=>({CurrentAppProviderImpl:de,MonolithHandlerProviderImpl:te,VotesServiceImpl:g,MiniAppsLegacyServiceImpl:c,NotificationsAutoPermissionSnackbarImpl:C,MiniAppHandlerReactionProviderImpl:_e,MiniAppLocationServiceImpl:e?l:h,MiniAppCustomMessageServiceImpl:U,MiniAppInviteFriendsServiceImpl:J,MiniAppRequestBoxServiceImpl:X,MiniAppCallServiceImpl:ee})},835754:(e,t,i)=>{i.d(t,{r:()=>He});var s=i(221020),n=i(815287),a=i(356035),o=i(794323),r=i(115596),p=i(42107),c=i(946918),d=i(865940),l=i(704399),h=i(638945),u=i(772812),g=i(409698),_=i(187233),m=i(694809),S=i(799649);const A=({text:e,beforeIcon:t,children:i,testId:a,iconColor:o="color_icon_medium",textColor:r="color_text_primary",onClick:p,href:c,target:l,isLoadingAction:g,keepOpen:_,...m})=>(0,n.createElement)(d.v.Item,{...m,onClick:p,href:c,target:l,disabled:g,key:e,"data-testid":a,keepOpen:_,loading:g,before:t&&(0,s.Y)(S.K,{noPadding:!0,label:e,hasHover:!1,hasActive:!1,className:(0,u.I)(o),children:t})},(0,s.Y)(h.tW,{className:(0,u.I)(r),children:i||e})),v=e=>e?"enabled":"disabled",f=({actionsConfig:e,hints:t,hash:i="",query:n})=>{const{getHintText:a,canTooltipBeShown:o,hideHint:r,dropdownMenuOpened:p}=t;return e.map((({text:e,beforeIcon:t,testId:c,state:d="enabled",iconColor:l,textColor:h,onClick:u,href:g,target:_,isLoadingAction:S,tooltip:v,keepOpen:f},y)=>{const b="string"==typeof e?e:e[d],C="string"==typeof c?c:c[d],w=t.hasOwnProperty("enabled")?t[d]:t;const I=u?()=>u({hash:i,query:n}):void 0;return v?(0,s.Y)(m.m,{placement:v.placement,appearance:v.appearance,text:a(v.hintName),shown:o(v.hintName)&&p,enableInteractive:!0,onClick:()=>r(v.hintName),usePortal:!1,children:(0,s.Y)(A,{textColor:h,text:b,beforeIcon:w,iconColor:l,testId:C,onClick:()=>{I?.(),r(v.hintName)},href:g,target:_,isLoadingAction:S,keepOpen:f})},y):(0,s.Y)(A,{textColor:h,text:b,beforeIcon:w,iconColor:l,testId:C,onClick:I,href:g,target:_,isLoadingAction:S,keepOpen:f},y)}))};var y=i(331635),b=i(327813),C=i(754694),w=i(722934),I=i(273193),E=i(916533),T=i(651313),O=i(97929),M=i(651253),D=i(54952);class P{async recommendApp(e){await this.appsApi.recommend({app_id:e,is_recommended:1}),this.appsService.updateAppData(e,{isRecommended:!0})}async unrecommendApp(e){await this.appsApi.recommend({app_id:e,is_recommended:0}),this.appsService.updateAppData(e,{isRecommended:!1})}constructor(e,t){this.appsApi=e,this.appsService=t,(0,b.l_)(this)}}P=(0,y.Cg)([p.z8.container(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===w.V?Object:w.V,void 0===D.m?Object:D.m])],P);var k=i(642052),L=i(31312);const N=[{isAvailable:e=>Boolean(e.launchParams?.is_recommended_available),getScenario:e=>[[L.L.ACCOUNT_HINT_SUPERAPP_RECOMMEND_ACTION_IN_MENU,e("intro_hint_description_superapp_recommend_action_in_menu")],[L.L.ACCOUNT_HINT_SUPERAPP_SHOW_RECOMMEND_ACTION,e("intro_hint_description_superapp_show_recommend_action")]]},{isAvailable:e=>Boolean(e.profileButtons.available),getScenario:e=>[[L.L.ACCOUNT_HINT_MINI_APPS_NAV_BUTTONS_THIRD_PARTY_BUTTONS,e("intro_hint_description_mini_apps_nav_buttons_third_party_buttons")]]},{isAvailable:e=>Boolean(e.launchParams?.is_counter_cell_available),getScenario:e=>[[L.L.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_INTRO_WEB,e("intro_hint_description_mini_apps_counter_toggle_in_action_menu_intro_web")],[L.L.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_WEB,e("intro_hint_description_mini_apps_counter_toggle_in_action_menu_web")]]}];var W=i(780836);class B{async load(e){const t=this.getScenarios(e);await this.helpHints.ensureAll();for(const e of t){const t=e.filter((([e])=>Boolean(this.helpHints.get(e))&&!this.tooltips.isTooltipShown(e)));t.length&&this.setAvailableHints(new Map(t))}}show(){this.availableHints.forEach(((e,t)=>this.tooltips.showTooltip(t)))}setAvailableHints(e){this.availableHints=e}constructor(e,t,i){this.langs=e,this.helpHints=t,this.tooltips=i,this.availableHints=new Map,this.canHintBeShown=e=>Boolean(this.availableHints.has(e))&&this.tooltips.isTooltipShown(e),this.hideHint=e=>{this.tooltips.hideTooltip(e),this.helpHints.hide(e)},this.getHintText=e=>this.availableHints.get(e),this.getScenarios=e=>N.filter((t=>t.isAvailable(e))).map((e=>e.getScenario(this.langs.getLang))),(0,b.l_)(this)}}B=(0,y.Cg)([p.z8.container(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===I.Y?Object:I.Y,void 0===k.a?Object:k.a,void 0===W.S?Object:W.S])],B);var R=i(25313),x=i(559319);class V{async enableAppBadge(e){await this.appsApi.changeAppBadgeStatus({app_id:e,is_badge_allowed:1}),this.appsService.updateAppData(e,{isBadgeAllowed:!0})}async disableAppBadge(e){await this.appsApi.changeAppBadgeStatus({app_id:e,is_badge_allowed:0}),this.appsService.updateAppData(e,{isBadgeAllowed:!1})}constructor(e,t){this.appsApi=e,this.appsService=t,(0,b.l_)(this)}}V=(0,y.Cg)([p.z8.container(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===w.V?Object:w.V,void 0===D.m?Object:D.m])],V);var H=i(186742);class G{async addAppToBookmarks(e){await this.faveApi.addApp({app_id:e}),this.appsService.updateAppData(e,{isInBookmark:!0})}async removeAppFromBookmarks(e){await this.faveApi.removeApp({app_id:e}),this.appsService.updateAppData(e,{isInBookmark:!1})}constructor(e,t){this.faveApi=e,this.appsService=t,(0,b.l_)(this)}}G=(0,y.Cg)([p.z8.container(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===H.L?Object:H.L,void 0===D.m?Object:D.m])],G);var K=i(221473),F=i(289375);class j{logActionMenuEvent(e,t,i){this.productionStats.send({screen:void 0,type:"type_click",type_click:{item:{type:t?"game":"mini_app",id:e},type:"type_mini_app_item",type_mini_app_item:{type:i}}})}constructor(e){this.productionStats=e,(0,b.l_)(this)}}j=(0,y.Cg)([p.z8.container(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===F.X?Object:F.X])],j);var U=i(934794),Y=i(581922),z=i(22225),J=i(855625),q=i(240557),X=i(86195),Q=i(760435),$=i(473148),Z=i(568887),ee=i(786936),te=i(848659),ie=i(223681),se=i(518710),ne=i(636621),ae=i(426511),oe=i(868689),re=i(927841),pe=i(152517),ce=i(920436),de=function(e){return e.RECOMMEND="RECOMMEND",e.FAVORITE="FAVORITE",e.BOOKMARK="BOOKMARK",e.SHARE="SHARE",e.QR_CODE="QR_CODE",e.COUNTER="COUNTER",e.HELP="HELP",e.DELETE="DELETE",e.SETTINGS="SETTINGS",e.SEND_TO_PHONE="SEND_TO_PHONE",e.REPORT="REPORT",e.INVITE_FRIENDS="INVITE_FRIENDS",e.ADD_TO_COMMUNITY="ADD_TO_COMMUNITY",e.MANAGE="MANAGE",e}({});const le=["RECOMMEND","FAVORITE","BOOKMARK","SHARE","INVITE_FRIENDS"],he=["SETTINGS","QR_CODE","SEND_TO_PHONE","ADD_TO_COMMUNITY","COUNTER","HELP","REPORT","DELETE","MANAGE"],ue={ADD_TO_COMMUNITY:{beforeIcon:(0,s.Y)(z.K,{}),testId:"app_actions_menu_add_to_mine_group"},INVITE_FRIENDS:{beforeIcon:(0,s.Y)(J.R,{}),testId:"app_actions_menu_invite_friends",iconColor:"color_icon_accent",textColor:"color_text_link"},RECOMMEND:{beforeIcon:{enabled:(0,s.Y)(q.O,{}),disabled:(0,s.Y)(X.G,{})},testId:{enabled:"app_recommend_action_remove",disabled:"app_recommend_action_add"},iconColor:"color_icon_accent",textColor:"color_text_link",tooltip:{placement:"left",appearance:"accent",hintName:L.L.ACCOUNT_HINT_SUPERAPP_SHOW_RECOMMEND_ACTION}},FAVORITE:{beforeIcon:{enabled:(0,s.Y)(Q.e,{}),disabled:(0,s.Y)($.A,{})},testId:{enabled:"app_actions_menu_remove_from_favourites",disabled:"app_actions_menu_add_to_favourites"},iconColor:"color_icon_accent",textColor:"color_text_link"},BOOKMARK:{beforeIcon:{enabled:(0,s.Y)(Z.e,{}),disabled:(0,s.Y)(ee.U,{})},testId:{enabled:"app_actions_menu_remove_from_bookmarks",disabled:"app_actions_menu_add_to_bookmarks"},iconColor:"color_icon_accent",textColor:"color_text_link"},SHARE:{beforeIcon:(0,s.Y)(te.f,{}),testId:"app_actions_menu_share_app",iconColor:"color_icon_accent",textColor:"color_text_link"},SEND_TO_PHONE:{beforeIcon:(0,s.Y)(ie.V,{}),testId:"app_actions_menu_send_push_request"},REPORT:{beforeIcon:(0,s.Y)(se.y,{}),testId:"app_actions_menu_report_app"},QR_CODE:{beforeIcon:(0,s.Y)(ne.w,{}),testId:"app_actions_menu_show_qr_code"},COUNTER:{beforeIcon:(0,s.Y)(ae.E,{}),testId:"app_actions_menu_toggle_counter",tooltip:{placement:"left",appearance:"accent",hintName:L.L.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_WEB}},HELP:{beforeIcon:(0,s.Y)(oe.V,{}),testId:"app_actions_menu_help"},DELETE:{beforeIcon:(0,s.Y)(re.z,{}),testId:"app_actions_menu_delete_app",iconColor:"color_icon_negative",textColor:"color_text_negative"},SETTINGS:{beforeIcon:(0,s.Y)(pe.p,{}),testId:"app_actions_menu_open_settings"},MANAGE:{beforeIcon:(0,s.Y)(ce.m,{}),testId:"app_actions_menu_manage"}},ge=[L.L.ACCOUNT_HINT_SUPERAPP_RECOMMEND_ACTION_IN_MENU,L.L.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_INTRO_WEB,L.L.ACCOUNT_HINT_MINI_APPS_NAV_BUTTONS_THIRD_PARTY_BUTTONS],_e=(e,t)=>({...ue[e],text:t[e],state:"enabled"});var me=i(35620);class Se{get langs(){return this.props.langs}get snackbar(){return this.props.snackbar}get appData(){return this.props.getAppData()}closeAppActionMenu(){return this.props.closeAppActionMenu?.()}get navigate(){return this.props.navigate}updateLeftMenu(){return this.props.updateLeftMenu?.()}get appsModalsService(){return this.props.appsModalsService}get handleError(){return this.props.handleError}get sendEventToMiniApp(){return this.props.sendEventToMiniApp}get logStatsEvent(){return this.props.logStatsEvent}get appId(){return this.appData.id}constructor(e){this.props=e,(0,b.Gn)(this)}}(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"langs",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"snackbar",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"appData",null),(0,y.Cg)([b.XI,(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[]),(0,y.Sn)("design:returntype",void 0)],Se.prototype,"closeAppActionMenu",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"navigate",null),(0,y.Cg)([b.XI,(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[]),(0,y.Sn)("design:returntype",void 0)],Se.prototype,"updateLeftMenu",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"appsModalsService",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"handleError",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"sendEventToMiniApp",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"logStatsEvent",null),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Se.prototype,"appId",null);var Ae=i(464229);class ve extends Se{get actionConfig(){return{onClick:this.share}}constructor(e,t){super(t),this.authService=e,this.share=({hash:e})=>{const{groupId:t}=this.appData,i=t||this.authService.userId;(0,Ae.G)("like.php",{act:"publish_box",object:`app${this.appData.id}_${i}`,url_hash:e,layer:this.appData.layer}),this.logStatsEvent(me.iL.ACTION_MENU_SHARE)},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],ve.prototype,"share",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],ve.prototype,"actionConfig",null);const fe="/services",ye="/games?act=popular";class be extends Se{get actionConfig(){return{onClick:this.showSettings}}constructor(e,t){super(t),this.appsApi=e,this.onDeleted=()=>{this.snackbar.show({type:"ok",text:this.appData.isAnyGame?this.langs.getLang("apps_snackbar_deleted_game_text"):this.langs.getLang("apps_snackbar_deleted_app_text")}),this.logStatsEvent(me.iL.ACTION_MENU_DELETE),this.closeAppActionMenu(),this.navigate(this.appData.isAnyGame?ye:fe)},this.showSettings=()=>{this.appsModalsService.show({type:"SettingsModal",data:{appId:this.appId},actions:{onDeleted:this.onDeleted}})},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],be.prototype,"onDeleted",void 0),(0,y.Cg)([b.XI],be.prototype,"showSettings",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],be.prototype,"actionConfig",null);class Ce extends Se{get actionConfig(){return{hidden:this.isOwner,onClick:this.reportApp}}constructor(e,t){super(t),this.isOwner=e,this.reportApp=()=>{this.appsModalsService.show({type:"ReportModal",data:{appId:this.appData.id,authorId:this.appData.authorId??0}})},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],Ce.prototype,"reportApp",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Ce.prototype,"actionConfig",null);var we=i(578345);class Ie extends Se{get actionConfig(){const{isMiniApp:e}=this.appData;return{isLoadingAction:this._isLoading,onClick:this.sendInstallRequest,hidden:!e,keepOpen:!0}}constructor(e,t){super(t),this.sendInstallLinkService=e,this._isLoading=!1,this.sendInstallRequest=async({query:e={},hash:t=""})=>{const i=(0,we.vs)(e.ref);try{(0,b.h5)((()=>{this._isLoading=!0}));await this.sendInstallLinkService.sendInstallRequest({appId:this.appData.id,hash:t,ref:i})&&this.snackbar.show({type:"ok",text:this.langs.getLang("apps_install_request_success"),duration:3e3})}catch(e){this.handleError(e)}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],Ie.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],Ie.prototype,"sendInstallRequest",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Ie.prototype,"actionConfig",null);class Ee extends Se{get actionConfig(){const{isAnyGame:e,launchParams:t}=this.appData,{user_actions:{can_invite_friends:i}={}}=t??{};return{onClick:this.showInviteFriendsModal,hidden:!e||!i}}constructor(e){super(e),this.showInviteFriendsModal=()=>{this.appsModalsService.show({type:"InviteFriendsModal",data:{appId:this.appData.id},actions:{}})},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],Ee.prototype,"showInviteFriendsModal",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Ee.prototype,"actionConfig",null);class Te extends Se{get actionConfig(){const{launchParams:e}=this.appData,{user_actions:{can_install_to_group:t}={}}=e??{};return{onClick:this.showAddToCommunityModal,hidden:!t,isLoading:this._isLoading}}constructor(e,t){super(t),this.appsApi=e,this._isLoading=!1,this.showAddToCommunityModal=async()=>{this._isLoading=!0;try{const e=await this.appsApi.getGroupsList({app_id:this.appData.id});this.appsModalsService.show({type:"AddToCommunityModal",data:{app:this.appData,groupsInfo:e},actions:{}})}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],Te.prototype,"showAddToCommunityModal",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Te.prototype,"actionConfig",null);class Oe extends Se{get actionConfig(){const{launchParams:e}=this.appData,{is_can_quit_vk_app:t}=e??{};return{onClick:this.deleteApp,isLoadingAction:this._isLoading,hidden:!t||this.isOwner}}constructor(e,t){super(t),this.isOwner=e,this._isLoading=!1,this.onDeleted=()=>{this.snackbar.show({type:"ok",text:this.appData.isAnyGame?this.langs.getLang("apps_snackbar_deleted_game_text"):this.langs.getLang("apps_snackbar_deleted_app_text")}),this.updateLeftMenu(),this.logStatsEvent(me.iL.ACTION_MENU_DELETE),this.closeAppActionMenu(),this.navigate(this.appData.isAnyGame?ye:fe)},this.onTriggerDelete=()=>{this._isLoading=!0},this.onDeleteComplete=()=>{this._isLoading=!1},this.deleteApp=async()=>{this._isLoading||this.appsModalsService.show({type:"DeleteMiniAppModal",data:{appId:this.appId,isAnyGame:this.appData.isAnyGame},actions:{onDeleted:this.onDeleted,onTriggerDelete:this.onTriggerDelete,onDeleteComplete:this.onDeleteComplete,onDeleteFailed:this.handleError}})},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],Oe.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],Oe.prototype,"onDeleted",void 0),(0,y.Cg)([b.XI],Oe.prototype,"onTriggerDelete",void 0),(0,y.Cg)([b.XI],Oe.prototype,"onDeleteComplete",void 0),(0,y.Cg)([b.XI],Oe.prototype,"deleteApp",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Oe.prototype,"actionConfig",null);class Me extends Se{get actionConfig(){const{launchParams:e}=this.appData,{user_actions:{can_add_to_favourite:t}={}}=e??{};return{onClick:this.toggleFavorites,isLoadingAction:this._isLoading,state:v(this.appData.isFavorite),hidden:!t,keepOpen:!0}}constructor(e,t){super(t),this.appsFavoriteService=e,this._isLoading=!1,this.toggleFavorites=async()=>{if(this._isLoading)return;const{isFavorite:e,isAnyGame:t}=this.appData;this._isLoading=!0;try{this.logStatsEvent(e?me.iL.ACTION_MENU_REMOVE_FROM_FAVOURITES:me.iL.ACTION_MENU_ADD_TO_FAVOURITES);const i={appId:this.appId,isGame:t};await(e?this.appsFavoriteService.unfavoriteApp(i):this.appsFavoriteService.favoriteApp(i)),this.updateLeftMenu()}catch(e){this.handleError(e)}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],Me.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],Me.prototype,"toggleFavorites",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Me.prototype,"actionConfig",null);class De extends Se{get actionConfig(){return{onClick:this.showQRHandler}}constructor(e){super(e),this.showQRHandler=()=>{this.closeAppActionMenu(),this.appsModalsService.show({type:"QRModal",data:{appId:this.appId},actions:{}})},(0,b.Gn)(this)}}(0,y.Cg)([b.XI],De.prototype,"showQRHandler",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],De.prototype,"actionConfig",null);class Pe extends Se{get actionConfig(){const{launchParams:e}=this.appData,{is_recommended_available:t}=e??{},i=v(this.appData.isRecommended);return{onClick:this.toggleRecommend,isLoadingAction:this._isLoading,state:i,hidden:!t,keepOpen:!0}}constructor(e,t){super(t),this.appsRecommendationsService=e,this._isLoading=!1,this.toggleRecommend=async()=>{if(this._isLoading)return;const{isRecommended:e}=this.appData;this._isLoading=!0;try{this.logStatsEvent(e?me.iL.ACTION_MENU_UNRECOMMEND:me.iL.ACTION_MENU_RECOMMEND),await(e?this.appsRecommendationsService.unrecommendApp(this.appId):this.appsRecommendationsService.recommendApp(this.appId))}catch(e){this.handleError(e)}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],Pe.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],Pe.prototype,"toggleRecommend",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Pe.prototype,"actionConfig",null);class ke extends Se{get actionConfig(){const{launchParams:e}=this.appData,{is_need_bookmark_button_in_menu:t}=e??{};return{isLoadingAction:this._isLoading,onClick:this.toggleBookmark,state:v(this.appData.isInBookmark),hidden:!t,keepOpen:!0}}constructor(e,t){super(t),this.appsBookmarkService=e,this._isLoading=!1,this.toggleBookmark=async()=>{if(this._isLoading)return;const{isInBookmark:e}=this.appData;this._isLoading=!0;try{this.logStatsEvent(e?me.iL.ACTION_MENU_REMOVE_FROM_BOOKMARKS:me.iL.ACTION_MENU_ADD_TO_BOOKMARKS),await(e?this.appsBookmarkService.removeAppFromBookmarks(this.appId):this.appsBookmarkService.addAppToBookmarks(this.appId))}catch(e){this.handleError(e)}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],ke.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],ke.prototype,"toggleBookmark",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],ke.prototype,"actionConfig",null);class Le extends Se{get actionConfig(){const{launchParams:e}=this.appData,{is_counter_cell_available:t}=e??{};return{onClick:this.toggleCounter,isLoadingAction:this._isLoading,state:v(this.appData.isBadgeAllowed),hidden:!t}}constructor(e,t){super(t),this.appsBadgeService=e,this._isLoading=!1,this.toggleCounter=async()=>{if(this._isLoading)return;const{isBadgeAllowed:e}=this.appData;this.logStatsEvent(e?me.iL.ACTION_MENU_DISABLE_BADGES:me.iL.ACTION_MENU_ENABLE_BADGES),this._isLoading=!0;try{await(e?this.appsBadgeService.disableAppBadge(this.appId):this.appsBadgeService.enableAppBadge(this.appId)),this.updateLeftMenu()}catch(e){this.handleError(e)}finally{(0,b.h5)((()=>{this._isLoading=!1}))}},(0,b.Gn)(this)}}(0,y.Cg)([b.sH],Le.prototype,"_isLoading",void 0),(0,y.Cg)([b.XI],Le.prototype,"toggleCounter",void 0),(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Le.prototype,"actionConfig",null);class Ne extends Se{get actionConfig(){return{href:this.appData.supportUrl,target:"_blank",hidden:!this.appData.supportUrl}}constructor(e){super(e),(0,b.Gn)(this)}}(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],Ne.prototype,"actionConfig",null);class We extends Se{get actionConfig(){return{href:this.appData.manageLink,target:"_blank",hidden:!this.appData.manageLink}}constructor(e){super(e),(0,b.Gn)(this)}}(0,y.Cg)([b.EW,(0,y.Sn)("design:type",void 0),(0,y.Sn)("design:paramtypes",[])],We.prototype,"actionConfig",null);class Be{async setSendEventToMiniApp(){const e=await this.launchDataProvider.getLaunchData();this.sendEventToMiniApp=e?.sendEventToMiniApp}get actionBaseProps(){return{langs:this.langs,navigate:this.navigate,snackbar:this.snackbar,closeAppActionMenu:C.l,getAppData:()=>this.appData,appsModalsService:this.appsModalService,handleError:this.handleError,logStatsEvent:this.logStatsEvent,sendEventToMiniApp:this.sendEventToMiniApp,updateLeftMenu:this.updateLeftMenu}}get navigate(){return this.props.current.navigate}get container(){return this.props.current.container}get query(){return this.launchDataProvider.launchProps?.queryParams}get hash(){return this.launchDataProvider.launchProps?.location||""}get content(){return this.props.current.content}get hasDeveloperButton(){return!this.isOwner&&this.props.current.hasDeveloperButton}get authorUrl(){return this.props.current.appData.authorUrl}get authorName(){return this.props.current.appData.authorName}get allowTooltips(){return this.props.current.allowTooltips}get isOwner(){const{authorId:e}=this.appData;return e===this.authService.userId}get actionsMenuButtonHintId(){return ge.find((e=>this.canTooltipBeShown(e)))}get hintTextForActionsMenuButton(){return this.actionsMenuButtonHintId&&this.hints.getHintText(this.actionsMenuButtonHintId)}async[p.Ts]({allowTooltips:e}){e&&this.loadHints()}get appData(){return this.props.current.appData}async loadHints(){await this.hints.load(this.appData),this.hints.show()}get actions(){const e=(({getLang:e},t)=>({[de.RECOMMEND]:{enabled:e("apps_vk_app_already_recommend"),disabled:e("apps_vk_app_recommend")},[de.FAVORITE]:{enabled:e("apps_vk_app_remove_from_favourite"),disabled:e("apps_vk_app_add_to_favourite")},[de.BOOKMARK]:{enabled:e("apps_remove_app_from_bookmarks"),disabled:e("apps_add_app_to_bookmarks")},[de.SHARE]:e("apps_share_app"),[de.QR_CODE]:e("apps_show_qr_code"),[de.COUNTER]:{enabled:e("vkapps_action_menu_disable_counter"),disabled:e("vkapps_action_menu_allow_counter")},[de.HELP]:e("apps_help"),[de.DELETE]:e("apps_delete"),[de.SETTINGS]:e("apps_settings"),[de.SEND_TO_PHONE]:e("apps_vk_app_send_push_action"),[de.REPORT]:e("apps_report"),[de.INVITE_FRIENDS]:e("apps_invite_friends"),[de.ADD_TO_COMMUNITY]:e("apps_group_add_to_mine_group"),[de.MANAGE]:e(t?"apps_game_editing":"apps_editing")}))(this.langs,this.appData?.isAnyGame);return[le.map((t=>({..._e(t,e),...this.actionModels[t]?.actionConfig}))),he.map((t=>({..._e(t,e),...this.actionModels[t]?.actionConfig})))].map((e=>e.filter((({hidden:e})=>!e))))}constructor(e,t,i,s,n,a,o,r,p,c,d,l,h,u,g,_){this.appsRecommendationsService=e,this.appsApi=t,this.hints=i,this.langs=s,this.authService=n,this.appsModalService=a,this.props=o,this.appsFavoriteService=r,this.appsBadgeService=p,this.appsBookmarkService=c,this.internalApi=d,this.actionMenuAnalytics=l,this.launchDataProvider=h,this.sendInstallLinkService=u,this.snackbar=g,this.errorLogger=_,this.canTooltipBeShown=e=>this.allowTooltips&&this.hints.canHintBeShown(e),this.logStatsEvent=e=>{const{isDirectGame:t}=this.appData;this.actionMenuAnalytics.logActionMenuEvent(this.appData.id,t,e)},this.updateLeftMenu=async()=>{const e=await this.internalApi.getWebLeftMenu({});(0,Y.xG)({method:"internal.getWebLeftMenu",request:null,response:e,error:null})},this.handleError=e=>{e&&this.errorLogger.log(e),this.snackbar.show({type:"error",text:this.langs.getLang("global_internal_error")})},this.setSendEventToMiniApp(),this.actionModels={[de.DELETE]:new Oe(this.isOwner,this.actionBaseProps),[de.FAVORITE]:new Me(this.appsFavoriteService,this.actionBaseProps),[de.SHARE]:new ve(this.authService,this.actionBaseProps),[de.SETTINGS]:new be(this.appsApi,this.actionBaseProps),[de.QR_CODE]:new De(this.actionBaseProps),[de.RECOMMEND]:new Pe(this.appsRecommendationsService,this.actionBaseProps),[de.BOOKMARK]:new ke(this.appsBookmarkService,this.actionBaseProps),[de.COUNTER]:new Le(this.appsBadgeService,this.actionBaseProps),[de.REPORT]:new Ce(this.isOwner,this.actionBaseProps),[de.SEND_TO_PHONE]:new Ie(this.sendInstallLinkService,this.actionBaseProps),[de.INVITE_FRIENDS]:new Ee(this.actionBaseProps),[de.ADD_TO_COMMUNITY]:new Te(this.appsApi,this.actionBaseProps),[de.HELP]:new Ne(this.actionBaseProps),[de.MANAGE]:new We(this.actionBaseProps)},(0,b.l_)(this)}}Be=(0,y.Cg)([p.z8.transient(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===P?Object:P,void 0===w.V?Object:w.V,void 0===B?Object:B,void 0===I.Y?Object:I.Y,void 0===E.u?Object:E.u,void 0===R.F?Object:R.F,void 0===p.Ji?Object:p.Ji,void 0===x.c?Object:x.c,void 0===V?Object:V,void 0===G?Object:G,void 0===T.O?Object:T.O,void 0===j?Object:j,void 0===K.n?Object:K.n,void 0===U.v?Object:U.v,void 0===O.q?Object:O.q,void 0===M.v?Object:M.v])],Be);const{Provider:Re,useModel:xe}=(0,p.Qd)(Be,{initInEffect:!1}),Ve=(0,a.P)((function(){const{actions:[e,t],appData:{launchParams:i,groupId:a,isGroupAdmin:p,id:S},hints:v,actionsMenuButtonHintId:y,hintTextForActionsMenuButton:b,hasDeveloperButton:C,content:w,authorUrl:I,authorName:E,query:T,hash:O,canTooltipBeShown:M,container:D}=xe(),{getHintText:P,hideHint:k}=v,{getLang:L}=(0,c.B)(),[N,W]=(0,n.useState)(!1);if(!i)return null;const B={getHintText:P,canTooltipBeShown:M,hideHint:k,dropdownMenuOpened:N};return(0,s.Y)(d.v,{trigger:"hover",onShownChange:e=>W(e),size:"s",placement:"top-start",keepMounted:!0,usePortal:D,content:(0,s.FD)(s.FK,{children:[!!a&&p&&(0,s.FD)(s.FK,{children:[(0,s.Y)(A,{href:`/club${a}?act=apps&from=app${S}`,target:"_blank",text:L("apps_community_settings"),beforeIcon:(0,s.Y)(o.O,{}),testId:"app_actions_menu_open_community_settings"}),(0,s.Y)(l.F,{size:8})]}),(0,s.Y)(f,{hints:B,actionsConfig:e,query:T,hash:O}),(0,s.Y)(l.F,{size:8}),(0,s.Y)(f,{hints:B,actionsConfig:t,query:T,hash:O}),C&&I&&E&&(0,s.FD)(s.FK,{children:[(0,s.Y)(l.F,{size:8}),(0,s.FD)(A,{multiline:!0,hasHover:!1,hasActive:!1,children:[(0,s.Y)(h.tW,{className:(0,u.I)("color_text_secondary"),children:L("apps_author_developer_widescreen")}),(0,s.Y)(g.$,{size:"s",mode:"link",appearance:"accent",href:I,target:"_blank",children:E})]})]})]}),children:(0,s.Y)(_.i,{role:"combobox","aria-label":L("apps_app_actions"),mode:"vertical",spacing:0,paddingTop:0,paddingBottom:0,children:(0,s.Y)(m.m,{placement:"top",appearance:"accent",text:b,shown:!!y&&!N,enableInteractive:!0,onShownChange:()=>y&&N&&k(y),children:w??(0,s.Y)(g.$,{size:"s",mode:"link",appearance:"accent",after:(0,s.Y)(r.q,{}),"data-testid":"app_actions_menu_button",children:L("apps_app_actions")})})})})})),He=(0,p.jn)(Re,Ve)},244716:(e,t,i)=>{i.d(t,{A:()=>L});var s=i(221020),n=i(409698),a=i(370633),o=i(187233),r=i(982444),p=i(405697),c=i(685441),d=i(423654),l=i(46284),h=i(42107),u=i(946918),g=i(356035),_=i(413621),m=i(948759),S=i(146186);const A={0:null,12:(0,s.Y)(m.N,{}),13:(0,s.Y)(m.N,{}),14:null},v=(0,g.P)((function({reason:e,isMvk:t}){return e in A?A[e]:(0,s.Y)(_._,{noBorder:!0,withTransparentBackground:!0,size:t?72:96,children:(0,s.Y)(S.r,{})})}));var f=i(788179),y=i(331635),b=i(327813),C=i(273193),w=i(693491);class I{async[h.Ts](){this.getSuggestedApps()}get placeholderInfo(){return this.props.current}get actionButton(){return this.placeholderInfo?.actionButton}get subtitle(){return this.placeholderInfo?.subtitle}get suggestedAppsIds(){return this.placeholderInfo?.suggestedAppsIds}get header(){return this.placeholderInfo?.title??this.langs.getLang("apps_placeholder_info_title_application_is_not_available")}get reason(){return this.placeholderInfo?.reason.toString()??""}get isLoading(){return this._isLoading}get suggestedApps(){return this._suggestedApps}async getSuggestedApps(){if(this.suggestedAppsIds?.length){(0,b.h5)((()=>{this._isLoading=!0}));try{const e=await this.additionalInfoService.getSuggestedApps(this.suggestedAppsIds);(0,b.h5)((()=>{this._suggestedApps=e,this._isLoading=!1}))}catch{(0,b.h5)((()=>{this._suggestedApps=null,this._isLoading=!1}))}}else(0,b.h5)((()=>{this._isLoading=!1,this._suggestedApps=null}))}get blockTitle(){return this.isMultiple?this.langs.getLang("apps_suggested_apps_header"):this.isGame?this.langs.getLang("apps_suggested_game_header"):this.langs.getLang("apps_suggested_app_header")}get isGame(){return["game","html5_game"].includes(this.suggestedApps?.items?.[0].type??"")}get isMultiple(){return!!this.suggestedAppsIds&&this.suggestedAppsIds.length>1}get controlPanel(){return this.props.current.controlPanel}constructor(e,t,i){this.props=e,this.langs=t,this.additionalInfoService=i,this._isLoading=!1,this._suggestedApps=null,this.onActionButtonClick=()=>{""===this.actionButton?.url&&window.location.reload()},(0,b.l_)(this)}}I=(0,y.Cg)([h.z8.transient(),(0,y.Sn)("design:type",Function),(0,y.Sn)("design:paramtypes",[void 0===h.Ji?Object:h.Ji,void 0===C.Y?Object:C.Y,void 0===w.R?Object:w.R])],I);const{Provider:E,useModel:T}=(0,h.Qd)(I,{initInEffect:!1});var O=i(120809),M=i(799835);const D=(e,t)=>{if(!e?.length)return"";const i=e.length-t,s=e.slice(0,t).map((e=>e.first_name)),n=s.join(", ");let a="",o="";i>0?(o=(0,M.Q1)(i,(0,M.Xo)("apps_game_of_week_other_friends_label","raw")),o=(0,M.Bn)(o,{count:i.toString()})):o="",a=1===s.length?(0,M.Xo)("apps_game_of_week_friend_label"):(0,M.Xo)("apps_game_of_week_friends_label");return(0,M.Bn)(a,{friends_names:n,other_friends:o})},P=e=>{const t=e?.map((({id:e,photo_100:t,first_name:i,last_name:s})=>({link:`/id${e}`,photo:t||"",name:`${i} ${s}`})));return{friends:t,text:D(e,3)}},k=(0,g.P)((function(){const{subtitle:e,header:t,reason:i,actionButton:h,suggestedApps:g,isLoading:_,blockTitle:m,isGame:S,isMultiple:A,controlPanel:y,onActionButtonClick:b}=T(),{getLang:C}=(0,u.B)(),w=h&&(0,s.Y)(n.$,{href:h.url,onClick:b,size:"m",children:h.title}),I=g||_;return(0,s.FD)(s.FK,{children:[(0,s.FD)(a.Y,{mode:I?"card":"plain",separator:I?"show":"hide",padding:"none",children:[y,(0,s.FD)(o.i,{mode:"vertical",paddingTop:8,paddingBottom:8,spacing:8,children:[(0,s.Y)(r.K,{size:48}),(0,s.Y)(p.O,{maxWidth:500,header:!!t&&(0,s.Y)("span",{"data-testid":"app_unavailable_screen_header",children:t}),action:w,icon:(0,s.Y)(v,{reason:i,isMvk:!1}),"data-testid":"app_unavailable_screen",children:(0,s.Y)("span",{"data-testid":"app_unavailable_screen_subtitle",children:e})}),(0,s.Y)(r.K,{size:48})]})]}),I&&(0,s.Y)(a.Y,{header:(0,s.Y)(c.Y,{mode:"primary",aside:!_&&(0,s.Y)(d.N,{"data-testid":"app_unavailable_screen_action",href:S?"/games":"/services",children:C("apps_vk_apps_show_all")}),children:_?(0,s.Y)(l.E,{width:140,height:16}):m}),children:A?(0,s.Y)(f.m,{suggestedApps:g?.items||null,isMvk:!1,isLoading:_}):(0,s.Y)(O.m,{app:g?.items[0],profiles:P(g?.profiles),isLoading:_})})]})})),L=(0,h.jn)(E,k)},998168:(e,t,i)=>{i.d(t,{m:()=>n});const s=1;function n(){return window?.devicePixelRatio??s}},819300:(e,t,i)=>{i.d(t,{s:()=>d});var s=i(331635),n=i(327813),a=i(340310),o=i(42107),r=i(349761),p=i(406656);class c{getProfile(e){if(e)return this.data.profilesMap.get(e)}setProfile(e){this.data.profilesMap.set(e.id,e)}constructor(){this.data={profilesMap:new Map},(0,n.l_)(this)}}c=(0,s.Cg)([o.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[])],c);class d{getGroup(e){const t="number"==typeof e?e:this.data.screenNameToIdMap.get(e);if(t)return this.groupsStore.getGroup(t)}createGroupFromApi({apiGroup:e,fields:t=[]}){let i=(0,r.G)(e);"string"==typeof i.screen_name&&this.data.screenNameToIdMap.set(i.screen_name,i.id);const s=this.getGroup(i.id);if(s){const e=Object.keys(i),n=t.filter((t=>!e.includes(t)));i={...s,...i},Object.keys(i).forEach((e=>{n.includes(e)&&i.hasOwnProperty(e)&&delete i[e]}))}const n=this.data.fieldsMap.get(i.id),a=n?[...new Set([...t,...n])]:t;return this.groupsStore.setGroup(i),this.data.fieldsMap.set(i.id,a),i}async createGroup(e){const t=await this.groupsApi.create(e);return this.createGroupFromApi({apiGroup:t})}async fetchGroupsByIds(e,t){const{groupIds:i,fields:s=[],...n}=e,a=[...this.fetchGroupsRequiredFields,...s],o=await this.groupsApi.getById({...n,group_ids:i.join(","),fields:a.join(",")},t);(o.profiles||[]).forEach((e=>{this.profilesStore.setProfile(e)}));return(o.groups||[]).map((e=>this.createGroupFromApi({apiGroup:e,fields:a})))}async ensureFetchGroupById(e,t){const{groupId:i,fields:s=[]}=e,n=this.getGroup(i),a=this.data.fieldsMap.get(i)||[];if(!n||s.some((e=>!a.includes(e)))){return(await this.fetchGroupsByIds({groupIds:[i],fields:s},t)).find((e=>e.id===i))}return n}async fetchGroupsExtended(e,{controller:t}={}){const i=await this.groupsApi.get({...e,extended:1},{signal:t?.signal}),s=i.items.map((t=>{const i=e.fields?.split(",")||[],s=[...new Set([...Object.keys(t),...i])];return this.createGroupFromApi({apiGroup:t,fields:s})}));return{...i,items:s}}async groupEdit(e,{controller:t,updateGroup:i=!0}={}){const s=e.group_id;if(!this.getGroup(s)&&i)return null;if(await this.groupsApi.edit(e,{signal:t?.signal}),!i)return null;const[n]=await this.fetchGroupsByIds({groupIds:[s]});return n}getProfile(e){return this.profilesStore.getProfile(e)}async getBlockedGroupInfo(e){return this.groupsApi.getBlockedInfo(e)}async unblockGroup(e){return this.groupsApi.unblock(e)}constructor(e,t,i){this.groupsApi=e,this.groupsStore=t,this.profilesStore=i,this.fetchGroupsRequiredFields=["is_member","member_status","is_closed"],this.data={fieldsMap:new Map,screenNameToIdMap:new Map},(0,n.l_)(this)}}d=(0,s.Cg)([o.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===a.D?Object:a.D,void 0===p.Y?Object:p.Y,void 0===c?Object:c])],d)},693491:(e,t,i)=>{i.d(t,{R:()=>d});var s=i(331635),n=i(327813),a=i(836382),o=i(42107),r=i(722934),p=i(819300),c=i(54952);class d{async loadGroupInfo(e,t){const i=await this.groupsService.ensureFetchGroupById({groupId:t});if(i){const{is_admin:s,name:n}=i;this.updateAppData(e,{groupId:t,groupTitle:n??t.toString(),isGroupAdmin:Boolean(s)})}}async loadAppActionsData(e){const[t,i]=await Promise.all([this.appsApi.getActionMenuApps({app_id:e}),this.appsApi.getActionMenuBanner({app_id:e})]);this.updateAppData(e,{recommendedApps:t.items.map((({app:e})=>{const{title:t,type:i,icon_139:s,icon_75:n,id:o,track_code:r}=e,p=n||"",c=s||p;return{title:t,id:o,isGame:"game"===i||"html5_game"===i,icon:(0,a.Q)()?c:p,trackCode:r}})),actionMenuBanner:i})}async getSuggestedApps(e){const t={app_fields:"title,type,icon_139,icon_278,"};e.length>1?t.app_fields+="genre":(t.app_fields+="short_description,banner_560,banner_1120",t.return_friends=1,t.fields="photo_100");return await this.appsApi.getApp({app_ids:e.join(","),...t})}updateAppData(e,t){this.appsService.updateAppData(e,t)}constructor(e,t,i){this.appsApi=e,this.appsService=t,this.groupsService=i,(0,n.l_)(this)}}d=(0,s.Cg)([o.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===r.V?Object:r.V,void 0===c.m?Object:c.m,void 0===p.s?Object:p.s])],d)},526048:(e,t,i)=>{i.d(t,{o:()=>p});var s=i(331635),n=i(327813),a=i(546793),o=i(42107),r=i(774048);class p{async ensure(){await this.currentAppProvider.ensure()}setCurrentAppContext({app:e,containerId:t,updateAppData:i,groupId:s,RPC:n,sendEventToMiniApp:a,statsConfig:o}){this.currentAppProvider.setContext({app:e,containerId:t,updateAppData:i,sendEventToMiniApp:a,accessToken:e.appAccessToken,modalManager:{lock:this.modalsLockService.lock.bind(this.modalsLockService),unlock:this.modalsLockService.unlock.bind(this.modalsLockService),isLocked:this.modalsLockService.isLocked.bind(this.modalsLockService)},groupId:s,RPC:n,statsConfig:o}),this.currentAppProvider.updateCurrentAppInstance()}updateCurrentAppContext({iframe:e,RPC:t,appAccessToken:i}){this.currentAppProvider.updateContextApp({iframe:e,RPC:t,accessToken:i}),this.currentAppProvider.updateCurrentAppInstance()}clearCurrentAppInstance(){this.currentAppProvider.clearCurrentAppInstance()}sendEventToMiniApp(...e){this.currentAppProvider.getContext()?.sendEventToMiniApp?.(...e)}constructor(e,t){this.modalsLockService=e,this.currentAppProvider=t,(0,n.l_)(this)}}p=(0,s.Cg)([o.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===a.J?Object:a.J,void 0===r.Q?Object:r.Q])],p)},559319:(e,t,i)=>{i.d(t,{c:()=>d});var s=i(331635),n=i(327813),a=i(42107),o=i(722934),r=i(97929),p=i(273193),c=i(54952);class d{async favoriteApp({appId:e,isGame:t,preventErrorHoisting:i}){try{await this.appsApi.addToMenu({app_id:e}),this.appsService.updateAppData(e,{isFavorite:!0}),this.successHandler({addedToFavorite:!0,isGame:t})}catch(e){this.errorHandler({menuApiError:e,isGame:t,preventErrorHoisting:i})}}async unfavoriteApp({appId:e,isGame:t,preventErrorHoisting:i}){try{await this.appsApi.removeFromMenu({app_id:e}),this.appsService.updateAppData(e,{isFavorite:!1}),this.successHandler({addedToFavorite:!1,isGame:t})}catch(e){this.errorHandler({menuApiError:e,isGame:t,preventErrorHoisting:i})}}constructor(e,t,i,s){this.appsApi=e,this.appsService=t,this.snackbar=i,this.langs=s,this.successHandler=({addedToFavorite:e,isGame:t})=>{this.snackbar.show({type:"ok",text:e?t?this.langs.getLang("apps_game_added_to_favorites"):this.langs.getLang("apps_added_to_favorites"):t?this.langs.getLang("apps_game_removed_from_favorites"):this.langs.getLang("apps_removed_from_favorites"),duration:3e3})},this.errorHandler=({menuApiError:e,isGame:t,preventErrorHoisting:i=!0})=>{if(this.snackbar.show({type:"error",text:1258===e?.error?.error_code?t?this.langs.getLang("apps_error_game_in_favorites_already"):this.langs.getLang("apps_error_app_in_favorites_already"):this.langs.getLang("apps_error_failed_add_to_favorites"),duration:3e3}),!i)throw new Error(e?.error?.error_msg)},(0,n.l_)(this)}}d=(0,s.Cg)([a.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.V?Object:o.V,void 0===c.m?Object:c.m,void 0===r.q?Object:r.q,void 0===p.Y?Object:p.Y])],d)},57894:(e,t,i)=>{i.d(t,{a:()=>a});var s=i(331635),n=i(42107);class a{setContainer(e){this.miniAppDIContainer||(this.miniAppDIContainer=e)}getContainer(){if(!this.miniAppDIContainer)throw new Error("MiniAppDIContainerProvider: MiniAppDIContainer is not set");return this.miniAppDIContainer}}a=(0,s.Cg)([n.z8.container()],a)},969645:(e,t,i)=>{i.d(t,{I:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.container({abstract:!0})],a)},791625:(e,t,i)=>{i.d(t,{E:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.container({abstract:!0})],a)},532800:(e,t,i)=>{i.d(t,{v:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.container({abstract:!0})],a)},474461:(e,t,i)=>{i.d(t,{m:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.container({abstract:!0})],a)},18528:(e,t,i)=>{i.d(t,{b:()=>_});var s=i(331635),n=i(261096),a=i(652097),o=i(736819),r=i(42107),p=i(645189),c=i(849645),d=i(221473),l=i(326486),h=i(695554),u=i(456603),g=i(801979);class _{initReactions(e,t){this.clearTechnicalQuery(),this.reactions.reaction(t,this.updateQuery),this.reactions.reaction(e,this.updateHash)}get appData(){return this.launchDataProvider.appData}get isAppModule(){const{module:e}=this.meta.get();return!this.env.partConfigEnabled("frontend.mini_apps_fix_location_service")||this.appData?.layer||"mini_app"===e||"game"===e}omitLeadingHashSymbol(e){return e.replace(/^#/,"")}omitQueryParams(e,t=u.ut){const i=g.R.reduce(((e,t)=>(0,a.lW)(e,t)),[...t]);return(0,n.A)(e,i)}clearTechnicalQuery(){if(!this.launchDataProvider.launchProps)return;const{queryParams:e={},location:t="",...i}=this.launchDataProvider.launchProps,s=this.omitQueryParams(e);if(this.appData?.layer)return void this.launchService.updateLayerParams({...i,queryParams:s,location:this.omitLeadingHashSymbol(t)},!0);const n=new URLSearchParams(s),a=n.size?`?${n}`:"",{pathname:o}=window.location;window.history.replaceState({},"",`${o}${a}${t}`)}constructor(e,t,i,s,n){this.env=e,this.launchService=t,this.launchDataProvider=i,this.meta=s,this.reactions=n,this.updateQuery=(e,t)=>{this.isAppModule&&!(0,o.n)(e,t)&&(this.launchDataProvider.updateLaunchAppProps({queryParams:e}),this.clearTechnicalQuery())},this.updateHash=async(e,t)=>{this.isAppModule&&!(0,o.n)(e,t)&&this.launchDataProvider.updateLaunchAppProps({location:e})}}}_=(0,s.Cg)([r.z8.container({abstract:!0}),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===p.J?Object:p.J,void 0===h.z?Object:h.z,void 0===d.n?Object:d.n,void 0===c.e?Object:c.e,void 0===l.Y?Object:l.Y])],_)},996385:(e,t,i)=>{i.d(t,{a:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.container({abstract:!0})],a)},801979:(e,t,i)=>{i.d(t,{R:()=>s,q:()=>n});const s=["ref"],n={VKWebAppSendCustomEvent:{eventsCount:16,timeFrameMs:2e3}}},254531:(e,t,i)=>{i.d(t,{W:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.global({abstract:!0})],a)},546793:(e,t,i)=>{i.d(t,{J:()=>o});var s=i(331635),n=i(327813),a=i(42107);class o{lock(e){this.lockedModalsTypes.add(e)}unlock(e){this.lockedModalsTypes.delete(e)}isLocked(e){return this.lockedModalsTypes.has(e)}constructor(){this.lockedModalsTypes=new Set,(0,n.l_)(this)}}o=(0,s.Cg)([a.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[])],o)},41221:(e,t,i)=>{i.d(t,{u:()=>a});var s=i(331635),n=i(42107);class a{setNavigateAction(e){this.navigateAction=e}get navigate(){if(!this.navigateAction)throw new Error("MiniAppNavigate service is not initialized");return this.navigateAction}constructor(){this.navigateAction=null}}a=(0,s.Cg)([n.z8.container()],a)},326486:(e,t,i)=>{i.d(t,{Y:()=>o});var s=i(331635),n=i(830443),a=i(42107);class o extends n.O{[a.zr](){this.dispose()}}o=(0,s.Cg)([a.z8.container()],o)},148782:(e,t,i)=>{i.d(t,{R:()=>u});var s=i(331635),n=i(327813),a=i(42107),o=i(725308),r=i(849645),p=i(645189),c=i(454080),d=i(221473),l=i(357543),h=i(456603);class u{get launchProps(){return this.launchDataProvider.launchProps}get query(){return this.launchProps?.queryParams}get groupId(){const e=this.launchProps?.actorId;if(e&&o.z.isGroupId(e))return Math.abs(e)}get internalRef(){return this.launchProps?.internalRef}get sessionUuid(){return this.launchDataProvider.sessionUuid}get isLayer(){return this.launchProps?.isLayer}get commonStatsData(){const{section_type:e,ad_id:t,ref:i,app_ref:s,cid:n,sid:a,profile_id:o}=this.query||{};return{ref:i||s||(this.internalRef?void 0:"apps_direct_link"),section_type:e,ad_id:(0,l.K)(t),collection_id:(0,l.K)(n),genre_id:(0,l.K)(a),profile_id:(0,l.K)(o),session_uuid:this.sessionUuid}}get openGameCardEventData(){return(0,l.BN)({...this.commonStatsData,from_layer:this.isLayer})}get launchEventData(){const{section_id:e,ref_notification_id:t}=this.query||{},i=this.internalRef?void 0:this.metaData.get().referrer||void 0;return(0,l.BN)({...this.commonStatsData,section_id:(0,l.K)(e),group_id:this.groupId,track_code:this.trackCode,notification_id:(0,l.K)(t),internal_ref:this.internalRef,document_referrer:i})}get ref(){return this.commonStatsData.ref}setTechnicalQuery(e){this._technicalQuery=(0,c.A)(e,h.ut)}get statsConfig(){return{data:{trackCode:this.launchEventData.track_code}}}get trackCode(){let e=this._technicalQuery.tc;return!e&&this.userEnv.partConfigEnabled("frontend.games_use_fallback_trackcode_stats")&&this.launchDataProvider.appDataUnsafe?.trackCode&&(e=this.launchDataProvider.appDataUnsafe?.trackCode),e}constructor(e,t,i){this.launchDataProvider=e,this.metaData=t,this.userEnv=i,this._technicalQuery={},(0,n.l_)(this)}}u=(0,s.Cg)([a.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===d.n?Object:d.n,void 0===r.e?Object:r.e,void 0===p.J?Object:p.J])],u)},780836:(e,t,i)=>{i.d(t,{S:()=>o});var s=i(331635),n=i(327813),a=i(42107);class o{clear(){this.shownTooltips.clear()}constructor(){this.shownTooltips=new Set,this.showTooltip=(e,t)=>{this.shownTooltips.add(e),t&&setTimeout((()=>this.hideTooltip(e)),t)},this.hideTooltip=e=>{this.isTooltipShown(e)&&this.shownTooltips.delete(e)},this.isTooltipShown=e=>this.shownTooltips.has(e),(0,n.l_)(this)}}o=(0,s.Cg)([a.z8.global(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[])],o)},386760:(e,t,i)=>{i.d(t,{H:()=>n,h:()=>s});const s="personal_discount",n=5e3},259618:(e,t,i)=>{i.d(t,{Q:()=>h});var s=i(331635),n=i(42107),a=i(78402),o=i(289375),r=i(97929),p=i(273193),c=i(35620),d=i(221020),l=i(491524);class h{show(e){this.params=e;let t=!1;this.logEvent(c.lG.SENT);const i=Date.now();this.snackbar.show({text:this.params.isGame?this.langs.getLang("apps_game_notification_auto_enabled"):this.langs.getLang("apps_notification_auto_enabled"),duration:e.duration,before:{content:(0,d.Y)(l.H,{})},action:{label:this.langs.getLang("apps_notification_auto_enabled_settings"),onClick:async(i,s)=>{t=!0,this.snackbar.hide(s),await this.openSettings(e.appId),this.logEvent(c.lG.SETTINGS_OPEN)}},onClose:()=>this.handleNotificationsAutoEnabledSnackbarClose(t,i)})}handleNotificationsAutoEnabledSnackbarClose(e,t){const i=Date.now();this.params&&(this.params.onClose(),e||this.logEvent(this.getCloseEvent(i-t,this.params.duration)))}logEvent(e){this.params&&this.productionStats.send({type:"type_click",type_click:{type:"type_mini_app_item",type_mini_app_item:{type:e},item:{type:this.params.isGame?a.SP.GAME:a.SP.MINI_APP,id:this.params.appId}},screen:void 0})}getCloseEvent(e,t){return e>=t?c.lG.TIMEOUT:this.closeEvent}constructor(e,t,i){this.productionStats=e,this.snackbar=t,this.langs=i}}h=(0,s.Cg)([n.z8.container({abstract:!0}),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.X?Object:o.X,void 0===r.q?Object:r.q,void 0===p.Y?Object:p.Y])],h)},272457:(e,t,i)=>{i.d(t,{W:()=>r});var s=i(331635),n=i(327813),a=i(42107),o=i(289375);class r{logMiniAppsPersonalDiscountEvent(e){this.productionStats.send({type:"type_action",type_action:{type:"type_mini_apps_personal_discount",type_mini_apps_personal_discount:e},screen:void 0})}constructor(e){this.productionStats=e,(0,n.l_)(this)}}r=(0,s.Cg)([a.z8.container(),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===o.X?Object:o.X])],r)},16306:(e,t,i)=>{i.d(t,{N:()=>n,b:()=>a});var s=i(78402);const n="recommendation",a=[s.rB.RecommendationNotification,s.rB.Recommend,s.rB.NotificationsAutoPermission]},78402:(e,t,i)=>{i.d(t,{DX:()=>n,SP:()=>a,rB:()=>s});var s=function(e){return e.Recommend="recommend",e.AddToCommunity="add_to_community",e.RecommendationNotification="recommendation_notification",e.NotificationsAutoPermission="notifications_auto_permission",e.PersonalDiscount="personal_discount",e.None="none",e}({}),n=function(e){return e.Close="on_close",e.Start="on_start",e}({}),a=function(e){return e.GAME="game",e.MINI_APP="mini_app",e}({})},762998:(e,t,i)=>{i.d(t,{V:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.global({abstract:!0})],a)},867496:(e,t,i)=>{i.d(t,{M:()=>A});var s=i(815287),n=i(42107),a=i(774048),o=i(262424),r=i(762998),p=i(254531),c=i(532800),d=i(259618),l=i(18528),h=i(791625),u=i(474461),g=i(996385),_=i(969645),m=i(57894);let S=!1;const A=({MiniAppsLegacyServiceImpl:e,VotesServiceImpl:t,CurrentAppProviderImpl:i,MonolithHandlerProviderImpl:A,NotificationsAutoPermissionSnackbarImpl:v,MiniAppHandlerReactionProviderImpl:f,MiniAppLocationServiceImpl:y,MiniAppCustomMessageServiceImpl:b,MiniAppInviteFriendsServiceImpl:C,MiniAppRequestBoxServiceImpl:w,MiniAppCallServiceImpl:I})=>{const E=(0,n.NF)(),T=(0,s.useRef)(!1);if(S||(n.oV.replace(a.Q,i),n.oV.replace(o.y,A),n.oV.replace(r.V,t),n.oV.replace(p.W,e),S=!0),!T.current){E.resolve(m.a).setContainer(E),E.replace(c.v,f),E.replace(d.Q,v),E.replace(l.b,y),E.replace(h.E,b),E.replace(u.m,C),E.replace(g.a,w),E.replace(_.I,I),T.current=!0}}},774048:(e,t,i)=>{i.d(t,{Q:()=>a});var s=i(331635),n=i(42107);class a{setContext(e){this.appContext=e}getContext(){return this.appContext}updateContextApp({iframe:e,RPC:t,accessToken:i}){this.appContext&&(e&&(this.appContext.iframe=e),t&&(this.appContext.RPC=t),i&&(this.appContext.accessToken=i))}constructor(){this.appContext=null}}a=(0,s.Cg)([n.z8.global({abstract:!0})],a)},262424:(e,t,i)=>{i.d(t,{y:()=>a});var s=i(331635),n=i(42107);class a{}a=(0,s.Cg)([n.z8.global({abstract:!0})],a)},877912:(e,t,i)=>{i.d(t,{D:()=>c});var s=i(331635),n=i(42107),a=i(754694),o=i(865419),r=i(16205),p=i(578401);class c{addLaunchRecord({id:e,lifecycle:t,sendEventToMiniApp:i,sendMessageToMiniApp:s,close:n}){this.launchRecordService.add({lifecycle:t.getHookSubscriptions(),close:this.closeAction||n||a.l,id:e,sendEventToMiniApp:i,sendMessageToMiniApp:s,onCustomMessage:e=>{t.hooks.onBridgeMethod.add((({params:t})=>{const{handler:i,params:s}=t;"VKWebAppCustomMessage"===i.toString()&&e(s)}))}})}initializeLifecycle(e){const t=new o.t({transform:p.W}),i=t.wrap(e);return{sanitizedLifecycle:t,unwrap:i}}setupDestroyHook(e,t,i,s){t.hooks.onDestroy.addAfterAll((()=>{i(),s?.(),t.clear(),this.launchRecordService.remove(e)}))}setCloseAction(e=a.l){this.closeAction=e;const t=this.launchId?this.launchRecordService.get(this.launchId):null;this.launchRecordService.isFullLaunchRecord(t)&&(t.close=e)}constructor(e){this.launchRecordService=e}}c=(0,s.Cg)([n.z8.container({abstract:!0}),(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[void 0===r.E?Object:r.E])],c)},882567:(e,t,i)=>{i.d(t,{od:()=>s});const s={VKWebAppInit:"VKWebAppInit",VKWebAppValidatePhone:"VKWebAppValidatePhone",VKWebAppCreateHash:"VKWebAppCreateHash",VKWebAppGetCommunityAuthToken:"VKWebAppGetCommunityAuthToken",VKWebAppGetCommunityToken:"VKWebAppGetCommunityToken",VKWebAppGetFriends:"VKWebAppGetFriends",VKWebAppAddToCommunity:"VKWebAppAddToCommunity",VKWebAppAddToHomeScreenInfo:"VKWebAppAddToHomeScreenInfo",VKWebAppCopyText:"VKWebAppCopyText",VKWebAppAddToFavorites:"VKWebAppAddToFavorites",VKWebAppAddToMenu:"VKWebAppAddToMenu",VKWebAppAddToProfile:"VKWebAppAddToProfile",VKWebAppGetUserInfo:"VKWebAppGetUserInfo",VKWebAppSetLocation:"VKWebAppSetLocation",VKWebAppGetClientVersion:"VKWebAppGetClientVersion",VKWebAppGetPhoneNumber:"VKWebAppGetPhoneNumber",VKWebAppGetEmail:"VKWebAppGetEmail",VKWebAppGetGeodata:"VKWebAppGetGeodata",VKWebAppOpenQR:"VKWebAppOpenQR",VKWebAppSetViewSettings:"VKWebAppSetViewSettings",VKWebAppSetTitle:"VKWebAppSetTitle",VKWebAppGetAuthToken:"VKWebAppGetAuthToken",VKWebAppCallAPIMethod:"VKWebAppCallAPIMethod",VKWebAppCallAPIMethodV2:"VKWebAppCallAPIMethodV2",VKWebAppJoinGroup:"VKWebAppJoinGroup",VKWebAppLeaveGroup:"VKWebAppLeaveGroup",VKWebAppAllowMessagesFromGroup:"VKWebAppAllowMessagesFromGroup",VKWebAppDenyNotifications:"VKWebAppDenyNotifications",VKWebAppAllowNotifications:"VKWebAppAllowNotifications",VKWebAppOpenPayForm:"VKWebAppOpenPayForm",VKWebAppOpenApp:"VKWebAppOpenApp",VKWebAppShare:"VKWebAppShare",VKWebAppShowNewPostBox:"VKWebAppShowNewPostBox",VKWebAppShowWallPostBox:"VKWebAppShowWallPostBox",VKWebAppSendToClient:"VKWebAppSendToClient",VKWebAppScroll:"VKWebAppScroll",VKWebAppStorageGet:"VKWebAppStorageGet",VKWebAppStorageGetKeys:"VKWebAppStorageGetKeys",VKWebAppStorageSet:"VKWebAppStorageSet",VKWebAppResizeWindow:"VKWebAppResizeWindow",VKWebAppSendPayload:"VKWebAppSendPayload",VKWebAppUpdateConfig:"VKWebAppUpdateConfig",VKWebAppTapticImpactOccurred:"VKWebAppTapticImpactOccurred",VKWebAppTapticNotificationOccurred:"VKWebAppTapticNotificationOccurred",VKWebAppTapticSelectionChanged:"VKWebAppTapticSelectionChanged",VKWebAppShowImages:"VKWebAppShowImages",VKWebAppShowOrderBox:"VKWebAppShowOrderBox",VKWebAppShowGoodOrderBox:"VKWebAppShowGoodOrderBox",VKWebAppShowNftGoodBox:"VKWebAppShowNftGoodBox",VKWebAppShowNftOtpBox:"VKWebAppShowNftOtpBox",VKWebAppShowLeaderBoardBox:"VKWebAppShowLeaderBoardBox",VKWebAppShowLinkCardBox:"VKWebAppShowLinkCardBox",VKWebAppShowNftPaymentBox:"VKWebAppShowNftPaymentBox",VKWebAppShowInviteBox:"VKWebAppShowInviteBox",VKWebAppShowRequestBox:"VKWebAppShowRequestBox",VKWebAppShowCommunityWidgetPreviewBox:"VKWebAppShowCommunityWidgetPreviewBox",VKWebAppOpenInNativeApp:"VKWebAppOpenInNativeApp",VKWebAppLocationChanged:"VKWebAppLocationChanged",VKWebAppClose:"VKWebAppClose",VKWebAppShowStoryBox:"VKWebAppShowStoryBox",VKWebAppGetPersonalCard:"VKWebAppGetPersonalCard",VKWebAppOpenContacts:"VKWebAppOpenContacts",VKWebAppOpenCodeReader:"VKWebAppOpenCodeReader",VKWebAppShowNativeAds:"VKWebAppShowNativeAds",VKWebAppShowSubscriptionBox:"VKWebAppShowSubscriptionBox",VKWebAppGetGroupInfo:"VKWebAppGetGroupInfo",VKWebAppFlashGetInfo:"VKWebAppFlashGetInfo",VKWebAppOpenWallPost:"VKWebAppOpenWallPost",VKWebAppGetSilentToken:"VKWebAppGetSilentToken",VKWebAppOpenReportForm:"VKWebAppOpenReportForm",VKWebAppTrackEvent:"VKWebAppTrackEvent",VKWebAppCheckAllowedScopes:"VKWebAppCheckAllowedScopes",VKWebAppCheckNativeAds:"VKWebAppCheckNativeAds",VKWebAppGetLaunchParams:"VKWebAppGetLaunchParams",VKWebAppActionDone:"VKWebAppActionDone",VKWebAppRetargetingPixel:"VKWebAppRetargetingPixel",VKWebAppSendCustomEvent:"VKWebAppSendCustomEvent",VKWebAppCustomMessage:"VKWebAppCustomMessage",VKWebAppConversionHit:"VKWebAppConversionHit",VKWebAppGetConfig:"VKWebAppGetConfig",VKWebAppRecommend:"VKWebAppRecommend",VKWebAppRemoveFromProfile:"VKWebAppRemoveFromProfile",VKWebAppScrollTopStart:"VKWebAppScrollTopStart",VKWebAppScrollTopStop:"VKWebAppScrollTopStop",VKWebAppScrollTop:"VKWebAppScrollTop",VKWebAppChangeFragment:"VKWebAppChangeFragment",VKWebAppShowSlidesSheet:"VKWebAppShowSlidesSheet",VKWebAppAddToChat:"VKWebAppAddToChat",VKWebAppShowBannerAd:"VKWebAppShowBannerAd",VKWebAppBannerAdClosedByUser:"VKWebAppBannerAdClosedByUser",VKWebAppBannerAdUpdated:"VKWebAppBannerAdUpdated",VKWebAppCheckBannerAd:"VKWebAppCheckBannerAd",VKWebAppHideBannerAd:"VKWebAppHideBannerAd",VKWebAppCallStart:"VKWebAppCallStart",VKWebAppCallJoin:"VKWebAppCallJoin",VKWebAppCallLeft:"VKWebAppCallLeft",VKWebAppCallFinished:"VKWebAppCallFinished",VKWebAppCallGetStatus:"VKWebAppCallGetStatus",VKWebAppTranslate:"VKWebAppTranslate",VKWebAppMobWebAdLoaded:"VKWebAppMobWebAdLoaded",VKWebAppAlert:"VKWebAppAlert",VKWebAppKeyboardLock:"VKWebAppKeyboardLock",VKWebAppGetAds:"VKWebAppGetAds"}},323525:(e,t,i)=>{i.d(t,{G:()=>Je});var s=i(221020),n=i(815287),a=i(356035),o=i(318077),r=i(405252),p=i(187233),c=i(42107),d=i(331635),l=i(327813),h=i(642828),u=i(916533),g=i(876141),_=i(273193),m=i(748799),S=i(993311),A=i(645189),v=i(642052),f=i(160010);class y{destroy(){this.resizeReactionDisposer()}get appState(){return this.getAppState()}isStretchedByHeight(e){return!!e&&(this.userEnv.getConfigValue("apps_with_stretched_iframe_height")??[]).includes(e)}get size(){const e=this.appState?.appData?.isWidescreen&&!this.props.current.isLayer&&!this.isStretchedByHeight(this.appState?.appData?.id),t=this.props.current.allowResize;if(t||e)return{width:this._width??(t?this.appState?.appData?.iframeSettings?.width:void 0),height:this._height??(t||e?this.appState?.appData?.iframeSettings?.height:void 0)}}get skeletonHeight(){return this.size?.height??this.props.current.defaultHeight}setWidth(e){"string"!=typeof e&&(this._width=e)}setHeight(e){"string"!=typeof e&&(this._height=e)}constructor(e,t,i){this.userEnv=e,this.props=t,this.getAppState=i,this._width=void 0,this._height=void 0,this.onResize=(e,t)=>{this.props.current.allowResize&&(this.setWidth(e),this.setHeight(t))},this.resizeReactionDisposer=(0,l.mJ)((()=>this.size),(e=>{this.props.current.onResized?.(e?.width,e?.height)})),(0,l.l_)(this)}}var b=i(101922),C=i(54952),w=i(221473),I=i(456603);class E{clearLaunchErrorTimeout(){const e=this.launchDataProvider.getLaunchAbortTimeout();e?.()}get appData(){return this.appsService.getAppState(this.props.current.appId)?.appData}set currentScreenType(e){this._screenType=e,this.props.current?.onPlatformScreenChange?.(this._screenType)}get currentScreenType(){return this._screenType}get isSplashScreenVisible(){return this._isSplashScreenVisible}get installScreenData(){return this._installScreenData}set installScreenData(e){this._installScreenData=e}get unavailableScreenData(){return this._unavailableScreenData}set unavailableScreenData(e){this._unavailableScreenData=e}get splashScreenData(){if(this.appData?.splashScreen&&this.appData?.isSplashScreenEnabled)return{...this.appData?.splashScreen,onVisibilityChange:e=>{(0,l.h5)((()=>{this._isSplashScreenVisible=e,e||this.props.current?.onSplashScreenHide?.()}))}}}get screenComponents(){return this.props.current.platformScreens}constructor(e,t,i,s){this.appsService=e,this.langs=t,this.launchDataProvider=i,this.props=s,this._screenType=I.ZJ.NONE,this._isSplashScreenVisible=!!this.splashScreenData,this._installScreenData={shown:!1},this._unavailableScreenData=void 0,this.showDefaultScreen=()=>{this.currentScreenType=I.ZJ.NONE,this.installScreenData={shown:!1}},this.showUnavailableScreen=()=>{this.currentScreenType=I.ZJ.UNAVAILABLE,this.clearLaunchErrorTimeout()},this.showDefaultErrorScreen=()=>{this.unavailableScreenData={title:this.langs.getLang("vkui_placeholder_app_load_error"),subtitle:this.langs.getLang("apps_unauthorized_service_error_title"),reason:I.x5.UNKNOWN_ERROR,actionButton:{title:this.langs.getLang("apps_iframe_error_screen_action"),url:""}},this.showUnavailableScreen()},this.showNotFoundScreen=()=>{this.currentScreenType=I.ZJ.NOT_FOUND,this.clearLaunchErrorTimeout()},this.showInstallScreen=()=>{this.currentScreenType=I.ZJ.INSTALL,this.clearLaunchErrorTimeout()},this.setInitialScreenInfo=({appResponse:e,appData:t})=>{if(e){if(e.placeholder_info){const{action_button:t,suggested_apps_ids:i,...s}=e.placeholder_info;return this.unavailableScreenData={...s,actionButton:t,suggestedAppsIds:i},void this.showUnavailableScreen()}const t=(0,b.st)(e);this.installScreenData=t,t.shown&&this.showInstallScreen()}else t?.placeholderInfo&&(this.unavailableScreenData=t.placeholderInfo,this.showUnavailableScreen())},this.showIframeError=()=>{this.unavailableScreenData={actionButton:{url:this.appData?.isAnyGame?"/games":"/services",title:this.langs.getLang("apps_placeholder_info_action_button_title_go_to_apps_catalog")},title:this.langs.getLang("apps_placeholder_info_title_application_is_not_available"),subtitle:this.langs.getLang("apps_placeholder_info_subtitle_load_error"),reason:1}},this.showPlaceholder=e=>{this.unavailableScreenData={title:"",subtitle:e,reason:0}},(0,l.l_)(this)}}E=(0,d.Cg)([c.z8.transient(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===C.m?Object:C.m,void 0===_.Y?Object:_.Y,void 0===w.n?Object:w.n,void 0===c.Ji?Object:c.Ji])],E);const T="externalInit",O="externalSessionStart";var M=function(e){return e.FRIENDS="friends",e.PHOTOS="photos",e.VIDEO="video",e.STORIES="stories",e.PAGES="pages",e.STATUS="status",e.NOTES="notes",e.WALL="wall",e.DOCS="docs",e.GROUPS="groups",e.STATS="stats",e.MARKET="market",e.NOTIFY="notify",e.AUDIO="audio",e.MENU="menu",e.WALLMENU="wallmenu",e.MESSAGES="messages",e.ADS="ads",e.OFFLINE="offline",e.NOTIFICATIONS="notifications",e.EMAIL="email",e.ADSWEB="adsweb",e.GROUP_MESSAGES="group_messages",e.PHONE="phone",e.APP_WIDGET="app_widget",e.MANAGE="manage",e}({});const D=new Set(Object.values(M));class P{get rpc(){return this._RPC}get iframeName(){return this._RPC?.frameName||this.miniAppsLegacyService.generateIframeName()}constructor(e,t){this.currentAppService=e,this.miniAppsLegacyService=t,this._RPC=void 0,this.setIframeRef=e=>{this.currentAppService.updateCurrentAppContext({iframe:e}),this._RPC&&this._RPC.setFrame(e)},this.setRPC=e=>{this.currentAppService.updateCurrentAppContext({RPC:e}),this._RPC=e},this.onExternalInit=e=>{this.miniAppsLegacyService.addExternalEventListener(T,e)},this.onExternalSessionStart=e=>{this.miniAppsLegacyService.addExternalEventListener(O,e)},this.setAppAccessToken=e=>{this.currentAppService.updateCurrentAppContext({appAccessToken:e})},(0,l.l_)(this)}}var k=i(357543),L=i(171351),N=i(801979),W=i(532800);var B=i(546793),R=i(262424);class x{getHandlers(e,t){const i=this.appsService.getAppState(t.appId);if(!i?.appData)throw new Error("Failed to get app data");e?.setLegacyProvider?.(this.legacyHandlersProvider);const{availableMethods:s,sdkMethods:n}=i.appData.handlers,a=new Set(n);return s.reduce(((i,s)=>{const n=a.has(s);return i[s]={supported:!0,floodRate:this.userEnv.partConfigEnabled("frontend.mini_apps_vk_bridge_flood_control")?N.q[s]:void 0,handle:(i,a)=>{const o=n?a?.(i):e.runHandler({...i,handlerName:s},this.prepareHandlersContext(t));return this.runReactions(t.appId,s,o),o}},i}),{})}prepareHandlersContext({appId:e,containerId:t,sendEventToMiniApp:i,sendMessageToMiniApp:s,showModal:n}){const a=this.appsService.getAppState(e);if(!a?.appData)throw new Error("Failed to get app data");return{app:a.appData,containerId:t,sendMessageToMiniApp:s,sendEventToMiniApp:i,showModal:n,modalManager:this.modalsLockService}}constructor(e,t,i,s,n){this.modalsLockService=e,this.appsService=t,this.legacyHandlersProvider=i,this.reactionProvider=s,this.userEnv=n,this.runReactions=async(e,t,i)=>{if(i){const s=await i;if((e=>{const{data:t}=e;return!!t.error_data||!!t.error_msg})(s))return;const n=this.reactionProvider.getReactions(t);n?.forEach((t=>{t({appId:e,...s})}))}},(0,l.l_)(this)}}x=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===B.J?Object:B.J,void 0===C.m?Object:C.m,void 0===R.y?Object:R.y,void 0===W.v?Object:W.v,void 0===A.J?Object:A.J])],x);var V=i(25313),H=i(693491),G=i(526048);class K{constructor(e){this.langs=e,this.langsMap={},this.getLang=(e,t)=>this.langsMap[e]??this.langs.getLang(e,t),this.langsMap={apps_ad_subtitle_prefix:this.langs.getLang("apps_ad_subtitle_prefix"),apps_ad_go_to_site:this.langs.getLang("apps_ad_go_to_site"),apps_ad_options:this.langs.getLang("apps_ad_options"),apps_ad_interstitial_close:this.langs.getLang("apps_ad_interstitial_close")}}}K=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===_.Y?Object:_.Y])],K);var F=i(925319),j=i(849645),U=i(950211),Y=i(227661),z=i(402815);class J{sendStatEvent(e,t,i,s){switch(t){case z.Uz.BenchmarkMainStats:this.analytics.sendBenchmarkMainStats(i);break;case z.Uz.CustomStats:this.analytics.sendCustomStats(i);break;case z.Uz.NetworkStats:this.analytics.sendNetworkStats(i);break;case z.Uz.ProductionStats:this.analytics.sendProductionStats(i,s);break;case z.Uz.StatlogEvents:this.analytics.sendStatlogEvents(i);break;case z.Uz.StoryViewStats:this.analytics.sendStoryViewStats(i);break;case z.Uz.WebPerfStats:this.analytics.sendWebPerfStats(i)}}forceSendStateEvent(e){const{statsMeta:t,wsTransport:i}=this.metaData.get(),{st:s,platform:n,time:a,hash:o}=t??{},r=this.authService.userId,p=new URLSearchParams,c=JSON.stringify({id:r,st:s,platform:n,signTime:a,sign:o,attempt:1,...e}),d=(e,t,s)=>{s&&t.set("device_id",s);const n=t.toString(),a=`${i}/web-stats/p${n&&`?${n}`}`;try{"sendBeacon"in navigator&&navigator.sendBeacon(a,e)}catch{throw new Error("MiniAppsSDK: failed send stat event")}},l=async(e,t)=>{try{const i=await this.fingerprint.resolveDeviceId();d(e,t,i||"")}catch(e){throw new Error(String(e))}};if(this.userEnv.partConfigEnabled("frontend.apps_spa_grip_fingerprint_forced_state_event"))l(c,p);else{const e=this.cookies.get("remixgp");d(c,p,e)}}constructor(e,t,i,s,n,a){this.analytics=e,this.metaData=t,this.cookies=i,this.authService=s,this.userEnv=n,this.fingerprint=a,(0,l.l_)(this)}}J=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===F.j?Object:F.j,void 0===j.e?Object:j.e,void 0===U.H?Object:U.H,void 0===u.u?Object:u.u,void 0===A.J?Object:A.J,void 0===Y.$?Object:Y.$])],J);var q=i(148782),X=i(254531),Q=i(289375),$=i(722934),Z=function(e){return e.INIT="games_js_sdk_init",e}({}),ee=function(e){return e.MINI_APPS_GAMES_JS_SDK_ITEM="type_games_js_sdk_item",e}({}),te=i(48265),ie=i(365815),se=i(754694);const ne="fXD",ae="%init%",oe="__fxdm_i",re="p",pe=":",ce="*",de={encode:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},decode:{"&#039;":"'","&quot;":'"',"&gt;":">","&lt;":"<","&amp;":"&"}};var le=i(651253);const he=(e,t)=>{if("string"==typeof e)return((e,t)=>{const i=t?de.encode:de.decode;return Object.entries(i).reduce(((e,[t,i])=>e.replaceAll(t,i)),e)})(e,t);if(Array.isArray(e))return e.map((e=>he(e,t)));if(e&&"object"==typeof e){const i={};for(const[s,n]of Object.entries(e))i[s]=he(n,t);return i}return e};class ue{initPostMessageServerService(){this.env.protocol=re,this.env.send=(e,t)=>{const i=e.frame?.contentWindow||e.caller;if(!i)throw new Error("PostMessageServer: Cannot send message - iframe not ready or destroyed");i.postMessage(e.key+pe+t,ce)},window.addEventListener("message",this.messageHandler,!1)}destroy(){window.removeEventListener("message",this.messageHandler,!1),this.handlers={}}executeHandler(e,t,i){const s=this.handlers[e];if(!s)return;const[n,a]=s;if(!1!==a.filter?.(i))try{n(t,a)}catch(i){const s={breadcrumb:{message:"postMessage handler call error",data:{inputKey:e,inputValue:t}},environment:"postMessage"};throw this.errorLogger.log(new Error("Fail to execute handler"),{metaData:s}),i}else console.warn?.(`PostMessage blocked from origin: ${i}`)}createPostMessageServer(e={},t,i={}){let s="";for(let e=0;e<5;e++)s+=Math.ceil(15*Math.random()).toString(16);const n={methods:e,filter:t,options:i,id:this.idCounter++,key:s,frameName:ne+s,frameId:ne+s,server:!0,funcsCount:0,caller:null,frame:null,start:e=>{e.contentWindow&&(n.caller=e.contentWindow,n.frame=e);const t=()=>{e.removeEventListener("load",t);const i={type:"VKWebAppSettings",frameId:n.frameId};e.contentWindow?.postMessage(i,"*")};e.addEventListener("load",t)},destroy:()=>{delete this.handlers[n.key]},setFrame:e=>{n.start(e)},callMethod:(...e)=>{const t=e.shift(),i=e.map((e=>((e,t)=>"function"==typeof e?(t.funcsCount=(t.funcsCount||0)+1,t.methods["_func"+t.funcsCount]=function(){e.apply(t,arguments),delete t.methods["_func"+t.funcsCount]},{_func:t.funcsCount}):t.options.safe?he(e,!1):e)(e,n)));this.env.send?.(n,JSON.stringify([t,i]))}};return this.handlers[n.key]=[this.applyMethod,n],n}constructor(e){this.errorLogger=e,this.handlers={},this.env={},this.idCounter=0,this.onMessage=e=>{const{data:t}=e;if("string"!=typeof t)return;const i=t.indexOf(":"),s=t.slice(0,i),n=t.slice(i+1);this.executeHandler(s,n,e.origin)},this.applyMethod=(e,t)=>{const[i,s=[]]=JSON.parse(e);if(!i)return;const n=s.map((e=>((e,t)=>{if(e&&"object"==typeof e&&"_func"in e){const i=e._func;return(...e)=>{if(t.caller){const s=JSON.stringify(["_func"+i,e]);t.caller.postMessage(t.key+":"+s,"*")}}}return t.options.safe?he(e,!0):e})(e,t))),a=t.methods[i];a?a.apply(t,n):console.warn(`PostMessageServer: Method '${i}' is undefined`)},this.messageHandler=this.onMessage,this.initPostMessageServerService()}}ue=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===le.v?Object:le.v])],ue);const ge=(e=[])=>[...e].filter((e=>D.has(e)));var _e=i(774048),me=i(882567),Se=i(326486);class Ae{onInit({appId:e,getHash:t}){this.sendEvent({eventName:Z.INIT,appId:e}),this.appsService.updateAppData(e,{isJsSdk:!0}),this.miniAppsLegacyService.emitExternalEvent(T),this.userEnv.partConfigEnabled("frontend.perfomance_stats_in_games")||this.miniAppsLegacyService.emitExternalEvent(O),this.onLocationChanged(t())}getAppInfo(e,t){e([t.appId,t.getHash()])}async api({method:e,args:t}){this.currentApp?.api?.(e,t,(()=>{}))}async apiCall({method:e,args:t,callback:i}){this.currentApp?.api?.(e,t,i)}showRequestBox(e,t,i){this.currentApp?.funcs.showRequestBox?.(e,t,i)}selectChatsBox(e){const t=this.authService.userId;t&&this.currentApp?.funcs.selectChatsBox?.(e,t)}shareBox(e){this.currentApp?.funcs.shareBox?.(e)}startHandleWheelEvent(e){e&&this.currentApp?.startHandleWheelEvent?.()}stopHandleWheelEvent(e){e&&this.currentApp?.stopHandleWheelEvent?.()}scrollWindow(e,t){this.currentApp?.funcs.scrollWindow?.(e,t)}showOrderBox(e){const t=this.currentApp?.getSDKBridgeHandler?.(me.od.VKWebAppShowOrderBox);t?.handle?.(e)}showSubscriptionBox(e,t){const i=this.currentApp?.getSDKBridgeHandler?.(me.od.VKWebAppShowSubscriptionBox);i?.handle?.({action:e,...t})}scrollTop(){this.currentApp?.funcs.scrollTop?.()}async addToMenu(){await(this.currentApp?.getSDKBridgeHandler?.(te.IT.AddToMenu)?.handle({}))}setTitle(e){this.currentApp?.getSDKBridgeHandler?.(te.IT.SetTitle)?.handle({title:e})}async showAllowMessagesFromCommunityBox(e){try{const t=this.currentApp?.getSDKBridgeHandler?.(te.IT.AllowMessagesFromGroup);if(!t||!this.currentApp)throw new Error("Handler or currentApp is not defined");const i=await t.handle({group_id:e??this.currentApp.options.gid});if(!i||i.type===t.errorDescriptor)throw new Error(t.errorDescriptor);this.currentApp.runCallback?.("onAllowMessagesFromCommunity")}catch{this.currentApp?.runCallback?.("onAllowMessagesFromCommunityCancel")}}async openExternalApp(e,t){const i=this.currentApp?.getSDKBridgeHandler?.(te.IT.OpenPayForm),{data:s}=await(i?.handle?.({action:t.action,params:t})),n="error_code"in s?s.error_code===ie.OQ.USER_DENIED?"onExternalAppClose":"onExternalAppFail":"onExternalAppDone";this.currentApp?.runCallback?.(n,s)}resizeWindow(e,t){this.currentApp?.getSDKBridgeHandler?.(te.IT.ResizeWindow)?.handle({width:e,height:t})}scrollSubscribe(e){this.currentApp?.funcs.scrollSubscribe?.(e)}setLocation(e,t){this.currentApp?.funcs.setLocation?.(this.currentApp,e,t)}showInstallBox(){}async showAppWidgetPreviewBox(e,t){const i=this.currentApp?.getSDKBridgeHandler?.(me.od.VKWebAppShowCommunityWidgetPreviewBox),s=await(i?.handle?.({group_id:this.currentApp?.options?.gid,type:e,code:t}));if(s&&i)if(s.type===i.successDescriptor)this.currentApp?.runCallback?.("onAppWidgetPreviewSuccess");else{const{data:e}=s;e.error_data?.error_code===ie.OQ.USER_DENIED?this.currentApp?.runCallback?.("onAppWidgetPreviewCancel"):this.currentApp?.runCallback?.("onAppWidgetPreviewFail",e.error_data?.error_reason)}else this.currentApp?.runCallback?.("onAppWidgetPreviewFail",ie.XY.unknown())}adsPublish(){(0,se.l)()}async showSettingsBox({appTitle:e,appId:t,isEditScope:i,mask:s}){try{const{scopes:n}=await this.appsApi.convertScopes({mask:s});if(!n)return void this.currentApp?.runCallback?.("onSettingsCancel");const a=ge(n),o=this.appsModals.show({type:"GetAuthTokenModal",data:{appTitle:e,isEditScope:i,withWarning:!0,scope:a.join(",")},actions:{onEditScopes:()=>{o({isEditScope:!0})},onDeny:()=>{o({shouldClosed:!0}),this.currentApp?.runCallback?.("onSettingsCancel")},onAccept:async(e="")=>{o({loading:!0,isEditScope:!1});const i=new Set(this.currentApp?.params.whitelist_scopes?.split(",")||[]),s=new Set(e.split(",")),n=JSON.stringify(a.reduce(((e,t)=>(e[t]=s.has(t),e)),{}));await this.appsApi.saveAppSettings({app_id:t,scopes:n}),s.forEach((e=>{i.add(e)})),this.appsService.updateAppData(t,{whitelistScopes:[...i.values()].join(",")});const{mask:r}=await this.appsApi.convertScopes({scopes:e});this.currentApp?.runCallback?.("onSettingsChanged",r),o({shouldClosed:!0})}}})}catch(e){console.error("Error in showSettingsBox: ",e)}}async showGroupSettingsBox({appTitle:e,appId:t,isEditScope:i,mask:s,groupId:n,groupName:a}){try{if(!n)throw this.currentApp?.runCallback?.("onGroupSettingsCancel"),new Error("Group id not found");const{scopes:o}=await this.appsApi.convertScopes({mask:s,type:"group"});if(!o)return void this.currentApp?.runCallback?.("onGroupSettingsCancel");const r=ge(o),p=this.appsModals.show({type:"GetAuthTokenModal",data:{appTitle:e,isEditScope:i,groupId:n,groupName:a,withWarning:!0,scope:r.join(",")},actions:{onEditScopes:()=>{p({isEditScope:!0})},onDeny:()=>{p({shouldClosed:!0}),this.currentApp?.runCallback?.("onGroupSettingsCancel")},onAccept:async(e="")=>{try{p({loading:!0,isEditScope:!1});const{settings:i,token:s}=await this.appsApi.saveGroupSettings({app_id:t,group_id:n,scopes:e},{maxRetries:5}),a=new Set(this.currentApp?.params.group_whitelist_scopes?.split(",")||[]);new Set(e.split(",")).forEach((e=>{a.add(e)})),this.appsService.updateAppData(t,{groupWhitelistScopes:[...a.values()].join(",")}),this.currentApp?.runCallback?.("onGroupSettingsChanged",i,s)}catch(e){console.error(`Can't save group settings: ${JSON.stringify(e)}`),this.currentApp?.runCallback?.("onGroupSettingsCancel")}finally{p({shouldClosed:!0})}}}})}catch(e){console.error("Error in showGroupSettingsBox: ",e),this.currentApp?.runCallback?.("onGroupSettingsCancel")}}get currentApp(){return this.currentAppProvider.getCurrentApp()}isAllowedPostMessageOriginHost(e,t){return!!t&&new RegExp(t).test(e)}static sendAnalytics(e){return function(t,i,s){const n=t[i];s.value=function(...t){this.saveJsSDKStats(e||String(i)),n.apply(this,t)}}}static notSupported(){return function(e,t,i){i.value=function(){console.error(`Method ${t} is not supported`)}}}constructor(e,t,i,s,n,a,o,r,p,c,d){this.miniAppsLegacyService=e,this.userEnv=t,this.metaData=i,this.authService=s,this.productionStats=n,this.currentAppProvider=a,this.appsService=o,this.reactions=r,this.appsModals=p,this.appsApi=c,this.postMessageServerService=d,this.getLocationProtocol=e=>{this.currentApp?.funcs.getLocationProtocol?.(e)},this.showInviteBox=()=>{this.currentApp?.funcs.showInviteBox?.()},this.showPaymentBox=e=>{this.currentApp?.funcs.showPaymentBox?.(e)},this.showLeadsPaymentBox=e=>{this.currentApp?.funcs.showLeadsPaymentBox?.(e)},this.debug=e=>this.currentApp?.funcs.debug?.(e),this.showWallPostBox=e=>{this.currentApp?.funcs.showWallPostBox?.(e)},this.startHandleDeviceOrientation=(e=!1,t=!1)=>{this.currentApp?.funcs.startHandleDeviceOrientation?.(e,t)},this.openQRReader=()=>{this.currentApp?.funcs.openQRReader?.()},this.closeApp=()=>{this.currentApp?.funcs.closeApp?.()},this.createRPC=({appData:e,getHash:t})=>{const i={appTitle:e.title,appId:e.id,isEditScope:!1},s=()=>this.onInit({appId:e.id,getHash:t}),n={onInit:s,[ae]:s,[oe]:s,_getAppInfo:i=>this.getAppInfo(i,{appId:e.id,getHash:t}),api:(e,t,i)=>this.api({callId:e,method:t,args:i}),ApiCall:([e,t],i)=>this.apiCall({method:e,args:t,callback:i}),getLocationProtocol:this.getLocationProtocol,showInviteBox:this.showInviteBox,selectChatsBox:()=>this.selectChatsBox(e.id),showPaymentBox:this.showPaymentBox,showLeadsPaymentBox:this.showLeadsPaymentBox,debug:this.debug,showWallPostBox:this.showWallPostBox,shareBox:this.shareBox.bind(this),startHandleWheelEvent:()=>this.startHandleWheelEvent(e.isVkPayApp),stopHandleWheelEvent:()=>this.stopHandleWheelEvent(e.isVkPayApp),scrollWindow:(e,t)=>this.scrollWindow(e,t),startHandleDeviceOrientation:this.startHandleDeviceOrientation,showAppWidgetPreviewBox:this.showAppWidgetPreviewBox.bind(this),openQRReader:this.openQRReader,closeApp:this.closeApp,setTitle:this.setTitle.bind(this),resizeWindow:this.resizeWindow.bind(this),showRequestBox:this.showRequestBox.bind(this),scrollTop:this.scrollTop.bind(this),showAllowMessagesFromCommunityBox:this.showAllowMessagesFromCommunityBox.bind(this),showSubscriptionBox:this.showSubscriptionBox.bind(this),scrollSubscribe:e=>this.scrollSubscribe(e),addToMenu:this.addToMenu.bind(this),showInstallBox:this.showInstallBox.bind(this),showOrderBox:this.showOrderBox.bind(this),openExternalApp:this.openExternalApp.bind(this),setLocation:(e,t)=>this.setLocation(e,t),idle:se.l,unIdle:se.l,adsPublish:this.adsPublish.bind(this),showSettingsBox:e=>{this.showSettingsBox({...i,mask:e})},showGroupSettingsBox:t=>{this.showGroupSettingsBox({...i,mask:t,groupId:e.groupId||0,groupName:e.groupTitle||""})}},a=t=>this.filterPostMessage(e,t);return this.userEnv.partConfigEnabled("frontend.mini_apps_xdm_spa")?this.postMessageServerService.createPostMessageServer(n,a):this.miniAppsLegacyService.initXDMClient(n,a)},this.sendEvent=({eventName:e,appId:t})=>{this.productionStats.send({type:"type_action",type_action:{type:ee.MINI_APPS_GAMES_JS_SDK_ITEM,[ee.MINI_APPS_GAMES_JS_SDK_ITEM]:{app_id:t,event_name:e}},screen:this.metaData.get().screen})},this.filterPostMessage=(e,t)=>{const i=new URL(t).hostname,s=new URL(e.url).hostname;if(i!==s&&!this.isAllowedPostMessageOriginHost(i,e.allowedOriginRegexp))throw Error(`Insecure method call from ${i}. Call must be from ${s}`);return!0},this.saveJsSDKStats=e=>{if(this.userEnv.partConfigEnabled("frontend.js_sdk_funcs_stats")){const{statsMeta:t}=this.metaData.get(),i=[`spa-${t.platform}`],s=this.currentApp?.options.aid;s&&i.push(String(s)),this.miniAppsLegacyService.saveJsSDKStats(e,i)}},this.onLocationChanged=e=>{this.currentApp?.runCallback?.("onLocationChanged",e??"")},this.reactionOnChangeHash=e=>{this.reactions.reaction(e,(e=>{this.onLocationChanged(e)}))},(0,l.l_)(this)}}(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Object]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"onInit",null),(0,d.Cg)([Ae.sendAnalytics("_getAppInfo"),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof GetAppInfoCallback?Object:GetAppInfoCallback,Object]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"getAppInfo",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof ApiMethodProps?Object:ApiMethodProps]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"api",null),(0,d.Cg)([Ae.sendAnalytics("ApiCall"),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof ApiCallMethodProps?Object:ApiCallMethodProps]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"apiCall",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Number,String,String]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"showRequestBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Number]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"selectChatsBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[String]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"shareBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Boolean]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"startHandleWheelEvent",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Boolean]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"stopHandleWheelEvent",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Number,Number]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"scrollWindow",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof ShowOrderBoxInput?Object:ShowOrderBoxInput]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"showOrderBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof ShowSubscriptionAction?Object:ShowSubscriptionAction,"undefined"==typeof ShowSubscriptionData?Object:ShowSubscriptionData]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"showSubscriptionBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"scrollTop",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"addToMenu",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[String]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"setTitle",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Number]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"showAllowMessagesFromCommunityBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[String,Object]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"openExternalApp",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Number,Number]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"resizeWindow",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[Boolean]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"scrollSubscribe",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[String,Boolean]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"setLocation",null),(0,d.Cg)([Ae.notSupported(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"showInstallBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[String,String]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"showAppWidgetPreviewBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[]),(0,d.Sn)("design:returntype",void 0)],Ae.prototype,"adsPublish",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof SettingsBoxProps?Object:SettingsBoxProps]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"showSettingsBox",null),(0,d.Cg)([Ae.sendAnalytics(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",["undefined"==typeof GroupSettingsBoxProps?Object:GroupSettingsBoxProps]),(0,d.Sn)("design:returntype",Promise)],Ae.prototype,"showGroupSettingsBox",null),Ae=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===X.W?Object:X.W,void 0===A.J?Object:A.J,void 0===j.e?Object:j.e,void 0===u.u?Object:u.u,void 0===Q.X?Object:Q.X,void 0===_e.Q?Object:_e.Q,void 0===C.m?Object:C.m,void 0===Se.Y?Object:Se.Y,void 0===V.F?Object:V.F,void 0===$.V?Object:$.V,void 0===ue?Object:ue])],Ae);var ve=i(115526),fe=i(97929),ye=i(820282);class be extends ye.S{get namespace(){return"orders"}constructor(...e){super(...e),this.getPersonalDiscount=this.makeMethod("getPersonalDiscount")}}be=(0,d.Cg)([c.z8.global()],be);var Ce=i(819300),we=i(668355),Ie=i(78402),Ee=i(505174),Te=i(883979);var Oe=i(607555);var Me=i(780836),De=i(386760),Pe=i(272457),ke=i(16306),Le=i(762998);function Ne(e,t){if(!e)return;const{is_need_to_show_alert_about_notify_scope:i,need_show_personal_discount_alert:s}=e;return i?{type:Ie.rB.NotificationsAutoPermission,needToShowOnStart:!0,needToSetActionShown:!1}:t!==Ie.rB.PersonalDiscount||s?void 0:{type:Ie.rB.None}}var We=i(259618);const Be=2e4;class Re{async initUserActions({appId:e,sourceUrl:t,appName:i,isJsSdk:s}){if(this.isInited)return;const n=await this.initActionInfo(e,t);n.needToShowOnStart?this.initAction(e,n,i,s):n.needToShowOnCloseTime&&setTimeout((()=>this.initAction(e,n,i,s)),1e3*n.needToShowOnCloseTime),this.isInited=!0}async initActionInfo(e,t){return i=await this.appsApi.needToShowAction({app_id:e,url:t}),s=this.appsService.getAppState(e)?.appData?.launchParams,{needToShowOnStart:i.need_to_show_on_start,needToShowOnCloseTime:i.need_to_show_on_close_time,type:i.type,typeRecommendationInfo:i.type_recommendation_info,needToShowGroupId:i.need_to_show_group_id,needToSetActionShown:!0,...Ne(s,i.type)};var i,s}initAction(e,t,i,s){if(!this.isActionDisallowed(e,t.type,s))switch(t.type){case Ie.rB.PersonalDiscount:this.initPersonalDiscountAction(t,e);break;case Ie.rB.AddToCommunity:this.initAddToCommunityAction(t,e);break;case Ie.rB.RecommendationNotification:this.initRecommendationNotificationAction(t,e,i);break;case Ie.rB.Recommend:this.initAppRecommendAction(t,e);break;case Ie.rB.NotificationsAutoPermission:this.initNotificationsAutoPermissionAction(t,e)}}isActionDisallowed(e,t,i){const s=this.appsService.getAppState(e)?.appData?.launchParams?.is_available_user_actions;return t!==Ie.rB.PersonalDiscount&&!s&&(Boolean(i)&&ke.b.includes(t))}setActionShown(e,t,i){e.needToSetActionShown&&e.type!==Ie.rB.None&&this.appsApi.setActionShown({app_id:i,action_type:e.type,show_type:t})}async initPersonalDiscountAction(e,t){const i=await this.ordersApi.getPersonalDiscount({});i.discount_id&&(this.showPersonalDiscountSnackbar(t,i,e),this.setActionShown(e,Ie.DX.Start,t))}showPersonalDiscountTooltip(e,t){this.tooltips.showTooltip(De.h,De.H),this.personalDiscountAnalytics.logMiniAppsPersonalDiscountEvent({discount_type:e.discount_type,event:we.E.SHOW_TOOLTIP_PROMO,promo_id:e.discount_id,mini_app_id:t})}showPersonalDiscountSnackbar(e,t,i){let n=!1;var a;this.snackbar.show({text:i.typeRecommendationInfo||"",duration:Be,before:{content:(a=t.user?.photo_100,(0,s.Y)(Ee.e,{size:48,src:a,alt:"",children:(0,s.Y)(Ee.e.Badge,{children:(0,s.Y)(Te.l,{})})}))},action:{label:this.langs.getLang("apps_alert_personal_discount_button"),onClick:(i,s)=>{n=!0,this.snackbar.hide(s),this.appsModalsService.show({data:{personalDiscount:t,appId:e},actions:{onSubmit:()=>{this.personalDiscountAnalytics.logMiniAppsPersonalDiscountEvent({discount_type:t.discount_type,event:we.E.OPEN_TAB_MODAL_PURCHASE,promo_id:t.discount_id,mini_app_id:e}),this.votesService.showVotesPaymentPage()},onClose:()=>this.showPersonalDiscountTooltip(t,e)},type:"PersonalDiscountModal"}),this.personalDiscountAnalytics.logMiniAppsPersonalDiscountEvent({discount_type:t.discount_type,event:we.E.OPEN_SNACK_BAR_PROMO,promo_id:t.discount_id,mini_app_id:e})}},onClose:()=>{this.setActionShown(i,Ie.DX.Close,e),n||this.showPersonalDiscountTooltip(t,e)}})}async initAddToCommunityAction(e,t){const i=e.needToShowGroupId;if(!i)return;const s=await this.groupsProvider.ensureFetchGroupById({groupId:i,fields:["title","photo_200"]});if(!s)throw new Error("Failed to fetch group data");this.appsModalsService.show({type:"UserActionAddToCommunityModal",data:{group:s},actions:{}}),this.setActionShown(e,Ie.DX.Start,t)}async initRecommendationNotificationAction(e,t,i){this.showRecommendationSnackbar(t,i,e),this.setActionShown(e,Ie.DX.Start,t)}showRecommendationSnackbar(e,t,i){this.snackbar.show({before:{content:(0,s.Y)(Oe.Y,{})},text:i.typeRecommendationInfo||"",subtitle:this.langs.langReplace(this.langs.getLang("apps_recommendation_notification_subtitle"),{app_name:t}),duration:Be,onClose:()=>{this.setActionShown(i,Ie.DX.Close,e)}})}initAppRecommendAction(e,t){const i=this.appsService.getAppState(t)?.appData?.isRecommended,s=this.modalsLockService.isLocked(ke.N);i||s||(this.appsModalsService.show({type:"AppRecommendModal",data:{appId:t},actions:{}}),this.setActionShown(e,e.needToShowOnStart?Ie.DX.Start:Ie.DX.Close,t))}async initNotificationsAutoPermissionAction(e,t){const i=this.appsService.getAppState(t)?.appData;i&&(this.showNotificationsAutoPermissionSnackbar(e,t,i.isAnyGame),this.setActionShown(e,Ie.DX.Start,t))}showNotificationsAutoPermissionSnackbar(e,t,i){this.notificationsAutoPermissionSnackbar.show({appId:t,isGame:i,duration:Be,onClose:()=>this.setActionShown(e,Ie.DX.Close,t)})}constructor(e,t,i,s,n,a,o,r,p,c,d,h){this.snackbar=e,this.appsApi=t,this.ordersApi=i,this.groupsProvider=s,this.langs=n,this.tooltips=a,this.appsModalsService=o,this.appsService=r,this.personalDiscountAnalytics=p,this.votesService=c,this.modalsLockService=d,this.notificationsAutoPermissionSnackbar=h,this.isInited=!1,(0,l.l_)(this)}}Re=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===fe.q?Object:fe.q,void 0===$.V?Object:$.V,void 0===be?Object:be,void 0===Ce.s?Object:Ce.s,void 0===_.Y?Object:_.Y,void 0===Me.S?Object:Me.S,void 0===V.F?Object:V.F,void 0===C.m?Object:C.m,void 0===Pe.W?Object:Pe.W,void 0===Le.V?Object:Le.V,void 0===B.J?Object:B.J,void 0===We.Q?Object:We.Q])],Re);var xe=i(78157),Ve=i(87854);class He{measureSafe(e,t,i){try{return this.performance.measure(e,t,i)}catch{}}get startPerformanceMetric(){const e=this.measureCustomFinish(Ve.IS),t=this.measureSafe(Ve.mi,Ve.sG),i=!t&&e.type===Ve._J.HARD;return{isDirectLink:i,actResultTime:this.collectActResultTimeFromPerformance(i),startTime:this.collectStartTimeFromPerformance(e,t,i)}}constructor(e){this.performance=e,this.measureCustomFinish=e=>{e=Ve.Ar+e;const t=this.measureSafe(e,Ve.BJ);if(t)return{type:Ve._J.SOFT,startTime:t?.startTime??0,duration:t?.duration??0};{const t=this.measureSafe(e);return{type:Ve._J.HARD,startTime:t?.startTime??0,duration:t?.duration??0}}},this.collectStartTimeFromPerformance=(e,t,i)=>{const s=Math.max(e.startTime,t?.startTime??0),n=this.performance.timeOrigin+s,a=i?this.performance.timeOrigin:n;return Math.round(a)},this.collectActResultTimeFromPerformance=e=>{const t=this.performance.getEntriesByType("navigation")[0],i=e?this.performance.timeOrigin+t.responseEnd:Date.now();return Math.round(i)},(0,l.l_)(this)}}He=(0,d.Cg)([c.z8.container(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===xe.V?Object:xe.V])],He);var Ge=i(18528);class Ke{async[c.Ts](){const{appId:e,groupId:t,loadSecondaryParams:i,loadHelpHints:s,loadActionsMenuData:n,handlerProvider:a,actorId:o}=this.props.current;if(this.isAnonymous){let t=null,i=null;try{t=await this.appsService.getAppInstallScreenForAnonym(e)}catch(e){i=e}return t?(this.platformScreen.setInitialScreenInfo({appResponse:{...t,is_need_to_show_launch_screen:!0}}),this.platformScreen.showInstallScreen()):(0,f.d)(i)&&19===i.error.error_code&&i.error.error_text?this.platformScreen.showPlaceholder(i.error.error_text):this.platformScreen.showNotFoundScreen(),void(0,l.h5)((()=>{this._isLoading=!1}))}this.setLaunchAppProps(),this.launchDataProvider.ensureSessionUuid(),this.statsDataService.setTechnicalQuery(this.query);const r={appId:e,originUrl:this.originUrl,ref:this.ref,loadSecondaryParams:i,query:this.query,ownerId:o??void 0,openGameCardEventData:this.statsDataService.openGameCardEventData,launchScreenParams:{loc:this.pathname.replace("/",""),installCommunityApp:this.launchDataProvider.launchOptions?.installCommunityApp}};try{await Promise.all([this.appsService.loadApp(r,this.platformScreen.setInitialScreenInfo),this.currentAppService.ensure()]);const i=this.appState?.appData;if(!i)return this.platformScreen.showNotFoundScreen(),void(0,l.h5)((()=>{this._isLoading=!1}));i.favicon&&this.favIcon.setFavIcon(i.favicon),this.isJsSdkEnabled&&this.jsSdk.setRPC(this.createRPC(i)),this.isLayer&&this.appsService.updateAppData(e,{layer:this.isLayer}),this._handlers=this.miniAppHandlersService.getHandlers(a,{appId:e,appName:i.title,sourceUrl:this.originUrl,containerId:this.containerId,sendEventToMiniApp:this.sendEventToMiniApp,sendMessageToMiniApp:this.sendMessageToMiniApp,showModal:this.appsModalsService.show.bind(this.appsModalsService)}),i.isNeedToShowLaunchScreen||i.placeholderInfo||(i.isInstalled||i.isCommunityApp||await this.appsService.installApp({appId:e,launchQueryData:this.query,quietInstall:i.isAnyGame,launchEventData:this.launchEventData}),i.url||await this.appsService.loadAppUrl(r,this.launchEventData),this.setMiniAppBaseConfig()),this.currentAppService.setCurrentAppContext({app:i,containerId:this.containerId,updateAppData:t=>{this.appsService.updateAppData(e,t)},groupId:t,RPC:this.jsSdk.rpc,sendEventToMiniApp:this.sendEventToMiniApp,statsConfig:this.statsDataService.statsConfig}),t&&this.additionalInfoService.loadGroupInfo(e,t),s&&this.helpHints.ensureAll(),n&&this.additionalInfoService.loadAppActionsData(e),this._unsubscribeAppearanceChange=this.appearanceService.onModeChange((()=>{this.updateMiniAppConfig({appearance:this.appearance})})),i.isNeedToShowLaunchScreen||this.isLayer||!this.isJsSdkEnabled||this.jsSdkService.reactionOnChangeHash((()=>this.hash))}catch(t){console.error(`Failed to load app ${e}:`,t),(0,l.h5)((()=>{this._isAppLoadingErrors=!0}))}this.locationService.initReactions((()=>this.hash),(()=>this.query)),(0,l.h5)((()=>{this._isLoading=!1}))}get isLayer(){return this.props.current.isLayer}get actorId(){return this.props.current.actorId}get hash(){return this.props.current.hash}resetFavIcon(){const e=window.devicePixelRatio>=2?"_2x":"";this.favIcon.setFavIcon("/images/icons/favicons/fav_logo"+e+".ico")}[c.zr](){this.currentAppService.clearCurrentAppInstance(),this.appsService.deleteApp(this.appId),this.dimensions.destroy(),this.resetFavIcon(),this._unsubscribeAppearanceChange?.()}get connector(){return this.props.current.connector}get ref(){return this.statsDataService.ref}get pathname(){return this.props.current.pathname||window.location.pathname}get originUrl(){return(0,k.TO)({domain:this.vkHost.getDomainName(),pathname:this.pathname,query:this.query,hash:this.hash})}get appState(){return this.appsService.getAppState(this.appId)}get config(){return this._config}get appId(){return this.props.current.appId}get launchId(){return this.props.current.launchId}get navigationSection(){return this.props.current.navigationSection}get isLoading(){return this._isLoading}get query(){return this.props.current.query||{}}get isAppLoadingErrors(){return!this.isLoading&&this._isAppLoadingErrors}get isAppNotFound(){return!this.isLoading&&!this.appState?.appData}get containerClassName(){return this.props.current.containerClassName}get containerId(){return`app_${this.appId}_container`}get before(){return this.props.current.before}get after(){return this.props.current.after}get internalRef(){return this.props.current.internalRef}get isJsSdkEnabled(){const{isAnyGame:e,isCommunityApp:t,isApp:i}=this.appState?.appData||{};return e||t||i||!1}setSendMessageToMiniAppHandler(e){this._sendMessage=e}async setMiniAppBaseConfig(){const e=this.appState?.appData,{platformId:t,onMessage:i,iframeParams:s}=this.props.current;let n=null;if(e){const{id:a,url:o,shareUrl:r,title:p,isInternalApp:c,isInstalled:d,myTrackerTimeSpentCounterId:l,needPolicyConfirmation:h,isCommunityApp:u,isMiniApp:g,isClipboardWriteAvailable:_}=e,{url:m,hash:S}=(0,k.V)(o,this.hash),A=[...I.fE];_&&A.push("clipboard-write"),n={app:{id:a,url:m,shareUrl:r,title:p,hash:S,query:this.appsService.getAppConfigQuery(e,this.query),internal:c,isInstalled:d,myTrackerTimeSpentCounterId:l,needPolicyConfirmation:h,isWithoutInitApp:u},onGetHostToken:this.authService.fetchWebToken.bind(this.authService),requestApiMethod:this.appsService.requestApiMethod.bind(this.appsService),getLang:this.miniAppLangs.getLang,onModalRequest:this.modalsHandler,onReady:this.handleOnReady,apiUrl:this.appApiConfigService.apiUrl,authUrl:this.appApiConfigService.authUrl,policyConfirmationUrl:this.appApiConfigService.policyConfirmationUrl,userId:this.authService.userId??void 0,adsPlatformConfig:this.props.current.platformAdsConfig,handlers:this._handlers??void 0,iframeProps:{title:"MiniAppFrame",name:this.jsSdk.iframeName,style:e?(0,k.Sm)(e):void 0,allowFullScreen:!0,allow:A.join(";"),scrolling:g?void 0:s?.scrolling},sendStatEvent:this.statsTransportService.sendStatEvent.bind(this.statsTransportService),forceSendStatEvent:this.statsTransportService.forceSendStateEvent.bind(this.statsTransportService),featureToggles:this.featureToggles,setRef:this.jsSdk.setIframeRef,sessionUuid:this.statsDataService.sessionUuid,onExternalInit:this.jsSdk.onExternalInit,onExternalSessionStart:this.jsSdk.onExternalSessionStart,onMessage:e=>i?.(e),config:{scrollTarget:this.props.current.getScrollTarget?.(),isLayer:this.isLayer,appearance:this.appearance,performance:this.performanceService.startPerformanceMetric},onResizeWindow:this.dimensions.onResize,featureEnabled:this.featureEnabledService.featureEnabled,host:{id:t,title:window.location.host},statsConfig:this.statsDataService.statsConfig}}(0,l.h5)((()=>{this._config=n}))}get modalsHandler(){return this.appsModalsService.show.bind(this.appsModalsService)}get currentModal(){return this.appsModalsService.currentModal}get isCurrentModalOverlay(){return this.appsModalsService.isCurrentModalOverlay}get currentModalId(){return this.appsModalsService.currentModalId}get featureToggles(){return{enableSessionManager:!0,enableCollectPerformance:!0,disableAuthByExchangeToken:!0,motionStickyExperimentGroup:this.featureEnabledService.getMotionStickyExperimentGroup()}}get appearance(){return this.appearanceService.isDarkTheme()?h.i.Dark:h.i.Light}registerLifecycleCallbacks(e){const t=this.appState?.appData;t&&(e.hooks.onInit.add((()=>{this.userActionsService.initUserActions({appId:this.appId,appName:t.title,sourceUrl:this.originUrl,isJsSdk:t.isJsSdk})})),t.isAnyGame||e.hooks.onIframeTimeoutError.add(this.platformScreen.showIframeError))}get stretchedInfoScreens(){return this.props.current.stretchedInfoScreens}get isAnonymous(){return!this.authService.isAuthorized}get isInternal(){return this.appState?.appData?.isInternalApp}get isWidescreen(){return this.appState?.appData?.isWidescreen}get launchEventData(){return this.statsDataService.launchEventData}setLaunchAppProps(){this.launchDataProvider.setLaunchAppProps({appId:this.appId,actorId:this.actorId,queryParams:this.query,location:this.hash,internalRef:this.internalRef,isLayer:this.isLayer})}get onResized(){return this.props.current.onResized}constructor(e,t,i,s,n,a,o,r,p,c,d,h,u,g,_,m,S,A,v,f,b,C,w,I){this.appApiConfigService=e,this.authService=t,this.appsService=i,this.miniAppHandlersService=s,this.appsModalsService=n,this.additionalInfoService=a,this.vkHost=o,this.currentAppService=r,this.props=p,this.langs=c,this.miniAppLangs=d,this.helpHints=h,this.statsTransportService=u,this.statsDataService=g,this.miniAppsLegacyService=_,this.jsSdkService=m,this.appearanceService=S,this.featureEnabledService=A,this.userActionsService=v,this.favIcon=f,this.performanceService=b,this.launchDataProvider=C,this.locationService=w,this.userEnv=I,this._isLoading=!0,this._isAppLoadingErrors=!1,this._config=null,this._handlers=null,this._sendMessage=null,this._unsubscribeAppearanceChange=null,this.sendEventToMiniApp=(e,t)=>{this._sendMessage?.({message:{type:e,data:t}})},this.sendMessageToMiniApp=e=>{this._sendMessage?.(e)},this.onInstall=async()=>{const{actorId:e}=this.props.current,t=this.appState?.appData;let i=t?.url;if(i||(i=await this.appsService.loadAppUrl({appId:this.appId,originUrl:this.originUrl,ref:this.ref,ownerId:e??void 0},this.launchEventData)),!t||!i)return;const s={url:i,isInstalled:!0};this.isJsSdkEnabled&&(this.jsSdk.setRPC(this.createRPC({...t,...s})),this.jsSdk.setAppAccessToken(t.appAccessToken)),this.appsService.updateAppData(this.appId,s),this.setMiniAppBaseConfig(),this.platformScreen.showDefaultScreen(),!this.isLayer&&this.isJsSdkEnabled&&this.jsSdkService.reactionOnChangeHash((()=>this.hash))},this.handleOnReady=({lifecycle:e,sendMessageToMiniApp:t,getMessageHandler:i})=>{this.setSendMessageToMiniAppHandler(t),this.connector.connect({launchId:this.launchId,appId:this.appId,lifecycle:e,sendEventToMiniApp:this.sendEventToMiniApp,sendMessageToMiniApp:this.sendMessageToMiniApp}),this.registerLifecycleCallbacks(e),this.appsService.updateAppData(this.appId,{getSDKBridgeHandler:i})},this.renderModalComponent=e=>this.isCurrentModalOverlay?this.props.current.modalRunners.showOverlayModal(e):this.props.current.modalRunners.showModal(e),this.closeModal=e=>this.appsModalsService.reset(e),this.updateMiniAppConfig=e=>{this._config&&(this._config={...this._config,config:{...this._config.config,...e}})},this.createRPC=e=>this.jsSdkService.createRPC({appData:e,getHash:()=>this.hash}),this.dimensions=new y(this.userEnv,this.props,(()=>this.appState)),this.platformScreen=new E(this.appsService,this.langs,this.launchDataProvider,this.props),this.jsSdk=new P(this.currentAppService,this.miniAppsLegacyService),(0,l.l_)(this,{_config:l.sH.shallow})}}Ke=(0,d.Cg)([c.z8.transient(),(0,d.Sn)("design:type",Function),(0,d.Sn)("design:paramtypes",[void 0===L.V?Object:L.V,void 0===u.u?Object:u.u,void 0===C.m?Object:C.m,void 0===x?Object:x,void 0===V.F?Object:V.F,void 0===H.R?Object:H.R,void 0===g.O?Object:g.O,void 0===G.o?Object:G.o,void 0===c.Ji?Object:c.Ji,void 0===_.Y?Object:_.Y,void 0===K?Object:K,void 0===v.a?Object:v.a,void 0===J?Object:J,void 0===q.R?Object:q.R,void 0===X.W?Object:X.W,void 0===Ae?Object:Ae,void 0===m.b?Object:m.b,void 0===ve.V?Object:ve.V,void 0===Re?Object:Re,void 0===S.D?Object:S.D,void 0===He?Object:He,void 0===w.n?Object:w.n,void 0===Ge.b?Object:Ge.b,void 0===A.J?Object:A.J])],Ke);const{Provider:Fe,useModel:je}=(0,c.Qd)(Ke,{initInEffect:!1});var Ue=i(306121);const Ye=(0,a.P)((function({modal:e,modalId:t,renderComponent:i,closeModal:s}){const a=(0,n.useRef)(se.l),{type:o,data:r,actions:p,appearance:c}=e,d=(0,n.useCallback)(((e=se.l)=>{a.current=e}),[t]);return i({modalProps:{modalParams:{type:o,data:r,actions:p,appearance:c},modalOptions:{unmount:(0,n.useCallback)((()=>{a.current(),d(),s(t)}),[t]),modalId:t,setOnDestroy:d}}})})),ze=(0,a.P)((function(){const e=je(),t=(0,n.useRef)(null),{query:i,config:a,isLoading:c,containerClassName:d,containerId:l,appId:h,dimensions:u,currentModal:g,isAppNotFound:_,currentModalId:m,isCurrentModalOverlay:S,closeModal:A,renderModalComponent:v,before:f,after:y,platformScreen:b,onInstall:C,navigationSection:w,stretchedInfoScreens:E,isAppLoadingErrors:T,isInternal:O,isAnonymous:M,isLayer:D,onResized:P,launchEventData:L,isWidescreen:N}=e,{installScreenData:W,unavailableScreenData:B,splashScreenData:R,screenComponents:x,showDefaultScreen:V,showInstallScreen:H,showNotFoundScreen:G,showDefaultErrorScreen:K,showUnavailableScreen:F,currentScreenType:j}=b,{unavailableScreen:U,notFoundScreen:Y,installScreen:z}=x;(0,n.useEffect)((()=>{M||(T?K():_?G():V())}),[h,T,_,M]),(0,n.useEffect)((()=>{u.size?.height&&t.current&&!N&&t.current.style.setProperty("--app-container-min-height",`${u.size.height}px`)}),[u.size,t,N]);const J=m&&g,q=!!J&&S,X=J&&(0,s.Y)(Ye,{modalId:m,modal:g,renderComponent:v,closeModal:A});if(j&&j!==I.ZJ.NONE)switch(j){case I.ZJ.NOT_FOUND:return(0,s.Y)(Y,{stretched:E});case I.ZJ.UNAVAILABLE:return(0,s.Y)(U,{controlPanel:f,...B});case I.ZJ.INSTALL:return(0,s.FD)(s.FK,{children:[f,(0,s.Y)(z,{...W,query:i,onInstall:C,onResized:P,isLayer:D,launchEventData:L}),y,X]});default:throw new Error(`Unsupported screen type: ${j}`)}const Q=(0,k.s_)({...u.size,isLoading:c,defaultHeight:u.skeletonHeight,isOverlayActive:q,isLayer:D});return(0,s.FD)(s.FK,{children:[f,(0,s.FD)(p.i,{id:l,"data-testid":"app_container",mode:"vertical",paddingTop:0,paddingBottom:0,className:d,style:Q,getRootRef:t,children:[(0,s.Y)("div",{style:{display:q?"none":void 0,height:"100%"},children:c?(0,s.Y)(w.Loader,{children:!O&&(0,s.Y)(Ue.Z,{height:u.skeletonHeight})}):(0,s.Y)(w.Content,{children:(0,s.Y)(o.G,{appId:h,splashScreen:R,installScreen:W,unavailableScreen:B,onShowUnavailableScreen:F,onShowInstallScreen:H,children:a&&(0,s.Y)(r.W,{...a})})})}),X]}),y]})})),Je=(0,c.jn)(Fe,ze)},238919:(e,t,i)=>{i.d(t,{e:()=>p});var s=i(221020),n=i(634164),a=i(455356);const o="Lottie__root--VeNx2",r="Lottie__canvas--zOhea",p=({play:e,fallback:t,options:i,className:p,style:c,...d})=>{const{width:l,height:h}=i,{lottieContainerRef:u,lottieRendered:g}=(0,a.X)({...i,className:r},{play:e});return(0,s.Y)("div",{ref:u,...d,className:(0,n.$)(o,p),style:{...c,width:l??c?.width??"100%",height:h??c?.height??"100%"},children:(0,s.Y)("div",{children:!g&&t})})}},668355:(e,t,i)=>{i.d(t,{E:()=>s});var s=function(e){return e.OPEN_SNACK_BAR_PROMO="open_snack_bar_promo",e.VIEW_PROMO_MODAL="view_promo_modal",e.HIDE_PROMO_MODAL="hide_promo_modal",e.OPEN_TAB_MODAL_PURCHASE="open_tab_modal_purchase",e.OPEN_TAB_APP_SETTINGS_PURCHASE="open_app_settings_purchase",e.OPEN_TAB_MENU_PURCHASE="open_tab_menu_purchase",e.OPEN_TAB_PROFILE_PURCHASE="open_tab_profile_purchase",e.SHOW_TOOLTIP_PROMO="show_tooltip_promo",e.SHOW_INSTRUCTION_PROMO="show_instruction_promo",e}({})},35620:(e,t,i)=>{i.d(t,{H$:()=>a,iL:()=>s,lG:()=>n});var s=function(e){return e.ACTION_MENU_SHARE="action_menu_share",e.ACTION_MENU_ADD_TO_FAVOURITES="action_menu_add_to_favourites",e.ACTION_MENU_REMOVE_FROM_FAVOURITES="action_menu_remove_from_favourites",e.ACTION_MENU_ENABLE_NOTIFICATIONS="action_menu_enable_notifications",e.ACTION_MENU_DISABLE_NOTIFICATIONS="action_menu_disable_notifications",e.ACTION_MENU_ALL_APPS="action_menu_all_apps",e.ACTION_MENU_ALL_GAMES="action_menu_all_games",e.ACTION_MENU_COPY="action_menu_copy",e.ACTION_MENU_DELETE="action_menu_delete",e.ACTION_MENU_RECOMMEND="action_menu_recommend",e.ACTION_MENU_UNRECOMMEND="action_menu_unrecommend",e.ACTION_MENU_ENABLE_BADGES="action_menu_enable_badges",e.ACTION_MENU_DISABLE_BADGES="action_menu_disable_badges",e.ACTION_MENU_ADD_TO_BOOKMARKS="action_menu_add_to_bookmarks",e.ACTION_MENU_REMOVE_FROM_BOOKMARKS="action_menu_remove_from_bookmarks",e}({}),n=function(e){return e.SENT="notifications_request_sent",e.CLOSE="notifications_request_close",e.SWIPE="notifications_request_swipe",e.TIMEOUT="notifications_request_timeout",e.SETTINGS_OPEN="notifications_request_settings_open",e}({}),a=function(e){return e.CLICK_BALANCE_BUTTON="games_catalog_click_balance_button",e}({})},893899:(e,t,i)=>{i.d(t,{J:()=>l});var s=i(221020),n=i(772812),a=i(370633),o=i(413621),r=i(180329),p=i(638945),c=i(423654),d=i(708398);const l=({src:e,srcSet:t,href:i,subhead:l,title:h,description:u,action:g,content:_,onLinkClick:m,imageLinkAriaLabel:S,"data-testid":A,getRootRef:v})=>(0,s.FD)(a.Y,{className:d.A.container,padding:"none",separator:"hide",getRootRef:v,"data-testid":A,children:[(0,s.Y)(o._,{className:d.A.image,widthSize:428,heightSize:241,src:e,srcSet:t,href:i,onClick:m,"aria-label":S,alt:""}),(0,s.FD)(r.s,{className:d.A.info,direction:"column",children:[(0,s.Y)(p.tW,{className:(0,n.I)("color_text_subhead"),children:l}),(0,s.Y)(p.hE,{className:d.A.title,level:"3",weight:"2",children:(0,s.Y)(c.N,{className:(0,n.I)("color_text_primary"),href:i,hasVisited:!1,onClick:m,children:h})}),(0,s.Y)(p.tW,{className:(0,n.I)("color_text_secondary"),children:u}),!!_&&(0,s.Y)("div",{className:d.A.content,children:_}),!!g&&(0,s.Y)("div",{className:d.A.action,children:g})]})]})},708398:(e,t,i)=>{i.d(t,{A:()=>s});const s={container:"vkitGamesCatalogCard__container--2JlSy",image:"vkitGamesCatalogCard__image--mOJJb",info:"vkitGamesCatalogCard__info--CSsUZ",title:"vkitGamesCatalogCard__title--pM6qm",content:"vkitGamesCatalogCard__content--dk10C",action:"vkitGamesCatalogCard__action--FiTe0"}}}]),"undefined"!=typeof window&&window.stManager?.done?.("dist/core_spa/chunks/74660.ec7b2809.js")}catch(e){throw"undefined"!=typeof window&&window.stManager?.fail?.("dist/core_spa/chunks/74660.ec7b2809.js",e),e}