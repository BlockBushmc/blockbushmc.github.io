try{(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[39436],{126415:(e,o,t)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="m8.53 4.69.06.18-.22-.63a.83.83 0 0 0-1.6.47l.13.48-.23-.85a.82.82 0 0 0-1.6.24l-.73-2.93a.85.85 0 0 0-1.65.4L4 7.34 2.87 6.18A.8.8 0 0 0 1.66 7.2l2.23 2.94s1.23 1.83 4.3 1.23c2.43-.48 3.25-2.67 2.59-4.88l-.56-2.3a.88.88 0 1 0-1.7.49Z"/></svg>',name:"hand_point_up_12"}}t.d(o,{getIcon12HandPointUp:()=>i})},638770:(e,o,t)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.6 6.41a.9.9 0 0 1-.1-1.8 12.22 12.22 0 0 1 10 4.9c.58.84.9 1.7.9 2.49 0 .94-.46 1.98-1.24 2.97a.9.9 0 1 1-1.42-1.12c.41-.52.86-1.17.86-1.85 0-.31-.14-.82-.59-1.48a8.43 8.43 0 0 0-1.94-1.96A10.24 10.24 0 0 0 11.6 6.4ZM4.84 16.89A12.35 12.35 0 0 0 12 19.4c1.97 0 3.93-.6 5.6-1.52l1.26 1.26a.9.9 0 0 0 1.28-1.28L6.64 4.36a.9.9 0 0 0-1.28 1.28l.69.68c-.42.25-.82.51-1.2.8-.97.72-1.79 1.55-2.36 2.39-.57.84-.89 1.7-.89 2.49 0 .79.32 1.65.9 2.5.56.83 1.37 1.66 2.35 2.39ZM10.4 12a1.6 1.6 0 0 0 2.59 1.26l-2.25-2.25a1.6 1.6 0 0 0-.34.99Zm1.6 3.4a3.4 3.4 0 0 1-2.54-5.66l-2.09-2.1c-.51.28-1 .58-1.44.92a8.4 8.4 0 0 0-1.94 1.96A2.84 2.84 0 0 0 3.4 12c0 .31.14.82.59 1.48A10.56 10.56 0 0 0 12 17.6c1.43 0 2.92-.4 4.26-1.06l-2-2a3.39 3.39 0 0 1-2.27.86Z" clip-rule="evenodd"/></svg>',name:"hide_outline_24"}}t.d(o,{getIcon24HideOutline:()=>i})},143268:(e,o,t)=>{function i(){return{icon:'<svg fill="none" height="56" viewBox="0 0 56 56" width="56" xmlns="http://www.w3.org/2000/svg"><path d="M37.74 6c3.57 0 4.86.37 6.17 1.07s2.32 1.72 3.02 3.02c.7 1.3 1.07 2.6 1.07 6.17v23.48c0 3.57-.37 4.86-1.07 6.17a7.27 7.27 0 0 1-3.02 3.02c-1.3.7-2.6 1.07-6.17 1.07H18.26c-3.57 0-4.86-.37-6.17-1.07-1.3-.7-2.32-1.72-3.02-3.02S8 43.3 8 39.74V16.26c0-3.57.37-4.86 1.07-6.17.7-1.3 1.72-2.32 3.02-3.02S14.7 6 18.26 6zm.32 3h-19.8c-2.8 0-3.77.19-4.75.71a4.27 4.27 0 0 0-1.8 1.8c-.5.95-.7 1.87-.7 4.43L11 39.74c0 2.8.19 3.77.71 4.75a4.27 4.27 0 0 0 1.8 1.8c.99.52 1.95.71 4.75.71h19.48c2.8 0 3.77-.19 4.75-.71a4.27 4.27 0 0 0 1.8-1.8c.52-.98.71-1.95.71-4.75V16.26c0-2.8-.19-3.77-.71-4.75a4.27 4.27 0 0 0-1.8-1.8c-.95-.5-1.87-.7-4.43-.7zM18.72 38c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13z" fill="currentColor"/></svg>',name:"video_outline_56"}}t.d(o,{getIcon56VideoOutline:()=>i})},134551:(e,o,t)=>{t.d(o,{Video:()=>Z});var i=t(474848),n=t(754866),s=t(412573),r=t(432081),d=t(892848),a=t(560377),c=t(102088),l=t(898848),u=t(270959),_=t(636576),h=t(342879),v=t(672277),g=t(692543),p=t(246429),E=t(432465),m=t(478752),I=t(972332),S=t(683234),w=t(568129),V=t(843570),f=t(638770),C=t(963251),b=t(143268),A=t(150585),L=t(723022),y=t(287470),O=t(826619),T=t(952661),D=t(342018),P=t(540462),M=t(800361),R=t(468073),B=t(856289),x=t(395846),N=t(450927),k=t(90345),F=t(3820),G=t(134865),H=t(538522),Y=t(873900),U=t(373594),j=t(205389),X=t(36644),W=t(636826),q=t(187862),K=t(428374),Q=t(537324),$=t(452223),z=t(253575);const Z={VIDEO_SEARCH_TYPE:"search_videos",VIDEO_GLOBAL_SEARCH_TYPE:"search_global_videos",VIDEO_SEARCH_TOP_TYPE:"search_top_videos",ALBUM_SEARCH_TYPE:"search_albums",ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:"search_promo_albums",SEARCH_FILTERS:["hd","notsafe","live","date","order","len"],AVAILABLE_TABS:["all","uploaded","scheduled","albums","clips"],VIDEOS_PER_PAGE:60,VIDEOS_PER_ROW:3,PLAYLIST_FIRST_CHUNK_SIZE:9,PLAYLIST_OBJECT_ID_INDEX:6,SEARCH_KEEP_FILTERS_DELAY:3e3,SEARCH_STATS_POSITION_FIELDS:["oid","vid","clicked","viewStarted","viewedParts","viewedSeconds"],USER_SYSTEMS_ALBUM_TYPES:["type_my_uploaded","type_my_added","type_my_lives","type_my_recorded_calls"],DAY_IN_MS:864e5,getLoc:function(){const e=cur.showcaseSection&&"uploaded"===cur.showcaseSection;return cur.curLoc?cur.curLoc:cur.is_showcase&&!nav.objLoc.section&&cur.showcaseSection&&("playlist"===cur.section||(0,m.inArray)(cur.showcaseSection,Z.USER_SYSTEMS_ALBUM_TYPES)||e)?(nav.objLoc.section=cur.showcaseSection,nav.objLoc):((0,l.isEmpty)(nav.objLoc)||!nav.objLoc[0]||0!=nav.objLoc[0].indexOf("video"))&&cur.section&&(0,m.inArray)(cur.section,["catalog","all","uploaded","albums"])?{0:"catalog"===cur.section?"video":"videos"+cur.oid}:nav.objLoc},init:function(){cur.searchInputEl=(0,n.geByClass1)("video_search_input"),cur.videoRecentlyRemoved={},cur.videoShowWindow={},cur.found={},cur.silentLoaded={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.videoSearchStats=null,cur.videoSearchPos=null,cur.videoSearchTrackCodeForQID="",cur.albumsPreload=cur.albumsPreload||{},cur.albumsShowingAll={},cur.curLoc=!!cur.query&&nav.fromStr(cur.query);const e=()=>{Z._initScroll()},o=()=>{(0,I.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null};window.cur._back?(window.cur._back.hide?window.cur._back.hide.push(o):window.cur._back.hide=[o],window.cur._back.show?window.cur._back.show.push(e):window.cur._back.show=[e]):window.cur._back={hide:[o],show:[e]},(0,l.isObject)(cur.curLoc)&&(cur.curLoc.section=cur.section),cur.getOwnerId=function(){return cur.oid},Z.initNavigation(),Z.initSearch();const t=Z._getCurrentSectionType();if(Z.isInAlbum()||Z.loadSilent(),Z.loadSilent(Z.getLoc().section),"catalog"===t&&"playlists"!==Z.getLoc().section||Z.initOwnerVideoPage(),cur.videoCanSort&&"all_playlists"===cur.showcaseSection){const e=document.getElementById("video_all_playlists_list");e&&(0,N.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:Z._onAlbumReorder})}))}cur.curLoc=!1,cur.section=!1,cur.currentModule=function(){return Z.isInSearch()?"video_search":cur.is_showcase&&cur.ref?cur.ref:Z.isInCatalog()?"videocat":Z.isInVideosList()?R.Ranges.isGroupId(cur.oid)?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos":cur.module},Z._initScroll(),Z._loadNextChunkIfNeed(),Z._updateThumbsInView(),cur.videoSortItems=[["default",(0,c.getLang)("video_sort_dd_by_default")],["popularity",(0,c.getLang)("video_sort_dd_by_popularity")],["new",(0,c.getLang)("video_sort_dd_newest")],["old",(0,c.getLang)("video_sort_dd_oldest")],["short",(0,c.getLang)("video_sort_dd_shortest")],["long",(0,c.getLang)("video_sort_dd_longest")]]},_loadNextChunkIfNeed:function(){if(!cur.is_showcase)return;if((0,Q.hasSectionInCache)(window.nav.strLoc,window.cur.listNextFrom))return void Z.onScroll();window.dispatchEvent(new Event("video_legacy_catalog_cache_loaded"));const e=document.getElementById(`ui_${cur.showcaseSection}_load_more`);if(e&&e.clientHeight&&(0,y.isElementInViewport)(e))return void Z.onScroll();const o=document.getElementById(`video_${cur.showcaseSection}_list`);if(o){o.getBoundingClientRect().bottom-(0,n.clientHeight)()<300&&Z.onScroll()}},_getMyAddedVideosPath:function(){return cur.my_added_videos_path},_initScroll:function(){cur._ev_onScroll&&(0,I.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=(0,A.throttle)(Z.onScroll,100),(0,I.addEvent)(window,"scroll",cur._ev_onScroll),(0,D.pushNavDestroy)((()=>{(0,I.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}))},initOwnerVideoPage:function(){if(cur._videoInited)return;if(cur._videoInited=!0,cur.videoCanSort){if(!Z.isInAlbum()){const e=cur.is_showcase?"video_playlist_list":"video_albums_list";(0,N.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:Z._onAlbumReorder})}))}Z._createSorters()}Z.isGroupsRedesignEnabled()&&Z.isInVideosList()&&(0,j.initVideoExtraTabsActions)({commentsTooltipText:(0,c.getLang)("video_comments_review"),orderItems:cur.videoSortItems.map(j.mapRawVideosOrderItemToVideosOrderItem),canSeeComments:!!cur.canSeeCommentsPage,canSeeOrder:!!cur.canSeeOrder,onCommentsButtonClick:()=>nav?.objLoc?.[0]&&nav.go(nav.objLoc[0]+"/comments"),onVideosOrderChange:Z._sortVideos});const e=(0,n.ge)("video_sort_dd");e&&(cur.videoSortDD=new K.InlineDropdown(e,{items:cur.videoSortItems,withArrow:!0,ariaLabel:(0,c.curLang)("video_search_order"),selected:"default",onSelect:Z._sortVideos})),Z._toggleSorter("albums"!==Z.getLoc().section)},_toggleSorter:function(e){const o=(0,n.geByClass1)("video_tab_actions_wrap"),t=[(0,n.geByClass1)("_video_sort_dd_wrap",o),(0,n.geByClass1)("divider",o)];(0,n.toggle)(t[0],e),(0,n.toggle)(t[1],e)},updateEmptyPlaceholder:function(e){if(!e)return;let o=!1,t="";"albums"===e?cur.playlistsCount||(o=!0,t=(0,c.getLang)("video_no_albums_placeholder_text")):cur.videosCount[cur.getOwnerId()][e]||(o=!0,(0,m.inArray)(e,["all","type_my_added"])||e.startsWith("playlist_")||(t=(0,c.getLang)("video_no_videos_here_yet"))),Z._toggleEmptyPlaceholder(o,t)},initNavigation:function(){(0,V.pickTrackCodeFromURL)(),cur.nav.push((function(e,o,t,i){const s=void 0!==e[0],r=!cur.is_showcase&&"comments"===t.section,a=t.q&&!o.q&&t[0].indexOf("video")>=0,c=o.q&&!t.q&&o[0].indexOf("video")>=0,l="upload"===o.section&&!t.section,u=e.q;if(a||u?Z._initSearchStats(t):c&&Z._clearSearchStats(),(0,d.revertLastInlineVideo)(),r)return delete cur._back,!0;if(s){const o=cur.getOwnerId();if(o==vk.id&&(cur.is_showcase||!(0,m.inArray)(e[0],["video","videos"+o])))return!0;if(o!=vk.id&&!(0,m.inArray)(e[0],["videos"+o]))return!0}if(l)return!0;if(window.uiTabs?.hideProgress?.("video_main_tabs"),"all"===e.section&&delete t.section,a&&(cur.videoLocBeforeSearch=o),c&&(cur.videoSearchFilters={},cur.lastProcessedSearchParams=null,Z.doSearch(),Z.inputVal(cur.searchInputEl,""),cur.videoLocBeforeSearch&&i.fromSearch)){const e=(0,m.clone)(cur.videoLocBeforeSearch);return delete cur.videoLocBeforeSearch,nav.go(e),!1}const h=t.section||"all";if(t.q||(0,w.removeSearchPositionTracker)(w.serviceVideo),t.q)Z.isInAlbum()||delete t.section,a&&"lives"===cur.section_id&&(t.live=1),Z._prepareSearchFilters(t),i.fromSearch||Z.inputVal(cur.searchInputEl,t.q),i.fromSearch||i.globalQuery||(i.globalQuery=t.q),Z.doSearch(t.q),Z._toggleSearchProgress(!1);else{if(cur.is_showcase)return"left_nav"===i.params?._ref||(nav.setLoc(t),!(!cur.is_showcase||!t.z||o.z===t.z)||(o.section!==t.section||o[0]!==t[0]));if(-1==Z.AVAILABLE_TABS.indexOf(h))return~h.indexOf("album")&&(0,_.statlogsValueEvent)("video_play_album",0,"open_album"),!0;{if(Z.isInAlbum(o.section))return nav.setLoc(t),!0;(0,m.each)(Z.AVAILABLE_TABS,(function(e,o){(0,n.hide)("video_subtab_pane_"+o)})),(0,n.show)("video_subtab_pane_"+h),Z.updateEmptyPlaceholder(h);const e=(0,n.domFC)((0,n.ge)("video_tab_"+h));e&&window.uiTabs.switchTab(e,{noAnim:i.hist}),"albums"!==h?(Z.loadSilent(h),cur.videoSortDD&&cur.videoSortDD.select(cur.currentSortings[h]||"default",!0),Z._toggleSorter(!0)):Z._toggleSorter(!1),Z._createSorters(h)}}return!!t.show_original||(nav.setLoc(t),!1)})),(0,D.pushNavDestroy)((()=>{cur.nav.pop()}))},initSearch:function(){cur.searchInputEl=(0,n.ge)("video_search_input"),cur.lastProcessedSearchParams=null,cur._videoRenderedSearchResults={},cur.searchInputEl&&!cur.is_showcase&&((0,n.data)(cur.searchInputEl,"opts").onChange=Z.onSearchInputChange,(0,n.data)(cur.searchInputEl,"opts").onBlur=Z.onSearchInputBlur,cur.searchInputEl.focus())},onSearchInputChange:function(e,o,t){e=(0,m.trim)(e),o=(0,l.isString)(o)?(0,m.trim)(o):"";let i={};e||((0,m.each)(Z.SEARCH_FILTERS,(function(e,o){i[o]=!1})),cur.videoPrevSearchFilters=(0,m.clone)(cur.videoSearchFilters),setTimeout((function(){delete cur.videoPrevSearchFilters}),Z.SEARCH_KEEP_FILTERS_DELAY)),e&&cur.videoPrevSearchFilters&&(i=cur.videoPrevSearchFilters,delete cur.videoPrevSearchFilters),nav.change((0,m.extend)({q:e||!1,no_spellcheck:!1,suggest_trackcode:t||!1},i),!1,{fromSearch:!0,globalQuery:o})},onSearchInputBlur:function(){(0,m.trim)((0,n.val)(cur.searchInputEl))&&(cur.vSearchInputBlurred=!0)},_sortVideos:function(e){window.tooltips&&tooltips.hideAll();let o=Z._getCurrentSectionType();const t=cur.getOwnerId();"album"===o&&(o=Z.getLoc().section);let i=cur.silentLoaded[t][o];if(!i)return Z.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(O.VideoOrderEvents.START_LOADING)):((0,n.show)("video_sort_progress"),(0,n.hide)("video_sort_dd")),void Z._addPendingAction(o,(function(){Z._sortVideos(e)}));Z.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(O.VideoOrderEvents.END_LOADING)):((0,n.hide)("video_sort_progress"),(0,n.show)("video_sort_dd"));let s=0;i=i.filter((function(e){const o=e[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+e[VideoConstants.VIDEO_ITEM_INDEX_ID];return!cur.videoRecentlyRemoved[o]||(s++,!1)}));const r=cur.videosCount[cur.getOwnerId()];if(s&&r)if(Z.isInAlbum()){const e="album_"+Z._getSectionAlbumId();r[e]&&(r[e]-=s,(0,n.val)((0,n.geByClass1)("_video_subtitle_counter",(0,n.ge)("video_layout_contents")),(0,c.langNumeric)(r[e],(0,c.curLang)("video_playlist_size"))))}else r.all-=s,Z.updateTabCounter(r.all);cur.pageVideosList?.[t]?.[o]?.count===cur.silentLoaded[t][o].length&&(cur.pageVideosList[t][o].list=i,cur.pageVideosList[t][o].count=i.length),cur.silentLoaded[t][o]=i,clearTimeout(cur._sortTO),cur._sortTO=setTimeout((function(){if(!i.length)return;i.sort((function(o,t){switch(e){case"default":return o[cur.indexIndex]-t[cur.indexIndex];case"new":return t[VideoConstants.VIDEO_ITEM_INDEX_DATE]-o[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"old":return o[VideoConstants.VIDEO_ITEM_INDEX_DATE]-t[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"popularity":return t[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]-o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS];case"short":return o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION];case"long":return t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]}}));(0,n.ge)("video_"+o+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[t]&&(cur.videoShowWindow[t][o]=!1),Z.showMore(o),Z._reinitSorters("default"!==e),cur.currentSortings=cur.currentSortings||{},cur.currentSortings[o]=e}),10)},_reindex:function(e){for(let o=0,t=e.length;o<t;o++)e[o].length>=cur.indexIndex?e[o][cur.indexIndex]=o:e[o].push(o)},_onAlbumReorder:function(e,o,t){const i=e.getAttribute("data-id"),n=t&&!t.getAttribute("nodrag")?t.getAttribute("data-id"):null,s=o&&!o.getAttribute("nodrag")?o.getAttribute("data-id"):null;let r=!1;const d=cur.albumsSorter._contEl;if(cur.is_showcase&&d){if(r=e.classList.contains("VideoCard--first")||e.classList.contains("VideoCard--second"),!r){const e=[...d.querySelectorAll(".js-video_playlist_item")];e.length&&(r=e[0].getAttribute("data-id")===i||e[1].getAttribute("data-id")===i)}const o=d.querySelector(`.VideoPlaylistInfo[data-id='${i}']`);o&&e.insertAdjacentElement("afterend",o)}r&&[...d.querySelectorAll(".js-video_playlist_item:not(.VideoCard--isSystem)")].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o),e.classList.toggle("VideoCard--second",1===o)})),ajax.post("al_video.php?act=reorder_albums",{oid:cur.getOwnerId(),aid:i,before:s,after:n,hash:cur.videoAlbumsSortHash,need_update:r?1:0},{onDone:function(e){Z._updatePlaylistPanel(e)}})},_onReorder:function(e,o,t){const i=cur.getOwnerId(),s=(0,n.domData)(e,"id"),r=t?(0,n.domData)(t,"id"):null,d=o?(0,n.domData)(o,"id"):null;let a=Z._getCurrentSectionType();"album"===a&&(a=Z.getLoc().section.split("_")[1]);const c=Z._getCurrentSectionType(),l=cur.silentLoaded[i][c];if(l){let e=-1,o=-1;if((0,m.each)(l,(function(t,i){const n=i[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+i[VideoConstants.VIDEO_ITEM_INDEX_ID];if(n==s&&(e=t),n==r&&(o=t),o>=0&&e>=0)return!1})),e>=0){const t=l.splice(e,1)[0];o<0?l.unshift(t):(o>e&&o--,l.splice(o+1,0,t)),Z._reindex(l)}}let u=!1;if(cur.is_showcase){if(u=e.classList.contains("VideoCard--first"),!u){const e=document.querySelector(`._video_playlist_${a}_list .VideoCard`);e&&(u=e.getAttribute("data-id")===s)}u&&[...document.querySelectorAll(`._video_playlist_${a}_list .VideoCard`)].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o)}))}ajax.post("al_video.php?act=reorder_videos",{album_id:a,target_id:i,vid:s,before:d,after:r,hash:cur.videoSortHash,ref:window.cur.ref,update_cover:u?1:0},{onDone:function(e,o,t){if(e){const t=document.querySelector(".VideoInfoPanel--playlistPage");t?.classList.toggle("VideoInfoPanel--hasRestriction",o);const i=t.querySelector(".VideoInfoPanel__coverImage");if(i){i.src=e;const n=t.querySelector(".VideoInfoPanel__coverIcon");n&&(n.innerHTML=o?(0,f.getIcon24HideOutline)().icon:"")}}Z._updatePlaylistPanel(t)}})},_updatePlaylistPanel:function(e){if(!e)return;const o=document.getElementById("own_playlist_panel");o&&(o.innerHTML="",o.insertAdjacentHTML("beforeend",e))},_prepareSearchFilters:function(e){return cur.videoSearchFilters={},(0,m.each)(Z.SEARCH_FILTERS,(function(o,t){let i=e[t];(0,l.isString)(i)&&(i=(0,l.htsc)(i)),cur.videoSearchFilters[t]=i})),cur.videoSearchFilters},onFilterRemoved:function(e){Z._setFilterSelector(e),clearTimeout(cur._frto),cur._frto=setTimeout(Z._onFiltersChanged,10)},_setFilterSelector:function(e,o){const t=cur["videoFilter_"+e];let i;return!!t&&("Selector"===t.__className?(void 0===o&&(o=t.options.defaultItems[0][0]),t.selectItem(o,!1),i=(0,m.clone)(t.selectedItems()[0]),i.push(i[0]==t.options.defaultItems[0][0])):(0,n.hasClass)(t,"checkbox")&&((0,n.toggleClass)(t,"on",!!o),i=[!!o,(0,n.data)(t,"title"),!o]),i)},_onFiltersChanged:function(){const e=(0,S.isChecked)("video_fltr_hd"),o=(0,S.isChecked)("video_fltr_notsafe"),t=(0,S.isChecked)("video_fltr_live"),i=cur.videoFilter_len.selectedItems()[0][0],n=cur.videoFilter_date.selectedItems()[0][0],s=cur.videoFilter_order.selectedItems()[0][0];nav.change({hd:!!e&&"1",len:i>0&&i,date:n>0&&n,order:s>=0&&s,notsafe:!!o&&"1",live:!!t&&"1"},!1,{filtersChanged:!0})},initFilters:function(){if(!(0,n.geByClass1)("video_search_input"))return;cur.videoFilter_len=new Dropdown((0,n.ge)("video_fltr_len"),cur.lenFilters,{big:1,zeroPlaceholder:!0,onChange:Z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_date=new Dropdown((0,n.ge)("video_fltr_date"),cur.dateFilters,{big:1,zeroPlaceholder:!0,onChange:Z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_order=new Dropdown((0,n.ge)("video_fltr_order"),cur.orderFilters,{big:1,zeroPlaceholder:!0,onChange:Z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_hd=(0,n.ge)("video_fltr_hd"),(0,I.removeEvent)(cur.videoFilter_hd,"click"),(0,I.addEvent)(cur.videoFilter_hd,"click",Z._onFiltersChanged),(0,n.data)(cur.videoFilter_hd,"title",(0,c.curLang)("video_hd_checkbox")),vk.id&&(cur.videoFilter_notsafe=(0,n.ge)("video_fltr_notsafe"),(0,I.removeEvent)(cur.videoFilter_notsafe,"click"),(0,I.addEvent)(cur.videoFilter_notsafe,"click",Z._onFiltersChanged),(0,n.data)(cur.videoFilter_notsafe,"title",(0,c.curLang)("video_filter_no_safe"))),cur.videoFilter_live=(0,n.ge)("video_fltr_live"),(0,I.removeEvent)(cur.videoFilter_live,"click"),(0,I.addEvent)(cur.videoFilter_live,"click",Z._onFiltersChanged),(0,n.data)(cur.videoFilter_live,"title",(0,c.curLang)("video_filter_live"));const e=Z.getLoc().q;e&&(Z._prepareSearchFilters(Z.getLoc()),cur.searchText=e,Z.inputVal(cur.searchInputEl,cur.searchText),Z.doSearch(e))},_isGeneralSection:function(e){for(let o=0;o<Z.AVAILABLE_TABS.length;o++)if(e==Z.AVAILABLE_TABS[o])return!0;return!1},showMoreShowcase:function(e,o,t=()=>{}){if(!(0,n.isVisible)(o)||(0,S.isButtonLocked)(o))return;(0,S.lockButton)(o);const i={silent_loading:1,next_from:window.cur.listNextFrom,__showcase_session_id:window.cur.showcaseSessionId,unsafe:window.cur.unsafe_filter};"type_for_kids"===e&&Boolean(window.cur.ageFilter)&&(i.age_filter_value=window.cur.ageFilter);const s=window.nav.strLoc;let r;(0,z.isVideoSpaLayoutActive)()&&(r=(0,Q.loadSectionFromCache)(s,i.next_from)),r||(r=ajax.promisifiedPost(s,i,{timeout:3e4})),r.then((r=>{const d="string"!=typeof r[0],{videos:a,playlists:c,nextFrom:u,communities:_,shopping:h,shoppingVideos:v}=d?r:JSON.parse(r);if((0,z.isVideoSpaLayoutActive)()&&!d&&(0,Q.saveSectionInCache)(s,i.next_from,{videos:a,playlists:c,nextFrom:u,communities:_,shopping:h,shoppingVideos:v}),u&&(cur.listNextFrom=u),"type_my_communities"===e)return void Z.showMoreCommunities(_,u,o);if(!(0,l.isEmpty)(h)&&void 0!==h)return void Z.showMoreShopping(v,u,o,t);if(s!==window.nav.strLoc)return;const g=document.getElementById(`video_${e}_list`),p=document.createDocumentFragment(),E=[];if(!(0,l.isEmpty)(a)){for(let o of a){if("type_my_history"===e){const e=o[VideoConstants.VIDEO_ITEM_INDEX_VIEWED_DAY];if(e){if(!document.querySelector(`.VideoGrid__separator[data-date='${e}']`)&&-1===E.indexOf(e)){E.push(e);const o=(0,L.buildDateSeparatorEl)(e);p.appendChild(o)}}}const t=Z.buildVideoEl(o,!0);p.appendChild(t)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...a),window.VideoPlaylist&&window.mvcur)){const e=window.VideoPlaylist.getCurList();e&&(window.VideoPlaylist.addVideosToBlockList(a,!e.reversed,e.reversed),u&&a&&a.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}}if(!(0,l.isEmpty)(c))for(let e of c){const o=Z.buildPlaylistEl(e,!0);p.appendChild(o)}g.appendChild(p),(0,S.unlockButton)(o),u||(0,n.hide)(o),0!==a?.length||u||"type_my_history"!==e||0!==g.childElementCount||document.getElementById("video_empty_placeholder_main")?.classList.remove("VideoEmptyStub--hidden"),"function"==typeof t&&t(),window.VideoShowcase.saveLoggerVideoCards(),window.VideoShowcase.initVideoCardClickListeners(),d&&window.dispatchEvent(new Event("video_legacy_catalog_cache_loaded"))})).catch((()=>{(0,S.unlockButton)(o)}))},showMoreOwnerPlaylists:function(){if(!cur.playlistsNextOffset||cur.loadingAlbums)return;cur.loadingAlbums=!0;const e=document.getElementById("video_all_playlists_list"),o=document.getElementById("ui_all_playlists_load_more");(0,S.lockButton)(o),ajax.post("/video?act=more_owner_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(t,i,s,r)=>{e?.insertAdjacentHTML("beforeend",t),window.VideoShowcase.initPlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),cur.playlistsNextOffset=r,cur.loadingAlbums=!1,(0,S.unlockButton)(o),r||(0,n.hide)(o)},onFail:()=>{cur.loadingAlbums=!1,(0,S.unlockButton)(o)}})},showMoreCommunities:function(e,o,t){const i=document.getElementById("video_type_my_communities_list"),s=document.createDocumentFragment();if(e?.length)for(let o of e)o?.length&&(0,m.each)((0,L.buildCommunityEl)(o),(function(e,o){s.appendChild(o)}));i.appendChild(s),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,S.unlockButton)(t),o||(0,n.hide)(t)},showMoreShopping:function(e,o,t,i){const s=document.querySelectorAll("#video_subtab_pane_type_trends"),r=s[s.length-1].firstElementChild,d=document.createDocumentFragment();for(let o of e){const e=Z.buildVideoEl(o,!0);d.appendChild(e)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...e),window.VideoPlaylist&&window.mvcur)){const t=window.VideoPlaylist.getCurList();t&&(window.VideoPlaylist.addVideosToBlockList(e,!t.reversed,t.reversed),o&&e&&e.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}r.appendChild(d),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,S.unlockButton)(t),o||(0,n.hide)(t),"function"==typeof i&&i()},loadSilent:function(e){e=e||"all";const o=cur.getOwnerId(),t=Z.isInAlbum(e),i=!!cur.isSnippetVideoSelection;if(!t&&!this._isGeneralSection(e)||"albums"==e)return;cur.silentLoaded=cur.silentLoaded||{},cur.silentLoaded[o]=cur.silentLoaded[o]||{},cur.silentLoadingProgress=cur.silentLoadingProgress||{},cur.silentLoadingProgress[o]=cur.silentLoadingProgress[o]||{};const n=cur.silentLoadingProgress[o][e];!0!==n&&cur.pageVideosList&&cur.pageVideosList[o]&&(!1!==n?void 0===n&&(cur.silentLoadingProgress[o][e]=!0,function(e){function n(t,i){cur.silentLoadingProgress&&cur.silentLoadingProgress[o]&&(cur.silentLoadingProgress[o][e]=!1,t&&(t.length&&(cur.indexIndex=t[0].length),Z._reindex(t),cur.silentLoaded[o][e]=t),i&&(cur.albumsPreload[o]=!1,cur.silentLoaded[o].albums=i),Z.indexItems((function(){cur.silentLoadingProgress&&(Z._callPendingAction(e),i&&Z._callPendingAction("albums"),cur.is_showcase?Z.onScroll():Z.showMore(e))})))}const s=cur.pageVideosList[o][e],r=!!s&&cur.videosCount[o][e]<=s.list.length,d=!!t||cur.albumsPreload&&cur.playlistsCount<=cur.albumsPreload[o].length;if(d&&(cur.silentLoaded[o].albums=cur.albumsPreload[o]),r&&d)n(cur.pageVideosList[o][e].list,cur.albumsPreload[o]);else if(cur.noVideos)n([],[]);else{const t=!cur.videosCount||!cur.videosCount[o],s=!cur.playlistsCount;if(t&&s)return n([],[]);const r=cur.VIDEO_SILENT_VIDEOS_CHUNK_SIZE;let a=0;if(cur.videosCount[o]&&cur.videosCount[o][e]){const t=Math.min(cur.videosCount[o][e],cur.VIDEO_SILENT_VIDEOS_MAX_SIZE);a=Math.ceil(t/r)}const c=Math.ceil((cur.playlistsCount||0)/r),l=Math.max(a,c),u=new Array(a);let _=[];const h=()=>{n([].concat.apply([],u),_)},v=new window.callHub(h,l);if(0==l)return n([],[]);let g;for(let t=0;t<l;t++)!function(t){if(cur.serverPaging&&!cur.isCurrentVideoLayer){if(cur.pageVideosList[o]){n(cur.pageVideosList[o].all||[],[])}}else{const n="/al_video.php?act=load_videos_silent",s={oid:o,section:e,rowlen:Z.VIDEOS_PER_ROW,offset:t*r,snippet_video:i?1:0,need_albums:(0,m.intval)(!d&&"all"==e&&(0,m.intval)(0==t))};g=()=>{ajax.post(n,s,{onDone:function(o,i,n){n&&(cur.listNextFrom=n),o&&o[e]&&o[e].list?u[t]=o[e].list:u[t]=[],0==t&&(_=i),v.done()}})},cur.direct_link?(0,O.idlizeCall)(g):g()}}(t)}}(e)):Z._callPendingAction(e))},indexItems:function(e){if(!cur.getOwnerId)return;let o=0;const t=cur.getOwnerId();cur.videoIndexes=cur.videoIndexes||{},cur.videoIndexes[t]=cur.videoIndexes[t]||{},(0,m.each)(cur.silentLoaded[t],(function(e){cur.videoIndexes[t][e]||o++}));const i=new callHub(e,o);(0,N.getIndexerModule)().then((()=>{(0,m.each)(cur.silentLoaded[t],(function(e,o){cur.videoIndexes[t][e]||(cur.videoIndexes[t][e]=new vkIndexer(o,(function(o){return"albums"===e?o[0]:o[VideoConstants.VIDEO_ITEM_INDEX_TITLE]}),(function(){i.done()})))}))}))},_updateSearchPageTitle:function(e){(0,p.curBox)()||(e?(cur.prevVideoPageTitle||(cur.prevVideoPageTitle=document.title),(0,n.setDocumentTitle)((0,c.getLang)("video_title_search").replace("{q}",e))):cur.prevVideoPageTitle&&(0,n.setDocumentTitle)(cur.prevVideoPageTitle))},inputVal:function(e,o){if((0,n.val)(e)==o)return;(0,n.val)(e,o);const t=(0,n.gpeByClass)("_wrap",e);(0,n.toggleClass)(t,"ui_search_field_empty",!o)},doSearch:function(e){if(!cur.searchInputEl)return;const o=(0,m.trim)(e),t=o+Z._buildFiltersSearchStr();if(cur.lastProcessedSearchParams===t)return;cur.videoLocalSearchQuery=o,cur.videoGlobalSearchQuery=o;const i=cur.searchQueryId&&cur.videoSearchTrackCodeForQID?cur.searchQueryId:(0,w.generateQID)();cur.searchQueryId=i,(0,m.each)(Z.SEARCH_FILTERS,(function(e,o){const t=Z._setFilterSelector(o,cur.videoSearchFilters[o]);t&&uiSearch.toggleFilter(cur.searchInputEl,o,t[1],!t[2])})),cur.noEmptyLocalResults=Z.isInCatalog();const s=[Z.VIDEO_SEARCH_TYPE,Z.ALBUM_SEARCH_TYPE,Z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE,Z.VIDEO_GLOBAL_SEARCH_TYPE];Z.isInSearch()&&cur.noEmptyLocalResults&&s.pop(),(0,m.each)(s,(function(e,o){(0,n.hide)("video_subtab_pane_"+o)})),o||Z._toggleSearchContent(!1),(0,p.curBox)()?(0,n.ge)("box_layer_wrap").scrollTop=0:(0,v.scrollToTop)(cur.is_showcase?500:1e3);const r=Z.isInAlbum()?Z.getLoc().section:"all";Z._clearPendingAction(r),Z._updateSearchPageTitle(o),o?(Z._addPendingAction(r,(function(){const e=Z._searchLocally(o);(0,w.saveSearchAttemptStats)(w.serviceVideo,0,e,o,i,0,"0","",w.blockNameOwn),cur.lastProcessedSearchParams=t,e<15&&Z._searchGlobally(o)})),Z.loadSilent(r),Z._searchGlobally(o)):cur.lastProcessedSearchParams=t},getCurrentGlobalSearchKey(){if(!window.cur.searchInputEl)return"";const e=(0,m.trim)((0,n.val)(window.cur.searchInputEl));return e?e+Z._buildFiltersSearchStr():""},isGlobalSearchMode:()=>!!Z.getCurrentGlobalSearchKey(),_searchGlobally:function(e,o){if(!e)return;o=(0,m.intval)(o)||0;const t=cur.searchQueryId,i=o>0;cur.globalSearchResults=cur.globalSearchResults||{};const n=e+Z._buildFiltersSearchStr(),s=cur.globalSearchResults[n];if(!i&&s)return(0,w.saveSearchAttemptStats)(w.serviceVideo,0,s.count,e,t,s.eventBits,"1",s.modelName,w.blockNameSearch,"",s.isAnonym),cur.globalSearchInProgress=!1,Z._showGlobalSearchResults(e),void Z._toggleSearchProgress(!1);if(cur.globalSearchInProgress===e)return;cur.globalSearchInProgress=e;const r=!!cur.isSnippetVideoSelection,d={q:e,offset:o,from:cur.oid,query_id:t};r&&(d.snippet_video=1),cur.videoSearchTrackCodeForQID&&(d.track_code_for_qid=cur.videoSearchTrackCodeForQID,cur.videoSearchTrackCodeForQID=""),i||Z._toggleSearchProgress(!0);const a=Date.now(),c={onDone:function(o,s,r,d,c,l,u,_,h,v,g){if(!i){Z._toggleSearchProgress(!1),cur.lastEventBits=u,cur.lastModelName=_;const i=Date.now()-a;(0,w.saveSearchAttemptStats)(w.serviceVideo,0,o,e,g||t,u,i,_,w.blockNameSearch,"",v),cur.searchQueryId=g}cur.globalSearchInProgress=!1,(0,p.curBox)()&&(c=!1),cur.globalSearchResults=cur.globalSearchResults||{},cur.globalSearchResults[n]=cur.globalSearchResults[n]||{count:0,countHash:s,list:[],realOffset:0,promoPlaylists:c,modelName:_,eventBits:u,playlistTotalCount:h,isAnonym:v};const E=cur.globalSearchResults[n];E.done=E.done||!r.list||0==r.list.length;const m=E.list.length;if(!E.done){const e=r.list[0];let t=0;for(let o=E.list.length-1;o>=0;o--){const i=E.list.length-o;if(i>20)break;const n=E.list[o];if(e[0]==n[0]&&e[1]==n[1]){t=i;break}}E.count=parseInt(o);const i=r.list.slice(t);if(Array.prototype.push.apply(E.list,i),window.VideoPlaylist&&window.mvcur){const e=window.VideoPlaylist.getCurList();e?.id===Z.VIDEO_GLOBAL_SEARCH_TYPE&&(window.VideoPlaylist.addVideosToBlockList(i,!e.reversed,e.reversed),!d&&i&&i.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}const n=E.list.length%Z.VIDEOS_PER_ROW;o>Z.VIDEOS_PER_PAGE&&n&&E.list.length<E.count&&(E.list.splice(-n,Z.VIDEOS_PER_ROW),l-=n),E.realOffset=l}(d||!E.done&&E.list.length==m)&&(E.done=!0),Z._showGlobalSearchResults(e,i)}};cur.is_showcase?(clearTimeout(cur.searhRequestTimeout),cur.searhRequestTimeout=setTimeout((()=>{cur.is_section||ajax.post("/al_video.php?act=search_video",(0,m.extend)(d,cur.videoSearchFilters),c)}),300)):ajax.post("/al_video.php?act=search_video",(0,m.extend)(d,cur.videoSearchFilters),c)},toggleSearchProgress:function(e){Z._toggleSearchProgress(e)},_toggleSearchProgress:function(e){cur.is_showcase||(cur.searchProgressRef=cur.searchProgressRef||0,cur.searchProgressRef=Math.max(0,cur.searchProgressRef+(e?1:-1)),e=cur.searchProgressRef>0);const o=(0,n.geByClass1)("ui_search_fltr_control",(0,n.geByClass1)("video_search_input")),t=(0,n.geByClass1)("ui_search_fltr_progress",o);(0,n.toggle)(t,e),(0,n.hasClass)(o,"shown")||(0,n.toggleClass)((0,n.gpeByClass)("_wrap",cur.searchInputEl),"ui_search_loading",e)},_buildFiltersSearchStr:function(){const e=[];return(0,m.each)(cur.videoSearchFilters||{},(function(o,t){t&&e.push(o+":"+t)})),"$"+e.join("#")},_toggleEmptySearchPlaceholder:function(e,o,t){const i=(0,n.ge)("video_empty_placeholder_search");let s=R.Ranges.isGroupId(cur.getOwnerId())?(0,c.getLang)("video_not_found_group"):(0,c.getLang)("video_not_found_user");if(cur.getOwnerId()==vk.id&&(s=(0,c.getLang)("video_not_found_yours")),Z.isInAlbum()&&(s=(0,c.getLang)("video_not_found_in_album")),Z.isInCatalog()&&(s=(0,c.getLang)("video_not_found_globally")),o){const e=s.replace("{searchText}",'<b class="VideoEmptyStub__token">'+(0,m.clean)(o.replace(/\$/g,"$$$$"))+"</b>");i.classList.contains("VideoEmptyStub")?i.querySelector(".VideoEmptyStub__text").innerHTML=e:i.innerHTML=e}if((0,n.toggle)(i,e),t){let e=!0;const o=(0,n.ge)("video_layout_search");(0,m.each)((0,n.domChildren)(o),(function(){if((0,n.isVisible)(this))return e=!1,!1})),e&&(0,n.toggle)(i,!0)}},_toggleEmptyPlaceholder:function(e,o){const t=(0,n.ge)("video_empty_placeholder_main");o&&e&&t&&(t.classList.contains("VideoEmptyStub")?t.querySelector(".VideoEmptyStub__text").innerHTML=o:t.innerHTML=o),(0,n.toggle)(t,e)},_showSearchResult:function(e){const o=cur.found[e],t=cur.getOwnerId();if((0,n.toggle)("video_subtab_pane_"+e,!!o.count&&!!o.list),o.count){let i="";switch(e){case Z.ALBUM_SEARCH_TYPE:i=Z.isInAlbum()?(0,c.curLang)("video_found_albums_in_album"):R.Ranges.isGroupId(cur.getOwnerId())?(0,c.curLang)("video_found_albums_community"):cur.getOwnerId()==vk.id?(0,c.curLang)("video_found_albums_yours"):(0,c.curLang)("video_found_albums_of");break;case Z.VIDEO_SEARCH_TYPE:i=Z.isInAlbum()?(0,c.curLang)("video_found_videos_in_album"):R.Ranges.isGroupId(cur.getOwnerId())?(0,c.curLang)("video_found_videos_community"):cur.getOwnerId()==vk.id?(0,c.curLang)("video_found_videos_yours"):(0,c.curLang)("video_found_videos_of");break;case Z.VIDEO_GLOBAL_SEARCH_TYPE:i=cur.is_showcase?(0,c.getLang)("video_found_videos"):(0,c.curLang)("video_found_videos_global");break;case Z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:i=cur.is_showcase?(0,c.getLang)("video_search_playlists"):(0,c.getLang)("video_search_promo_playlists")}i=(0,c.langNumeric)(o.count,i,!0),i=i.replace("{user}",(0,c.curLang)("video_owner_name_gen"));const s=(0,n.ge)("video_subtab_pane_"+e),r=(0,n.geByClass1)("js-video-subtitle",s);if((0,n.val)(r,i),cur.is_showcase&&o.count){const e=(0,n.geByClass1)("js-video-subtitle-counter",s);(0,n.val)(e,(0,c.langNumeric)(o.count,"%s",!0))}let d=e==Z.VIDEO_GLOBAL_SEARCH_TYPE?cur.videoGlobalSearchQuery:cur.videoLocalSearchQuery;d+=Z._buildFiltersSearchStr(),cur._videoRenderedSearchResults=cur._videoRenderedSearchResults||{};const a=cur._videoRenderedSearchResults;a[e]!=d&&(a[e]=d,(0,n.ge)("video_"+e+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[t]&&delete cur.videoShowWindow[t][e],Z.showMore(e))}},_showGlobalSearchResults:function(e,o){const t=e+Z._buildFiltersSearchStr(),i=cur.getOwnerId(),n=Z.isInAlbum()?Z.getLoc().section:"all",s=cur.is_showcase||!!cur.silentLoaded[i][n];if((e==cur.videoGlobalSearchQuery||e==cur.videoLocalSearchQuery)&&s&&cur.globalSearchResults[t]&&cur.globalSearchResults[t].count>=0){const i=cur.globalSearchResults[t];cur.found[Z.VIDEO_GLOBAL_SEARCH_TYPE]={list:i.list,count:i.count,done:i.done,realOffset:i.realOffset},cur.found[Z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE]={list:i.promoPlaylists,count:i.playlistTotalCount||i.promoPlaylists.length,done:!i.promoPlaylists.length},cur.noEmptyLocalResults&&(Z._toggleSearchContent(!0),0==i.count?Z._toggleEmptySearchPlaceholder(!0,e):Z._toggleEmptySearchPlaceholder(!1)),o||(Z._showSearchResult(Z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE),Z._showSearchResult(Z.VIDEO_GLOBAL_SEARCH_TYPE)),Z._callPendingAction(Z.VIDEO_GLOBAL_SEARCH_TYPE)}},_toggleSearchContent:function(e){(0,n.toggle)("video_layout_contents",!e),(0,n.toggle)("video_layout_search",!!e),cur.is_showcase&&(0,n.toggle)("video_block_header",!e)},setVisibilityShowcaseContent:function(e){(0,n.toggle)("video_main_block",e)},_searchLocally:function(e){if(cur.found={},!e||!cur.videoIndexes)return!1;const o=cur.getOwnerId(),t=[];let i=[];!Z.isInAlbum()&&cur.videoIndexes[o].albums&&(i=cur.videoIndexes[o].albums.search(e),cur.found[Z.ALBUM_SEARCH_TYPE]={list:i,count:i.length},Z._showSearchResult(Z.ALBUM_SEARCH_TYPE));const n=Z.isInAlbum()?Z.getLoc().section:"all";if(cur.videoIndexes[o][n]){const i=cur.videoIndexes[o][n].search(e);(0,m.each)(i,(function(e,o){(!cur.videoSearchFilters.hd||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_HD)&&(!cur.videoSearchFilters.live||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_LIVE)&&(Date.now()/1e3-o[VideoConstants.VIDEO_ITEM_INDEX_DATE]>cur.videoSearchFilters.date||cur.videoRecentlyRemoved&&cur.videoRecentlyRemoved[(0,H.joinRawId)({ownerId:o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID],itemId:o[VideoConstants.VIDEO_ITEM_INDEX_ID]})]||t.push(o))})),cur.found[Z.VIDEO_SEARCH_TYPE]={list:t,count:t.length},Z._showSearchResult(Z.VIDEO_SEARCH_TYPE)}return i.length+t.length?(Z._toggleSearchContent(!0),Z._toggleEmptySearchPlaceholder(!1)):cur.noEmptyLocalResults?Z._toggleEmptySearchPlaceholder(!1,void 0,!0):(Z._toggleSearchContent(!0),Z._toggleEmptySearchPlaceholder(!0,e)),Z._toggleSearchProgress(!1),t?t.length:0},onItemEnter:function(e){(0,n.setTitle)(e,e)},showMoreAlbums:function(e){let o=!1;const t=cur.getOwnerId();cur.albumsPreload&&cur.albumsPreload[t]&&!cur.silentLoaded[t].albums&&(cur.silentLoaded[t].albums=cur.albumsPreload[t],o=!0),cur.albumsShowingAll[t]=!0,Z.showMore("albums",e),o&&(cur.silentLoaded[t].albums=!1)},prepareVideoItemAttrs:function(e){let o="",t="";const i={};i[VideoConstants.VIDEO_ITEM_FLAG_EXTERNAL]="video_ext",i[VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE]="video_active_live",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT]="video_can_edit",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DOWNLOAD]="video_can_download",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD]="video_can_add",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE]="video_can_delete",i[VideoConstants.VIDEO_ITEM_FLAG_NO_AUTOPLAY]="video_nap",i[VideoConstants.VIDEO_ITEM_FLAG_ADDED]="VideoCard--videoAdded",i[VideoConstants.VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD]="video_skip_thumb_load",i[VideoConstants.VIDEO_ITEM_FLAG_DELETED]="video_deleted",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY]="VideoCard--history",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE]="VideoCard--private",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_MEMBERS]="VideoCard--privateMembers",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_BY_LINK]="VideoCard--privateByLink",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED]="VideoCard--privateNotPublished",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_MOVE]="video_can_edit_albums",i[VideoConstants.VIDEO_ITEM_FLAG_HORIZONTAL]="VideoCard--horizontal",i[VideoConstants.VIDEO_ITEM_FLAG_INTERACTIVE]="VideoCard--interactive";const n=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS],s=e[VideoConstants.VIDEO_ITEM_INDEX_LINK],r=s&&s.includes("clip");(0,m.each)(i,(function(e,t){n&e&&(o+=t+" ")})),n&VideoConstants.VIDEO_ITEM_FLAG_SCHEDULED&&(o+=" VideoCard--scheduled"),n&VideoConstants.VIDEO_ITEM_FLAG_UPCOMING_LIVE&&(o+=" VideoCard--upcomingLive"),e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM]||e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]||n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE||(o+=" video_no_duration"),n&VideoConstants.VIDEO_ITEM_FLAG_PRIVATE||!r||(o+=" ShortVideoGridItem__removePrivate"),cur.is_showcase&&n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(o+=" video_no_duration"),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]||(o+=" no_date");const d=e[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];d&&d.explicit&&(o+=" video_explicit");const a=!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT||n&VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE),c=e[VideoConstants.VIDEO_ITEM_INDEX_BLOCKED],l=!(0,M.isVideoStandalone)()&&!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD);return a&&(l||c)&&(o+=" video_no_actions"),a&&r&&(o+=" ShortVideoGridItem__noActions"),c&&(o+=" video_blocked"),cur.videoCanAddAlbums&&!c&&(o+=" video_can_edit_albums"),cur.isSnippetVideoSelection&&(o+=" no_video_select_btn"),n&VideoConstants.VIDEO_ITEM_FLAG_NEED_SIGN_IN&&(t+=' rel="nofollow"'),[o,t]},buildVideoEl:function(e,o=!1,t=!1){return(0,L.buildVideoEl)(e,o)},buildPlaylistEl:function(e,o=!1){return(0,L.buildPlaylistEl)(e,o)},addShowMoreButton:function(e,o){if(!e||!o||0===o.length)return;const t=(0,n.ce)("div",{className:(Z.showMoreClassNames||"").replace("%type%",o),innerHTML:(0,c.curLang)("video_show_more")});return e.parentNode.append(t),t.onClick=Z.showMore(o,t),t},onMoreLoaded:function(e,o,t,i,s){Z._loading=!1;const r=cur.getOwnerId(),d=cur.videoShowWindow[r][o],a=(0,n.ge)("video_"+o+"_list"),c=(0,n.gpeByClass)("ge_video_pane",a),l=a.classList.contains("VideoGrid");let u;if(a){e=(0,n.geByClass1)("ui_load_more_btn",c);const _=o.indexOf("albums")>=0,h=_?0:3;let v=Z._getCurrentSectionType();v="album"==v?Z.getLoc().section:"all";let g=!1;o.indexOf("search")>=0&&cur.videoIndexes&&cur.searchText&&(g=new RegExp("("+cur.searchText.replace(/\|/g,"").replace(cur.videoIndexes[r][v]?.delimiter,"|").replace(/^\||\|$/g,"").replace(/([\+\*\)\(])/g,"\\$1")+")","gi"));for(let e=0,i=t.length;e<i;e++){const i=(0,m.extend)({},t[e]);g&&!l&&(i[h]=i[h].replace(g,"<em>$1</em>")),u=_?Z.buildPlaylistEl(i,l):Z.buildVideoEl(i,l),o==Z.VIDEO_GLOBAL_SEARCH_TYPE&&u.setAttribute("data-search-pos",e+d.offset),a.appendChild(u)}!e&&!s&&!d.done&&i>d.offset&&(e=Z.addShowMoreButton(a,v)),d.offset=i,d.done=!t.length||s,(0,n.toggle)(e,!d.done),cur.is_showcase&&c.classList.toggle("VideoPane--noMore",d.done),o==Z.VIDEO_GLOBAL_SEARCH_TYPE&&(cur.videoSearchStats||Z._initSearchStats(Z.getLoc()),cur.videoSearchStats.lastActionTime=Date.now(),Z._updateLastSeenElement(a))}},showMore:function(e,o){e=e||Z._getCurrentSectionType();const t=(0,p.curBox)()?(0,p.curBox)().bodyNode:void 0,i=(0,n.geByClass1)("_video_"+e+"_list",t);if(!i)return;const s=Z.isInAlbum(e),r=cur.getOwnerId();if((s||-1!=Z.AVAILABLE_TABS.indexOf(e))&&!cur.silentLoaded[r][e])return void((0,S.isButtonLocked)(o)||(Z._addPendingAction(e,(function(){Z.showMore(e,o)})),(0,S.lockButton)(o)));let d;(0,S.unlockButton)(o),cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[r]=cur.videoShowWindow[r]||{},cur.videoShowWindow[r][e]||(cur.videoShowWindow[r][e]={done:!1,offset:i.children.length});const a=cur.videoShowWindow[r][e];if(!a.done)if(e.indexOf("search")>=0&&cur.found[e]){let t,s,r;if(e===Z.VIDEO_GLOBAL_SEARCH_TYPE){if(d=cur.found[e].list.length,t=cur.found[e].realOffset||d,s=cur.found[e].list.slice(a.offset,d),r=cur.found[e].done,!r&&0===s.length)return Z._addPendingAction(e,(function(){Z.showMore(e,o)})),(0,S.lockButton)(o),void(cur.globalSearchInProgress||Z._searchGlobally(cur.videoGlobalSearchQuery,t))}else if(e===Z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE){const t=0===a.offset,i=(0,n.ge)("video_"+e+"_list"),c=i.classList.contains("VideoGrid");if(!t)return(0,S.lockButton)(o),void Z.showMorePlaylist(cur.videoGlobalSearchQuery,a.offset,((t,n,s)=>{c&&i.classList.remove("VideoGrid--oneRow"),(0,S.unlockButton)(o),Z.onMoreLoaded(o,e,n,s,t)}));d=cur.found[e].list.length,s=cur.found[e].list,r=d>=cur.found[e].count,c&&i.classList.add("VideoGrid--oneRow")}else if(cur.is_showcase&&e===Z.ALBUM_SEARCH_TYPE){if(0===a.offset){d=Z._getNumberOfVideoGridColumns()||Z.PLAYLIST_FIRST_CHUNK_SIZE,s=cur.found[e].list.slice(0,d);const o=cur.found[e].list.length-d;if(o>0){r=!1;const e=(0,n.geByClass1)("ui_load_more_btn",(0,n.gpeByClass)("ge_video_pane",i));if(e){const t=(0,c.curLang)("video_show_more_playlists").map((e=>e.replace("%s",'<span class="VideoShowMoreButton__counter">%s</span>')));e.innerHTML=(0,c.langNumeric)(o,t)}}else r=!0}else(0,n.ge)("video_"+e+"_list").classList.remove("VideoGrid--oneRow"),s=cur.found[e].list.slice(a.offset,cur.found[e].list.length),r=!0}else d=a.offset+Z.VIDEOS_PER_PAGE,s=cur.found[e].list.slice(a.offset,d),r=d>=cur.found[e].list.length;Z.onMoreLoaded(o,e,s,d,r)}else if((s||-1!=Z.AVAILABLE_TABS.indexOf(e))&&cur.silentLoaded[r][e]){const t=cur.silentLoaded[r][e];if(!d&&!t.length)return cur.is_showcase?void(0,n.hide)(o):void Z._toggleEmptyPlaceholder(!0,(0,c.getLang)("video_no_videos_here_yet"));d=Math.min(t.length,a.offset+Z.VIDEOS_PER_PAGE);const i=t.slice(a.offset,d);let s;if("albums"===e&&cur.albumsPreload[r])s=cur.albumsNoMore,cur.albumsPreload[r]=!1;else{s=d>=t.length;const e=Math.ceil(d,Z.VIDEOS_PER_PAGE);if(window.cur.unauthScrollMoreBox){const{ownerId:o,screens:t}=window.cur.unauthScrollMoreBox;e>t&&Z.getCurOwnerId()===o&&(window.cur.unauthScrollMoreBox.needShow=!0,s=!0)}}"albums"===e&&(cur.albumsShowingAll[r]=!s),Z.onMoreLoaded(o,e,i,d,s)}Z._updateThumbsInView()},showMorePlaylist:function(e,o,t){ajax.post("/al_video.php?act=search_video_playlist",{q:e,offset:o,query_id:cur.searchQueryId},{onDone:function(e,o,i){t(e,o,i)}})},isInAlbum:function(e){return 0===(e=e||Z.getLoc().section||"").indexOf("album_")||0===e.indexOf("playlist_")},isInSearch:function(){return!!Z.getLoc().q},_getSectionAlbumId:function(){const e=Z.getLoc().section||"all";switch(e){case"all":return-2;case"uploaded":return-1;default:return e.split("_")[1]}},isInCatalog:function(e){return e=e||Z.getLoc(),cur.is_showcase?!cur.isOwnerVideos&&!(0,m.inArray)(e.section,Z.USER_SYSTEMS_ALBUM_TYPES):"video"===e[0]&&!e.section},_getCurrentSectionType:function(){return cur.videoForcedSection?cur.videoForcedSection:Z.isInAlbum(Z.getLoc().section)?"album":Z.isInCatalog()?"catalog":Z.getLoc().section||"all"},_getNumberOfVideoGridColumns:function(){const e=document.querySelector(".VideoLayout__contentsWrapper"),o=document.querySelector(".VideoLayout__contents .VideoGrid");let t,i;if(o){t=o.offsetWidth||e.offsetWidth;const n=getComputedStyle(o);i=parseInt(n.getPropertyValue("column-gap"),10)}else t=e.offsetWidth,i=12;return Math.floor((t+i)/(300+i))},onScroll:function(){if("upload"===Z.getLoc().section)return;let e;cur.getOwnerId&&cur.albumsShowingAll[cur.getOwnerId()]?e="albums":(e=Z._getCurrentSectionType(),Z.getLoc().q||"search"===e?e=(0,n.isVisible)((0,n.gpeByClass)("ge_video_pane","ui_search_global_videos_load_more"))?Z.VIDEO_GLOBAL_SEARCH_TYPE:Z.VIDEO_SEARCH_TYPE:"album"===e?e=Z.getLoc().section:cur.showcaseSection&&(e=cur.showcaseSection));const o=(0,p.curBox)()?(0,p.curBox)().bodyNode:void 0,t=(0,n.geByClass1)("_video_"+e+"_list",o);if(t&&"all_playlists"!==e){const o=(0,n.gpeByClass)("ge_video_pane",t),i=(0,n.geByClass1)("ui_load_more_btn",o);if(i){const o=(0,n.clientHeight)(),t=(0,g.scrollGetY)(),s=(0,n.getXY)(i);let r=cur.serverPaging?s[1]-o:s[1]-o/2;((0,Q.hasSectionInCache)(window.nav.strLoc,window.cur.listNextFrom)||t+o>r)&&(cur.serverPaging&&cur.showcaseSection===e?Z.showMoreShowcase(e,i,(()=>{Z._updateThumbsInView(),Z._loadNextChunkIfNeed()})):Z.showMore(e,i))}e===Z.VIDEO_GLOBAL_SEARCH_TYPE&&Z._updateLastSeenElement(t)}else if("all_playlists"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){const e=(0,n.clientHeight)(),o=document.body.clientHeight;(0,g.scrollGetY)()+e>o-e/2&&Z.showMoreOwnerPlaylists()}Z._updateChooseFixedBottom(),Z._updateThumbsInView()},_createSorters:function(e){if(!cur.videoCanSort)return;cur.videoSorter&&cur.videoSorter.destroy(),"album"===(e=e||Z._getCurrentSectionType())&&(e=Z.getLoc().section);const o=cur.is_showcase?"VideoCard--dragOver":"video_on_drag_over";(0,N.getGridSorterModule)().then((()=>{cur.videoSorter=new window.GridSorter((0,n.ge)("video_"+e+"_list"),"video_item__thumb_link",{onReorder:Z._onReorder,onDragOverElClass:"js-video_playlist_item",onDragLeave:function(e,t){(0,n.removeClass)(e,o),(0,n.removeClass)(t,"video_on_drag_over")},onDragEnter:function(e,t){(0,n.addClass)(e,o),(0,n.addClass)(t,"video_on_drag_over")},onDragDrop:function(e,o){const t=(0,n.attr)(o,"data-id").split("_"),i=(0,n.attr)(e,"data-id");return ajax.post("/al_video.php?act=a_add_to_playlist",{oid:t[0],vid:t[1],gid:R.Ranges.isGroupId(cur.getOwnerId())?R.Ranges.convertGroupIdToOwnerId(cur.getOwnerId()):0,add:1,playlist_id:i,own:1,hash:cur.videoAddToPlaylistOwnHash},{onDone:function(o,t){if(t&&t[i]){const o=Z.buildPlaylistEl(t[i],cur.is_showcase);(0,n.domPN)(e).replaceChild(o,e),Z._reinitSorters(),cur.albumsSorter.update()}}}),!0}})}))},_reinitSorters:function(e){cur.videoCanSort&&(clearTimeout(cur._rsto),cur._rsto=setTimeout((function(){cur.videoSorter?e?cur.videoSorter.disable():cur.videoSorter.enable():Z._createSorters()})))},_saveHistoryAction:function(e,o){if(Z.isInSearch()&&cur.videoGlobalSearchQuery){const t=cur.videoGlobalSearchQuery+Z._buildFiltersSearchStr(),i=cur.globalSearchResults[t];i&&!cur.videoSearchFilters.notsafe&&uiSearch.saveHistorySearch(this.searchInputEl,cur.videoGlobalSearchQuery,e,o,i.count,i.countHash)}},onVideoAdd:function(e,o,t,s,r){const d=o?.closest("._video_item"),a=d?.classList?.contains("VideoCard");if(a)return;const l=(0,m.intval)((0,n.toggleClass)(d,"VideoCard--videoAdded"));let u;return u=l?{playlist_id:B.MY_VIDEO_ALBUM_ID}:{playlists:0},Z._saveHistoryAction(t,s),ajax.post("/al_video.php?act=a_add_to_playlist",(0,m.extend)({oid:t,vid:s,add:(0,m.intval)(l),hash:r},u),{onFail:function(){l&&(window.tooltips&&tooltips.destroyAll(),(0,n.removeClass)(d,"VideoCard--videoAdded"))},onDone:function(o,r,d){const a=cur.currentSortings&&(!cur.currentSortings.all||"default"===cur.currentSortings.all),u=!!cur._preloadedPages&&(0,n.geByClass1)("_video_list_my_all",cur._preloadedPages.all);let _,h=!1;if(_=l?(0,c.getLang)("video_added_to_section"):(0,c.getLang)("video_deleted_from_section"),(0,E.showSnackbar)({text:_,before:{content:(0,i.jsx)(G.Icon28ListCheckOutline,{})},action:{label:`«${(0,c.getLang)("video_catalog_showcase_section_my_video_added_title")}»`,onClick:()=>window.location.href=(0,B.getPlaylistURL)(t,B.MY_VIDEO_ALBUM_ID)}}),u){const e=(0,n.geByClass1)("ge_video_item_"+t+"_"+s,u);e&&(0,n.re)(e),h=!!e,l&&a&&u.insertBefore(Z.buildVideoEl(d,cur.is_showcase),u.firstChild)}if(cur.silentLoaded&&cur.silentLoaded[vk.id]&&cur.silentLoaded[vk.id].all){const e=cur.silentLoaded[vk.id].all;if(l)a&&(e.unshift(d),Z._reindex(e));else for(let o=0,i=e.length;o<i;o++)if(e[o][0]==t&&e[o][1]==s){e.splice(o,1);break}if(cur.videosCount[vk.id]){let e=l?1:-1;1===e&&h&&(e=0);const o=cur.videosCount[vk.id].all=Math.max(0,(cur.videosCount[vk.id].all||0)+e);Z.updateTabCounter(o)}}const v=(0,k.getTrackCodeFromElement)(e?.target);(0,k.logEvent)({action:l?k.SearchClickActionMap.ADD_TO_ME:k.SearchClickActionMap.REMOVE_FROM_ME,track_code:v,type:k.EventItemType.VIDEO})}}),window.tooltips&&tooltips.destroyAll(),(0,I.cancelEvent)(e)},updateTabCounter:function(e){const o=(0,n.ge)("video_tab_all");if(o){(0,n.geByClass1)("ui_tab_count",o).innerHTML=e}},onVideoMove:function(e,o,t,i,n){return(0,u.showBox)("/al_video.php?act=video_playlists_box",{target_id:cur.getOwnerId(),oid:t,vid:i,hash:n},{stat:[window.jsc("web/indexer.js")]}),(0,I.cancelEvent)(e)},_showProgressPanel:function(e){const o=(0,n.se)('<div class="video_delete_progress _video_delete_progress VideoCard__deleteProgress"><div class="round_spinner"></div></div>');return e.appendChild(o),o},onVideoDelete:function(e,o,i,s,r,d=!1){const a=(0,n.gpeByClass)("_video_item",o);if(!a)return;const c=Z._getCurrentSectionType(),l="album"===c?Z._getSectionAlbumId():-2;let u=Z._showProgressPanel(a);a.classList.add(a.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),cur.videoRecentlyRemoved||(cur.videoRecentlyRemoved={}),cur.videoRecentlyRemoved[i+"_"+s]=!0;const _=(0,H.joinRawId)({itemId:s,ownerId:i}),h=l===B.MY_VIDEO_ALBUM_ID||l===B.UPLOADED_ALBUM_ID,v=()=>{u?.remove(),cur.section_id===B.SECTION_MY_BOOKMARKS&&(0,F.showWatchLaterSnackbar)({isBookmarked:!1}),cur.section_id!==B.SECTION_MY_BOOKMARKS&&cur.section_id!==B.SECTION_MY_LIKED&&cur.videoRecentlyRemoved[_]},g=()=>{const e=a.querySelector("._video_restore");u=Z._showProgressPanel(a),e?.remove(),a.classList.remove(a.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now")},p=()=>{const e=(0,L.buildVideoRestorationEl)(s,i,d,cur.section_id,cur.is_showcase,h);e&&(u.remove(),a.appendChild(e),d&&c!==B.SECTION_MY_CLIPS||Promise.all([t.e(73538),t.e("langs/web/video_restore_button")]).then(t.bind(t,69727)).then((({initVideoRestoreButton:e,unmountVideoRestoreButton:o})=>{if(a.classList.contains("video_deleted"))return;const t=(0,H.joinRawId)({itemId:s,ownerId:i}),r=document.getElementById(`video-restore-button-widget-${t}`),c={videoId:+s,ownerId:+i,targetId:cur.oid,playlistId:l,section:cur.section_id,onRestore:v,onClick:g,isShort:d};let u=(0,n.data)(a,"restoreTO");e(r,c),clearTimeout(u),u=setTimeout((()=>{o(r)}),6e4),(0,n.data)(a,"restoreTO",u)})))};return cur.section_id===B.SECTION_MY_BOOKMARKS?((0,W.removeVideoFromBookmarks)({id:s,owner_id:i}).then((()=>{p(),(0,F.showWatchLaterSnackbar)({isBookmarked:!0,rollbackCallback:()=>{g(),(0,W.addVideoToBookmarks)({id:s,owner_id:i}).then(v)}})})),(0,I.cancelEvent)(e)):cur.section_id===B.SECTION_MY_LIKED?((0,W.removeVideoFromLikes)({item_id:s,owner_id:i,type:"video"}).then(p),(0,I.cancelEvent)(e)):(h?d?(0,W.removeShortVideo)({video_id:s,owner_id:i}).then(p):(0,W.removeVideoFromMy)({video_id:s,owner_id:i,target_id:cur.oid}).then(p):(0,W.removeVideoFromAlbum)({video_id:s,owner_id:i,album_id:l,target_id:cur.oid}).then(p),(0,I.cancelEvent)(e))},restoreVideo:function(e,o,t,i){const s=(0,n.gpeByClass)("_video_item",e),r=s.querySelector("._video_restore"),d=Z._showProgressPanel(s);if((0,n.re)(r),"my_bookmarks"===cur.section_id){let e=o.split("_");return(0,n.removeClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,n.re)(d),(0,F.showWatchLaterSnackbar)({isBookmarked:!1}),void window.bookmark(e[0],e[1],"video",i,!1,"","","",0,U.FAVORITE_SOURCES.SNACKBAR)}if("my_liked"!==cur.section_id)delete cur.videoRecentlyRemoved[o];else{(0,n.removeClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,n.re)(d);const t=()=>window.Likes.toggle(e,!1,"video"+o,i);window.Likes?t():window.stManager.add([window.jsc("web/likes.js")]).then(t)}},onVideoUMA:function(e,o,t,i){return(0,u.showBox)("al_video.php?act=get_uma_restrictions",{oid:t,vid:i},{params:{width:750}}),(0,I.cancelEvent)(e)},onVideoEdit:function(e,o,t,i,s=!1){if(cur.videoEditItem=(0,n.gpeByClass)("_video_item",o),window.Videoview&&Videoview.hidePlayer(),(0,P.isToggleEnabled)("video_new_video_edit_modal")&&!s)return void(0,q.showNewVideoEditModal)({ownerId:t,videoId:i,entryPoint:"my-videos",analyticEventSubtype:$.VideoEditActionEventSubTypes.MY_VIDEOS});return(0,u.showBox)("al_video.php?act=edit_box",{vid:i,oid:t,is_short_video:+s},{containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css","video_edit.css",window.jsc("web/videoview.js"),window.jsc("web/video_upload.js"),window.jsc("web/upload.js")]}).setOptions({onHide:function(){window.Videoview&&Videoview.showPlayer()}}),(0,I.cancelEvent)(e)},switchChooserToOwner:function(e){const o={to_id:e,switched:1};!!cur.isSnippetVideoSelection&&(o.snippet_video=1),o.from=cur.chooseParams?.from||"",boxQueue.hideLast(),(0,u.showBox)("al_video.php?act=a_choose_video_box",o,{cache:1})},chooseBoxBack:function(){cur.videoChoosePrevSection=cur.videoChoosePrevSection||"all",0==cur.videoChoosePrevSection.indexOf("album_")&&(cur.videoChoosePrevSection="albums"),nav.go("/videos?section="+cur.videoChoosePrevSection)},initChooseBox:function(e,o,t,i,s,r,d,l){if(arguments.length>0)this.initChooseBoxOptions={isNoteEdit:e,isReview:o,toMail:t,curOwnerId:i,defaultTitle:s,blockPersonal:r,isSnippetVideo:d};else{if(!this.initChooseBoxOptions)return;e=this.initChooseBoxOptions.isNoteEdit,o=this.initChooseBoxOptions.isReview,t=this.initChooseBoxOptions.toMail,i=this.initChooseBoxOptions.curOwnerId,s=this.initChooseBoxOptions.defaultTitle,r=this.initChooseBoxOptions.blockPersonal,d=this.initChooseBoxOptions.isSnippetVideo}cur.found={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.chosenVideos=cur.chosenVideos||[],cur.albumsShowingAll={},cur.isNoteEdit=e,cur.videoShowWindow={},cur.isSnippetVideoSelection=d;const u=(0,p.curBox)(),_=cur.getOwnerId;function h(){u.setOptions({width:631,bodyStyle:"padding: 0",hideButtons:!0}),(0,n.ge)("box_layer_wrap").scrollTop=0}function v(){(0,m.each)(Z.AVAILABLE_TABS,(function(e,o){(0,n.hide)("video_subtab_pane_"+o)})),(0,n.hide)((0,n.geByClass1)("video_subtab_pane_album"))}function g(){u.setOptions({title:'<div class="back" onclick="Video.chooseBoxBack();"><span class="back__icon">'+(0,C.getIcon24BrowserBack)().icon+"</span>"+(0,c.getLang)("video_choose_box_back_to_videos")+"</div>",bodyStyle:"padding: 0",noRefreshCoords:1})}function E(){let e=s;if(!r&&!o&&cur.videoSwitchOwnerId){const o=i==vk.id?(0,c.getLang)("video_choose_wall_to_group_videos"):(0,c.getLang)("video_choose_wall_to_my_videos");e+='<span class="divider">|</span><a class="toggle" onclick="Video.switchChooserToOwner('+(i==vk.id?cur.videoSwitchOwnerId:vk.id)+')">'+o+"</a>"}u.getOptions().defaultTitle&&(e=u.getOptions().defaultTitle),u.setOptions({title:e,grey:o})}function S(){(0,p.curBox)()&&(0,m.each)((0,n.geByClass)("video_item",(0,p.curBox)().bodyNode),(function(){const e=(0,n.geByClass1)("media_check_btn_wrap",this),o=this.getAttribute("data-id");(0,n.toggleClass)(e,"checked",-1!=cur.chosenVideos.indexOf(o))}))}cur.getOwnerId=function(){return i},u.setOptions({onHideAttempt:function(){return cur.getOwnerId=_,cur.chosenVideos=[],!0}}),cur.nav.push((function(e,o,t,s){if(!s.filtersChanged&&1===Object.keys(t).length&&t[0]&&0!=t[0].indexOf("video")&&!s.fromSearch)return!0;if(e[0]&&!e.section&&t[0]!=="videos"+i)return!0;(0,n.hide)("global_prg");const r=(0,n.geByClass1)("video_default_tabs",u.bodyNode),d=(0,n.geByClass1)("video_subtab_pane_album",u.bodyNode);let c=e.section||"all";Z._prepareSearchFilters(t);const l=e.section?"":t.q||(0,n.val)(cur.searchInputEl);if(l?(c="search",s.fromSearch||s.globalQuery||(s.globalQuery=l),Z.doSearch(l),g(),Z._updateChooseFixedBottom()):(Z.inputVal(cur.searchInputEl,""),Z.doSearch("")),cur.videoForcedSection=c,-1!==Z.AVAILABLE_TABS.indexOf(c))v(),(0,n.show)("video_subtab_pane_"+c),(0,n.show)(r),(0,n.hide)("albumPane"),E(),h(),cur.videoChoosePrevSection=c,"albums"!==c&&Z.loadSilent(c),Z._updateChooseFixedBottom(),Z.updateEmptyPlaceholder(c);else if(c&&0==c.indexOf("album_")){const e=c.split("_")[1];(0,a.showGlobalPrg)((0,n.ge)("video_playlist_item_"+e),{cls:"progress_inv_img",w:46,h:16,shift:[0,-22],zIndex:1e3}),Z._addPendingAction(c,(function(){g(),v(),(0,n.hide)("global_prg"),(0,n.hide)(r),d.id="video_subtab_pane_"+c;const e=(0,n.geByClass1)("video_items_list",d);e.id="video_"+c+"_list",(0,n.addClass)(e,"_video_"+c+"_list"),e.innerHTML="",(0,n.show)(d);const o=cur.getOwnerId();cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[o]=cur.videoShowWindow[o]||{},cur.videoShowWindow[o][c]=!1,Z.showMore(c,(0,n.geByClass1)("ui_load_more_btn",(0,n.ge)("video_subtab_pane_album"))),h(),S(),Z._updateChooseFixedBottom()})),cur.videoChoosePrevSection=c,Z.loadSilent(c)}return S(),!1})),cur.chooseVideoToMail=t,cur.isCurrentVideoLayer=!0,Z.loadSilent(l),h(),(0,I.addEvent)((0,n.ge)("box_layer_wrap"),"scroll",Z.onScroll);const w=boxLayerWrap.scrollTop;(0,n.elfocus)((0,n.geByClass1)("_scroll_node",u.bodyNode)),boxLayerWrap.scrollTop=w,Z.initSearch(),E(),o||(cur.chooseVideoMedia=function(e,o,t){let i,s=e;if((0,n.hasClass)(s,"media_check_btn_wrap")?cur.cancelClick=!0:s=(0,n.geByClass1)("media_check_btn_wrap",s),(i=cur.chosenVideos.indexOf(o))>=0)cur.chosenVideos.splice(i,1);else{if(cur.chosenVideos.length>=(cur.maxFiles||10))return;cur.chosenVideos.push(o)}const r="true"===s.dataset.selected;if(s.setAttribute("data-selected",!r),(0,n.toggleClass)(s,"checked"),1===cur.chosenVideos.length&&!t)return Z.doAttachSelectedVideos(e),!1;const d=(0,n.ge)("video_choosebox_bottom");if(cur.chosenVideos.length>0){(0,n.show)(d);const e=cur.chooseVideoAdd?(0,c.curLang)("video_add_videos"):(0,c.curLang)("global_attach_videos"),o=d?.querySelector(".video_choosebox_attach_btn");o&&T.FlatButton.setLabel(o,(0,c.langNumeric)(cur.chosenVideos.length,e)),Z._updateChooseFixedBottom()}else(0,n.hide)(d);return(0,n.toggleClass)((0,n.ge)("video_choose_box"),"with_bottom_fixed",(0,n.isVisible)(d)),!1}),window.uiScrollBox&&window.uiScrollBox.init((0,p.curBox)(),{onHide:function(){(0,n.hide)("global_prg"),cur.nav.pop(),(0,I.removeEvent)((0,n.ge)("box_layer_wrap"),"scroll",Z.onScroll),cur.isCurrentVideoLayer=!1,cur.chooseVideoMedia=null},onShow:function(){Z.initChooseBox()}})},doAttachSelectedVideos:function(e){T.FlatButton.isFlatButton(e)?T.FlatButton.lock(e):(0,a.showGlobalPrg)((0,n.geByClass1)("video_item_thumb_wrap",e)||e,{cls:"progress_inv_img",w:46,h:16,zIndex:1e3});const o=function(){T.FlatButton.isFlatButton(e)&&T.FlatButton.unlock(e),(0,n.hide)("global_prg"),cur.chooseVideoAdd&&(cur.chosenVideos=[])};if(cur.chooseVideoAdd)return cur.chooseVideoAdd(cur.chosenVideos,"",o);window.Wall?.postingTimelineLogger?.logStartAttaching({pickerType:X.POSTING_PICKER_TYPES.VIDEO_VK}),Z.attachVideos(cur.chosenVideos,o)},attachVideos:function(e,o){const t=cur.getFrom?.()||"";ajax.post("al_video.php?act=a_videos_attach_info",{from:t,videos:e.join(",")},{onDone:function(e){if(o&&o(),cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return(0,m.each)(e,(function(e,o){return cur.chooseSnippetVideo(e,o),!1})),void((0,p.curBox)()&&(cur.chosenVideos=[],(0,p.curBox)().hide()));let i=0,n=0;const s=("page_add_media"===cur.chooseVideoBoxMedia?.id?cur.wallAddMedia:cur.wallEditMedia)||{},r=Number(s.postponeDate),d=s.chosenMedias?.some((e=>"video"===e[0])),a="post"===t&&(r||"page_add_media"===cur.chooseVideoBoxMedia?.id);(0,m.each)(e,(function(e,o){o.publish_date&&(n=Number(o.publish_date)),cur.isNoteEdit&&window.editorChooseVideo?window.editorChooseVideo(o.thumb,o.name,o.duration,"/video"+e,e):cur.chooseMedia("video",e,o,i,cur.chosenVideos.length>1),i++})),a&&1===i&&n&&!d&&n!==r&&((0,u.showBox)("al_video.php?act=publish_date_info_box",{video_date:n,post_date:r},{params:{width:420},onDone:function(e,o){e.setButtons((0,c.getLang)("video_publish_on_wall_date_info_keep_date_btn"),(function(){boxQueue.hideAll(!0)}),(0,c.getLang)("video_publish_on_wall_date_info_change_date_btn"),(function(){if(o){cur.onMediaChange?.(o);const e=("page_add_media"===cur.chooseVideoBoxMedia?.id?cur.wallAddMedia:cur.wallEditMedia)||{};e&&(e.postponeDate&&(e.unchooseMediaForType("postpone"),cur.postponedLastDate=null),e.addOrUpdateChosenMedia("postpone",o,{date:o}))}boxQueue.hideAll(!0)}))}}),window.boxLayerBG&&(window.boxLayerBG.style.display="block",document.body.classList.add("layers_shown"))),(0,p.curBox)()&&cur.chosenVideos.length>1&&(cur.chosenVideos=[],(0,p.curBox)().hide())}})},_updateChooseFixedBottom:function(){const e=(0,p.curBox)(),o=(0,n.ge)("video_choosebox_bottom");if(e&&o){const t=(0,n.gpeByClass)("box_layout",e.bodyNode);(0,n.getSize)(t)[1]+((0,n.getXY)(t)[1]-(0,g.scrollGetY)())-(0,n.clientHeight)()>0?(0,n.addClass)(o,"fixed"):(0,n.removeClass)(o,"fixed")}},_addPendingAction:function(e,o){const t=cur.getOwnerId?cur.getOwnerId():cur.oid;if(cur.videoPendingAction=cur.videoPendingAction||{},cur.videoPendingAction[t]=cur.videoPendingAction[t]||{},e){const i=cur.videoPendingAction[t][e];cur.videoPendingAction[t][e]=function(){o(),i&&i()}}},_callPendingAction:function(e){Z._addPendingAction();const o=Z.getCurOwnerId();cur.videoPendingAction[o][e]&&cur.videoPendingAction[o][e](),cur.videoPendingAction[o][e]=!1},_clearPendingAction:function(e){Z._addPendingAction();const o=Z.getCurOwnerId();cur.videoPendingAction[o][e]=!1},toggleTooltip:function(e,o,t,i=!1){let n=[9,18,3];"view-toggle"===t?n=[-5,-1,3]:i&&(n=[9,12]),(0,h.showTooltip)(e,{black:1,text:o,shift:n,needLeft:!0,forcetodown:i})},toggleAddTooltip:function(e,o,t){const i=(0,n.gpeByClass)("_video_item",e);Z.toggleTooltip(e,(0,n.hasClass)(i,"VideoCard--videoAdded")?t:o)},show:function(e,o,t,i){if(cur.videoEditItem=(0,n.gpeByClass)("_video_item",i),cur.articleEditorLayer)return(0,I.cancelEvent)(e);if(URL.parse(i.dataset.vkLiveChannelUrl)){if(e.ctrlKey||e.metaKey||e.button&&1===e.button)return;return void(window.location.href=i.dataset.vkLiveChannelUrl)}if(t.playAlbum&&(0,_.statlogsValueEvent)("video_play_album",0,"play_album"),cur.isCurrentChooseVideoBox){const t=window.event,i=o.split("_");return ajax.post("al_video.php?act=a_video_photo_sizes",{oid:i[0],vid:i[1],type:cur.isCurrentChooseVideoBox},{onDone:function(){switch(window.event=t||window.event,cur.isCurrentChooseVideoBox){case"video_add":cur.chooseVideoAdd(o,arguments[0]);break;case"wiki_editor":window.editorChooseVideo(arguments[0],arguments[1],arguments[2],"video"+o,o);break;case"video_choose":cur.chooseMedia("video",o,arguments[0])}}}),(0,I.cancelEvent)(e),!1}if(i&&(0,n.hasClass)(i,"video_row_deleted"))return!1;if(!vk.id&&i&&(0,n.hasClass)(i,"video_row_not_public"))return(0,p.showDoneBox)((0,c.getLang)("video_please_sign_in")),!1;const s=(0,m.extend)({root:1,autoplay:1},t||{});let d=(t?t.listId:"")||this.getDefaultListId();if(!s.module){let e=cur.currentModule?cur.currentModule():cur.module;"video_search"===e&&(0,n.isAncestor)(i,"video_search_videos_list")&&(e="video_search_local"),s.module=e}if("video_live_categories"===s.module){const o=i.getAttribute("href");return void(e.ctrlKey||e.metaKey||e.button&&1===e.button?window.open(o,"_blank"):window.nav.go(o))}if(Z.isInVideosList()&&!s.playlistId){let e,o;e=cur.is_showcase?cur.showcaseSection:Z.getLoc().section||"all","all"===e?s.playlistId=cur.oid+"_-2":"uploaded"===e?s.playlistId=cur.oid+"_-1":(o=e.match(/^(album|playlist)_(-?\d+)$/))&&(s.playlistId=cur.oid+"_"+o[1])}if(Z.isInCatalog()&&!s.playlistId&&cur.catPlaylistId&&!cur.isCatalog&&(s.playlistId=cur.catPlaylistId),s.playlistId&&(s.addParams=(0,m.extend)(s.addParams||{},{playlist_id:s.playlistId,show_next:(0,m.intval)(window.VideoPlaylist&&!!VideoPlaylist.getList(s.playlistId)),force_no_repeat:1,show_all_videos:s.forceAllVideos?1:(0,m.intval)(cur.isCatalog&&(!window.VideoPlaylist||!VideoPlaylist.getList(s.playlistId)))})),s.playFrom&&(s.addParams=(0,m.extend)(s.addParams||{},{t:s.playFrom})),cur.videoSearchStats){const e=(0,n.domClosest)("video_item",i);if(e&&e.hasAttribute("data-search-pos")){cur.videoSearchPos=parseInt(e.getAttribute("data-search-pos")),cur.videoSearchPos>cur.videoSearchStats.lastSeenIndex&&(cur.videoSearchStats.lastSeenElement=e,cur.videoSearchStats.lastSeenIndex=cur.videoSearchPos),cur.videoSearchStats.positions[cur.videoSearchPos]=(0,m.extend)({clicked:0},cur.videoSearchStats.positions[cur.videoSearchPos]),cur.videoSearchStats.positions[cur.videoSearchPos].clicked++;const o=++cur.videoSearchStats.clickNum,t=Date.now()-cur.videoSearchStats.lastActionTime;s.addParams=(0,m.extend)(s.addParams||{},{click_num:o,click_time:t})}}if(!cur.is_section){const e=o.split("_");Z._saveHistoryAction(e[0],e[1])}const a=e?.target?.closest?.("#search_auto_rows");if(a){const o=(0,k.getTrackCodeFromElement)(e?.target);(0,k.logEvent)({action:k.SearchClickActionMap.PLAY,track_code:o,type:k.EventItemType.VIDEO})}return(0,r.showVideo)(o,d,s,e)},getDefaultListId:function(){return R.Ranges.isGroupId(window.cur.oid)?"club"+-window.cur.oid:window.cur.pvVideoTagsShown&&window.cur.pvShown?"tag"+window.cur.pvVideoTagsShown:""},isCurSectionHasMyPlaylistList:()=>{const e=["my","all_playlists"];return!!cur?.section_id&&e.includes(cur.section_id)},isInVideosList:function(){if(cur.is_showcase)return(0,m.inArray)(cur.showcaseSection,["all","uploaded","all_playlists","clips"])||/^playlist_-?\d+$/.test(cur.showcaseSection);const e=Z.getLoc();return/^videos-?\d+|video-?\d+_\d+$/.test(e[0])&&!e.q&&((0,m.inArray)(Z._getCurrentSectionType(),Z.AVAILABLE_TABS)||Z.isInAlbum())},deleteAlbum:function(e,o){return e=e.split("_")[1],(0,u.showBox)("al_video.php?act=delete_album",{aid:e,oid:cur.oid,is_showcase:cur.is_showcase}),(0,I.cancelEvent)(o)},editAlbum:function(e,o,t,i){const[n,s]=e.split("_");return(0,u.showBox)("al_video.php?act=edit_album",{oid:i?n:cur.oid,aid:s,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js"),"video_edit.css"],containerClass:"VideoPlaylistPopup",onDone:function(e){e.boxLayoutNode.dataset.requestOrigin=t}}),(0,I.cancelEvent)(o)},doDeleteAlbum:(e,o,t,i)=>{const n=(0,p.curBox)();if(!n)return;const s=n.btns.ok[0];ajax.post("al_video.php?act=do_delete_album",{aid:e,hash:o,oid:cur.oid},{onDone:function(){window.dispatchEvent(new CustomEvent(O.PlaylistFormEvents.DELETE)),n.hide(),globalHistoryDestroy(i),"/"+nav.strLoc===t?nav.reload():nav.go(t,!1,{back:!0})},showProgress:()=>(0,S.lockButton)(s),hideProgress:()=>(0,S.unlockButton)(s)})},initEditAlbumBox:function(e,o,t,s,r,d,a){const u=(0,p.curBox)(),_=(0,l.isObject)(r),h=!!Object.keys(a).length,v=u.bodyNode.querySelector(".js-video-upload-thumb-chooser"),g=u.bodyNode.querySelector(".js-video-upload-vertical-thumb-chooser");if(h){if(window.VideoUpload.initThumbUpload(a,v),(0,l.isObject)(d)&&d.uploaded_id){const e=v.querySelector(".js-video_tc_upload_image");e.style.backgroundImage="url("+d.uploaded_url+")",e.style.display="block";const o=v.querySelector(".js-video_tc_uploader");o&&(o.setAttribute("data-thumb-id",d.uploaded_id),o.setAttribute("data-thumb-hash",d.uploaded_hash))}if(g){const e={...a,url:a.url_for_vertical_thumb,is_vertical:!0};if(window.VideoUpload.initThumbUpload(e,g),(0,l.isObject)(d)&&d.uploaded_vertical_url){const e=g.querySelector(".js-video_tc_upload_image");e.style.backgroundImage="url("+d.uploaded_vertical_url+")",e.style.display="block";const o=g.querySelector(".js-video_tc_uploader");o&&(o.setAttribute("data-thumb-id",d.uploaded_id),o.setAttribute("data-thumb-hash",d.uploaded_hash))}}}const I=o=>()=>{nav.go(s+"/"+(0,Y.getIdentityRawId)({id:o,ownerId:e}))};if(R.Ranges.isGroupId(e)&&_){const e=(0,n.rs)(r.key,{id:o}),t=document.getElementById(e);new K.InlineDropdown(t,{items:r.items,selected:r.selected})}_&&(cur.privacy=(0,m.extend)(cur.privacy||{},r));const w=o?(0,c.getLang)("global_save"):(0,c.getLang)("video_create_new_playlist");u.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),u.removeButtons(),u.addButton(w,(function(d){let a=(0,n.ge)("video_album_edit_title"),l=a.value.trim();if(!l)return(0,S.notaBene)(a);let p="";if(_)if(R.Ranges.isUserId(e))p=window.Privacy.getValue("video_playlist"+o);else if(R.Ranges.isGroupId(e)){const e=(0,n.rs)(r.key,{id:o});p=document.getElementById(`${e}_input`)?.value}let m="",w="",V="",f="";if(h){const e=(0,n.geByClass1)("js-video_tc_uploader",v);m=(0,n.domData)(e,"thumb-id")||x.VIDEO_DEFAULT_THUMB_ID,m===x.VIDEO_DEFAULT_THUMB_ID&&(m=""),w=(0,n.domData)(e,"thumb-hash")||"";const o=g?.querySelector(".js-video_tc_uploader");o&&(V=o.getAttribute("data-random-tag"),f=o.getAttribute("data-vertical-photo-hash"))}ajax.post("al_video.php?act=do_edit_album",{id:o,oid:e,hash:t,title:l,privacy:p,thumb_id:m,photo_hash:w,random_tag:V,vertical_photo_hash:f},{showProgress:()=>(0,S.lockButton)(d),hideProgress:()=>(0,S.unlockButton)(d),onDone:function(t){const n=u.boxLayoutNode.dataset?.requestOrigin,r=u.boxLayoutNode.dataset?.videoId,d=u.boxLayoutNode.dataset?.videoOwnerId;if(n===O.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL&&r&&d)return window.dispatchEvent(new CustomEvent(O.PlaylistFormEvents.CREATE,{detail:{id:t,ownerId:e,title:l,privacy:p,videoOwnerId:d,videoId:r}})),void u.hide();if(o||((e,o)=>{(0,E.showSnackbar)({before:{content:(0,i.jsx)(G.Icon28ListCheckOutline,{})},text:(0,c.getLang)("video_playlist_created_notification"),action:{label:(0,c.getLang)("video_open_new_playlist"),onClick:(0,P.partConfigEnabled)("frontend.new_playlist_snackbar_opening_fix")?I(o):()=>{cur.is_showcase?nav.go(s+"/"+(0,Y.getIdentityRawId)({id:o,ownerId:e})):nav.go({section:"album_"+o},!1)}}})})(e,t),[O.CreatePlaylistRequestOrigin.NEW_PLAYLIST_PAGE,O.CreatePlaylistRequestOrigin.VIDEO_CATALOG].includes(n))return window.dispatchEvent(new CustomEvent(O.PlaylistFormEvents.UPDATE,{detail:{id:o,ownerId:e,title:l,privacy:p}})),void u.hide();if(u.hide(),o)cur.isAdmin?AdminShowcasePlaylists.search():nav.reload();else{window.dispatchEvent(new CustomEvent(O.PlaylistFormEvents.CREATE,{detail:{id:t,ownerId:e,title:l,privacy:p,videoId:r}}));const o=n===O.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL;Z.isCurSectionHasMyPlaylistList()&&!o&&nav.reload()}}})}),"yes",!1,"popup_save_button"),u.addButton((0,c.getLang)("global_cancel"),u.hide,"no"),(0,n.elfocus)("video_album_edit_title")},editCategories:function(e,o,t){return(0,u.showBox)("al_video.php?act=show_movie_info_form",{owner_id:e,playlist_id:o},{onDone:function(e,o){cur.categoriesUpdateOptions={hash:o.hash,owner_id:o.owner_id,playlist_id:o.playlist_id};const t=new Dropdown((0,n.ge)("video_playlist_categories"),o.all_categories,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.category_ids}),i=new Dropdown((0,n.ge)("video_movie_actors"),"/al_video.php?act=get_movie_info_dropdown_data&type=1",{multiselect:!0,autocomplete:!0,big:1,width:380,noResult:"Актер не найден",selectedItem:o.selected_actors}),s=new Dropdown((0,n.ge)("video_movie_directors"),"/al_video.php?act=get_movie_info_dropdown_data&type=2",{multiselect:!0,autocomplete:!0,big:1,width:380,noResult:"Режиссер не найден",selectedItems:o.selected_directors}),r=new Dropdown((0,n.ge)("video_movie_countries"),o.all_tag_countries,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.country_ids,noResult:"Страна не найдена"}),d=new Dropdown((0,n.ge)("video_movie_genres"),o.all_tag_genres,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.genre_ids,noResult:"Жанр не найден"}),a=new Dropdown((0,n.ge)("video_movie_custom_tags"),o.all_tag_custom_tags,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.custom_tag_ids,noResult:"Тег не найден"});e.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),e.removeButtons(),e.addButton("Сохранить",(function(c){let l={hash:cur.categoriesUpdateOptions.hash,owner_id:cur.categoriesUpdateOptions.owner_id,playlist_id:cur.categoriesUpdateOptions.playlist_id,year:(0,n.ge)("video_movie_year").value,kinopoisk_id:(0,n.ge)("video_movie_kinopoisk_id").value,rating_kinopoisk:(0,n.ge)("video_movie_rating_kinopoisk").value,rating_age:(0,n.ge)("video_movie_rating_age").value,category_ids:t.selectedItems().map((e=>e[0])),actor_ids:i.selectedItems().map((e=>e[0])),director_ids:s.selectedItems().map((e=>e[0])),country_ids:r.selectedItems().map((e=>e[0])),genre_ids:d.selectedItems().map((e=>e[0])),custom_tag_ids:a.selectedItems().map((e=>e[0])),info_updated_at:o.info_updated_at};const u=document.getElementById("video_playlist_mark");null!==u&&(l.playlist_mark=u.value),ajax.post("al_video.php?act=update_movie_info",l,{showProgress:()=>(0,S.lockButton)(c),hideProgress:()=>(0,S.unlockButton)(c),onDone:function(){e.hide()}})})),e.addButton("Отмена",e.hide,"no")}}),(0,I.cancelEvent)(t)},initCreateAlbumWarningBox:function(){const e=(0,p.curBox)();e.removeButtons(),e.addButton((0,c.getLang)("video_cancel_but"),e.hide,"neutral")},createAlbum:function(e,o=cur.oid,t,i,n,r,d){return(0,m.intval)(o)?cur.is_showcase&&!vk.id?((0,u.showBox)("al_login.php?act=box",{from:nav.strLoc},{},e),!1):void(0,u.showBox)("al_video.php?act=edit_album",{oid:o,is_showcase:cur.is_showcase,no_public_add:Number(d)},{stat:[window.jsc("web/upload.js")],containerClass:"VideoPlaylistPopup",onDone:function(e){e.setOptions({width:500,onDestroy:r}),e.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),e.titleWrap.classList.toggle("OwnerChooseWrapper--colorGrey",!0),e.boxLayoutNode.dataset.requestOrigin=n??"",e.boxLayoutNode.dataset.videoId=t??"",e.boxLayoutNode.dataset.videoOwnerId=i??""},onFail:function(e){if(e)return(0,p.curBox)().hide(),(0,u.showFastBox)((0,c.getLang)("global_error"),e),!0}}):((0,s.showQuickLoginBox)(),!1)},isVideoPlayerOpen:function(e,o){let t=e;return o&&(t+="_"+o),window.mvcur&&!0===mvcur.mvShown&&mvcur.videoRaw===t},startPollVideoReady:function(e,o){const t=e+"_"+o;setTimeout((function(){ajax.post("al_video.php?act=check_upload_status",{video:t,oid:e,vid:o},{onDone:function(i){Z.isVideoPlayerOpen(e,o)&&(i?(mvcur.minimized?Videoview.hide(!1,!0):Videoview.backLocation(),(0,r.showVideo)(t,"",{})):Z.startPollVideoReady(e,o))}})}),1e4)},tcSlide:function(e,o,t,i){const s=(0,n.gpeByClass)("video_tc_slider",o),r=(0,n.geByClass1)("video_tc_slider_cont",s),d=(0,n.getW)(r),a=getComputedStyle(r.children[0]),c=getComputedStyle(r.children.length>0?r.children[1]:r.children[0]),l=parseInt(a.getPropertyValue("margin-left"))+parseInt(a.getPropertyValue("margin-right")),u=parseInt(c.getPropertyValue("margin-left"))+parseInt(c.getPropertyValue("margin-right")),_=(0,n.getW)(r.children[0])+l,h=(0,n.getW)(r.children.length>0?r.children[1]:r.children[0])+u,v=_>0?Math.max(Math.floor(d/_),Math.floor((d-u)/h)):Math.floor((d-u)/h),g=Math.max(0,r.children.length-v);let p=(0,n.data)(r,"currOffset")||0;p+=t,p=Math.min(r.children.length,Math.max(0,p),g),(0,n.data)(r,"currOffset",p),i&&(0,n.addClass)(r,"no_transition");const E=_*+(r.children.length>0)+h*(r.children.length-1)-d-u;let m=_*+(p>0)+Math.max(0,h*(p-1));m=Math.max(0,Math.min(m,E)),(0,n.setStyle)(r,{left:-m}),i&&setTimeout((function(){(0,n.removeClass)(r,"no_transition")}));const S=0===p,w=p===g||m===E,V=(0,n.geByClass1)("video_tc_btn_left",s),f=(0,n.geByClass1)("video_tc_btn_right",s);function C(e,o){e?(0,I.addEvent)(o,"mouseleave",(function(){(0,n.setStyle)(o,"pointer-events","none"),(0,I.removeEvent)(o,"mouseleave")})):((0,n.setStyle)(o,"pointer-events","all"),(0,I.removeEvent)(o,"mouseleave"))}return(0,n.toggleClass)(V,"video_tc_btn_none",S),(0,n.toggleClass)(f,"video_tc_btn_none",w),C(S,V),C(w,f),e&&(0,I.cancelEvent)(e),!1},_initSearchStats:function(e){cur.videoSearchPos=null,cur.videoSearchStats={loc:e,totalViews:0,lastSeenElement:null,lastSeenIndex:-1,totalViewedTime:0,clickNum:0,lastActionTime:Date.now(),positions:[]}},_clearSearchStats:function(){delete cur.videoSearchPos,delete cur.videoSearchStats},_updateLastSeenElement:function(e){if(!cur.videoSearchStats)return;if(!(null!==cur.videoSearchStats.lastSeenElement&&e.contains(cur.videoSearchStats.lastSeenElement)||(cur.videoSearchStats.lastSeenElement=(0,n.domFC)(e),cur.videoSearchStats.lastSeenElement)))return;cur.videoSearchStats.lastSeenIndex=0;const o=(0,n.clientHeight)();let t=(0,n.domNS)(cur.videoSearchStats.lastSeenElement);if(!t)return;let i=t.getBoundingClientRect();for(;i.top+t.clientHeight/2<o&&(cur.videoSearchStats.lastSeenElement=t,t=(0,n.domNS)(cur.videoSearchStats.lastSeenElement),t);)i=t.getBoundingClientRect();cur.videoSearchStats.lastSeenIndex=parseInt(cur.videoSearchStats.lastSeenElement.getAttribute("data-search-pos"))||0},_updateThumbsInView:function(){(0,L.updateThumbsInView)()},getCurOwnerId:function(){return cur.getOwnerId?cur.getOwnerId():cur.oid},onImageError:function(e,o=!0){if(!e.getAttribute("data-thumb")){const t=e.parentNode;if(t.removeChild(e),o){let e=(0,b.getIcon56VideoOutline)().icon;t.insertAdjacentHTML("beforeend",`<div class="VideoCard__thumbIcon">${e}</div>`)}}},checkClickEvent:e=>"click"===e.type&&(e.ctrlKey||e.metaKey),isGroupsRedesignEnabled:()=>{const e=cur.getOwnerId?cur.getOwnerId():cur.oid;return R.Ranges.isGroupId(e)}}},723022:(e,o,t)=>{t.d(o,{buildCommunityEl:()=>I,buildDateSeparatorEl:()=>m,buildPlaylistEl:()=>E,buildVideoEl:()=>p,buildVideoRestorationEl:()=>g,updateThumbsInView:()=>w});var i=t(581197),n=t(478752),s=t(102088),r=t(540462),d=t(692543),a=t(538522),c=t(908671),l=t(754866),u=t(826619),_=t(351118),h=t(126415),v=t(856289);const g=(e,o,t,n,r,d)=>{if(!window?.cur?.videoRestorationCardTemplate)return null;const c=(0,a.joinRawId)({itemId:e,ownerId:o});let u="";return u=t?(0,s.getLang)("video_clip_deleted"):r?d?(0,s.getLang)("video_video_deleted_from_all_playlists"):(0,s.getLang)("video_video_deleted_from_playlist"):d?(0,s.getLang)("video_video_deleted_from_all"):(0,s.getLang)("video_video_deleted_from_album"),cur.section_id===v.SECTION_MY_BOOKMARKS&&(u=(0,s.getLang)("video_deleted_from_my_watch_later")),cur.section_id===v.SECTION_MY_LIKED&&(u=(0,s.getLang)("video_deleted_from_my_liked")),(0,i.createElementFromHTML)((0,l.rs)(window.cur.videoRestorationCardTemplate,[c,u]))};function p(e,o=!1){let t=(0,n.trim)(o?cur.videoItemTemplate:cur.videoItemTpl);const i=e[VideoConstants.VIDEO_ITEM_INDEX_LINK],d=i&&i.includes("clip"),a=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&&e[VideoConstants.VIDEO_ITEM_INDEX_VK_LIVE_CHANNEL_URL];cur.shortVideoGridItemTemplate&&d&&(t=cur.shortVideoGridItemTemplate);const v=(e=(0,n.clone)(e))[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];if(v){const o=v.subtitle?' <span class="mv_subtitle">'+v.subtitle+"</span>":"",t=(0,u.getFormattedUpdatedTime)(e[VideoConstants.VIDEO_ITEM_INDEX_DATE]);e[VideoConstants.VIDEO_ITEM_INDEX_TITLE]=v.title+o,e[VideoConstants.VIDEO_ITEM_INDEX_OWNER]=v.main+v.featured,e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=t,e[VideoConstants.VIDEO_ITEM_INDEX_DATE]=v.genre}else a?e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=(0,s.getLang)("video_live_N_watching",e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],!0):o&&e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]>999&&!d?e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=(0,u.getFormattedBigViewsToShortCase)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]):e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=d?(0,c.formatCount)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]):(0,s.langNumeric)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],(0,s.curLang)("video_N_views_list"),!0),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]=(0,u.getFormattedUpdatedTime)(e[VideoConstants.VIDEO_ITEM_INDEX_DATE],o),e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]='<span class="video_thumb_label_live_icon"></span>');const g=o&&!!e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS];g&&(e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS]=(0,_.decodeHTMLEntities)(e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS]));const p=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_SCHEDULED,E=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_UPCOMING_LIVE,m=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_INTERACTIVE;if(e[VideoConstants.VIDEO_ITEM_INDEX_SUBTITLE_PLACE]=(0,l.rs)(function(e=!1,o=!1,t=!1){return cur?.videoItemSubTitleTemplate?o?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_SCHEDULED]||"":t?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_UPCOMING_LIVE]||"":e?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_LABEL]||"":cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_DURATION_WITH_VIEWS]||"":""}(g,p,E),e),e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON]&&((0,r.partConfigEnabled)("video_trends_description_fix")&&(e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON]=(0,_.decodeHTMLEntities)(e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON])),e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON]=(0,l.rs)(cur?.videoItemDescriptionTemplate||"",e)),e[VideoConstants.VIDEO_ITEM_INDEX_AVATAR_IMAGE]){const o=function(e=!1){return cur?.videoItemBaseAvatarTemplate?e?cur.videoItemBaseAvatarTemplate?.[1]||"":cur.videoItemBaseAvatarTemplate?.[0]||"":""}(e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_NFT_AVATAR);e[VideoConstants.VIDEO_ITEM_INDEX_AVATAR_PLACE]=(0,l.rs)(o,e)}p?(e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]=(0,u.getFormattedPostponePublishDateTime)(e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]),e[VideoConstants.VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS]="",e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]=(0,l.rs)(cur?.videoItemPostponePublishTemplate||"",e)):e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]="",d&&(e[VideoConstants.VIDEO_ITEM_INDEX_CARD_ACTIONS]=(0,l.rs)(cur?.shortVideoActionTemplate||"",e)),E?(e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]=(0,u.getFormattedPostponePublishDateTime)(e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]),e[VideoConstants.VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS]="",e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]=(0,l.rs)(cur?.videoItemUpcomingLiveDateTemplate||"",e)):e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]="",e[VideoConstants.VIDEO_ITEM_INDEX_LABEL_PLACE]=function(e="",o="",t=!1){const i=e=>{const o=document.createElement("span");return o.className="VideoCard__labelItem",o.innerHTML=e,o},n=document.createElement("div");if(n.className="VideoCard__label",t){n.classList.add("VideoCard__label--interactive"),n.setAttribute("scheme","vkcom_dark");const e=i((0,h.getIcon12HandPointUp)().icon);n.appendChild(e)}o&&n.appendChild(i(o));e&&n.appendChild(i(e));return n.outerHTML}(e[VideoConstants.VIDEO_ITEM_INDEX_DURATION],e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM],m);const I=Video.prepareVideoItemAttrs(e);let S=(0,l.rs)(t,e);return S=S.replace("%classes%",I[0]).replace("%attrs%",I[1]),S=(0,l.se)(S),S}function E(e,o=!1){const t=(0,n.trim)(o?cur.playlistItemTemplate:cur.albumItemTpl);return(0,l.se)((0,l.rs)(t,e))}function m(e){const o=(0,_.isDateToday)(new Date(e))?(0,s.getLang)("video_date_today"):langDate(e,"{day} {month}",0,(0,s.getLang)("months_of","raw")),t=(0,l.ce)("div",{className:"VideoGrid__separator",innerHTML:o});return t.setAttribute("data-date",e),t}function I(e){const o=(0,n.trim)(cur.communityItemTemplate);return(0,l.sech)((0,l.rs)(o,e))}let S=0;function w(){clearTimeout(S),S=setTimeout((()=>{let e=null;const o=(0,l.clientHeight)(),t="im"===cur.module?0:(0,d.scrollGetY)();(0,n.each)((0,l.geByClass)("js-video-item-thumb"),((i,n)=>{if(!(0,l.domData)(n,"thumb"))return;const s=(0,l.getXY)(n,"im"===cur.module)[1];if(e=e||(0,l.getSize)(n),s>t-e[1]-800&&s<t+o+800){const e=(0,l.domData)(n,"thumb");(0,l.domData)(n,"thumb",null),"IMG"===n.tagName?n.src=e:(0,l.setStyle)(n,"background-image",`url(${e})`)}}))}),50)}},373594:(e,o,t)=>{t.d(o,{APP_PROMO_SLOW_YT_SNACKBAR_EVENT_TYPE:()=>r,AppPromoSlowYtSnackbarEventTypes:()=>d,CRITERIA_PARAMS_REG_EXP:()=>i,FAVORITE_SOURCES:()=>s,SNACKBAR_EVENTS:()=>n});const i=/^\w\[(.*)]$/,n={ADD_TO_FAVE:"ADD_TO_FAVE",REMOVE_FROM_FAVE:"REMOVE_FROM_FAVE",ADD_TO_MY:"ADD_TO_MY",REMOVE_FROM_MY:"REMOVE_FROM_MY",REMOVE_FROM_GROUP:"REMOVE_FROM_GROUP",ADD_TO_PLAYLIST:"ADD_TO_PLAYLIST",ADD_TO_PLAYLISTS:"ADD_TO_PLAYLISTS",REMOVE_FROM_PLAYLIST:"REMOVE_FROM_PLAYLIST",REMOVE_FROM_PLAYLISTS:"REMOVE_FROM_PLAYLISTS",DELETE_PLAYLIST:"DELETE_PLAYLIST",PLAYLIST_SAVED:"PLAYLIST_SAVED",COPY_LINK:"COPY_LINK",COPY_ERID:"COPY_ERID",ORD_ADDED:"ORD_ADDED",REMOVE_FROM_HISTORY:"REMOVE_FROM_HISTORY",CLEAR_VIEWING_HISTORY:"CLEAR_VIEWING_HISTORY",ONBOARDING_RELOAD_CATALOG:"ONBOARDING_RELOAD_CATALOG",UPLOAD_SUCCESS:"UPLOAD_SUCCESS",UPLOAD_PROGRESS:"UPLOAD_PROGRESS",VIDEO_SAVED:"VIDEO_SAVED",REMOVE_LIKE:"REMOVE_LIKE",ERROR:"ERROR"},s={VIDEO_PLAYER_MODAL:"video_player_modal",VIDEO_PLAYER_BUTTON:"video_player_button",VIDEO_CARD_MODAL:"video_card_modal",VIDEO_CARD_BUTTON:"video_card_button",SNACKBAR:"snackbar"},r="mvk_video_app_promo_slow_yt_snackbar_event";var d=function(e){return e.MVK_APP_PROMO_SLOW_YT_SNACKBAR_SHOW="mvk_app_promo_slow_yt_snackbar_show",e.MVK_APP_PROMO_SLOW_YT_SNACKBAR_CLOSE="mvk_app_promo_slow_yt_snackbar_close",e.MVK_APP_PROMO_SLOW_YT_SNACKBAR_CLICK="mvk_app_promo_slow_yt_snackbar_click",e}({})},922105:(e,o,t)=>{t.d(o,{VideoExtraTabsActions:()=>_});var i=t(474848),n=t(296540),s=t(865708),r=t(700272),d=t(507852),a=t(826619),c=t(37710),l=t(713851);const u="default",_=({orderItems:e,commentsTooltipText:o,canSeeComments:t,canSeeOrder:_,onCommentsButtonClick:h,onVideosOrderChange:v})=>{const[g,p]=(0,n.useState)(u),[E,m]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=()=>m(!0),o=()=>m(!1);return window.addEventListener(a.VideoOrderEvents.START_LOADING,e),window.addEventListener(a.VideoOrderEvents.END_LOADING,o),()=>{window.removeEventListener(a.VideoOrderEvents.START_LOADING,e),window.removeEventListener(a.VideoOrderEvents.END_LOADING,o)}}),[]),(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsxs)("div",{className:l.default.actions,children:[t&&(0,i.jsx)(c.VideoActionButton,{tooltipText:o,type:c.VideoActionButtonType.Comments,onClick:h}),_&&(E?(0,i.jsx)(r.Spinner,{size:"regular",className:l.default.spinner}):(0,i.jsx)(d.DropdownActionSheet,{width:200,trigger:"hover",content:(0,i.jsx)(c.VideoOrderPopout,{selected:g,items:e,onChange:e=>{p(e),v(e)}}),children:(0,i.jsx)(c.VideoActionButton,{selected:g!==u,type:c.VideoActionButtonType.Order})}))]})})}},685145:(e,o,t)=>{t.d(o,{VideoActionButton:()=>_,VideoActionButtonType:()=>l});var i=t(474848),n=t(351118),s=t(271036),r=t(578392),d=t(743541),a=t(867696),c=t(970947),l=function(e){return e[e.Comments=0]="Comments",e[e.Order=1]="Order",e}({});const u={0:(0,i.jsx)(d.Icon24CommentOutline,{className:c.default.buttonIcon}),1:(0,i.jsx)(a.Icon24SortOutline,{className:c.default.buttonIcon})},_=({type:e,tooltipText:o,selected:t,getRootRef:d,onClick:a,dataTestId:l})=>{const _=(0,i.jsx)(s.IconButton,{size:36,className:(0,n.classNames)(c.default.button,t&&c.default.buttonSelected),hasHover:!1,hasActive:!1,onClick:a,getRootRef:d,"data-testid":l,children:u[e]});return o?(0,i.jsx)(r.TextTooltip,{text:o,offsetByMainAxis:-3,offsetByCrossAxis:20,appearance:"black",placement:"top-end",children:_}):_}},468816:(e,o,t)=>{t.d(o,{VideoOrderPopout:()=>s});var i=t(474848),n=t(507852);const s=({selected:e,items:o,onChange:t})=>(0,i.jsx)(i.Fragment,{children:o.map((({value:o,label:s})=>{return(0,i.jsx)(n.DropdownActionSheet.Item,{selected:e===o,onClick:()=>t(o),children:(r=s,r.charAt(0).toUpperCase()+r.slice(1))},o);var r}))})},37710:(e,o,t)=>{t.d(o,{VideoActionButton:()=>i.VideoActionButton,VideoActionButtonType:()=>i.VideoActionButtonType,VideoOrderPopout:()=>n.VideoOrderPopout});var i=t(685145),n=t(468816)},205389:(e,o,t)=>{t.d(o,{VideoActionButton:()=>i.VideoActionButton,VideoActionButtonType:()=>i.VideoActionButtonType,initVideoExtraTabsActions:()=>n.initVideoExtraTabsActions,mapRawVideosOrderItemToVideosOrderItem:()=>n.mapRawVideosOrderItemToVideosOrderItem});var i=t(37710),n=t(481279)},481279:(e,o,t)=>{t.d(o,{initVideoExtraTabsActions:()=>c,mapRawVideosOrderItemToVideosOrderItem:()=>l});var i=t(474848),n=t(440961),s=t(342018),r=t(922105),d=t(205338),a=t(540462);const c=e=>{const o=document.getElementById("VideoExtraTabsActions");if(o)if((0,a.partConfigEnabled)("enable_create_root")){const t=(0,d.createRoot)(o);t.render((0,i.jsx)(r.VideoExtraTabsActions,{...e})),(0,s.pushNavDestroy)((()=>{t.unmount()}))}else n.render((0,i.jsx)(r.VideoExtraTabsActions,{...e}),o),(0,s.pushNavDestroy)((()=>{o&&n.unmountComponentAtNode(o)}))},l=e=>{const[o,t]=e;return{label:t,value:o}}},3820:(e,o,t)=>{t.d(o,{showWatchLaterSnackbar:()=>a});var i=t(474848),n=t(866467),s=t(432465),r=t(604972),d=t(856289);const a=({isBookmarked:e,rollbackCallback:o})=>{const t=e?{text:`${(0,n.getLang)("video_deleted_from_section")} «${(0,n.getLang)("video_catalog_showcase_section_my_watch_later_title")}»`,before:{content:(0,i.jsx)(r.Icon28ClockOutline,{})},action:{label:(0,n.getLang)("global_cancel"),onClick:(e,t)=>{o&&o(),(0,s.hideSnackbar)(t)}}}:{text:`${(0,n.getLang)("video_added_to_section")} «${(0,n.getLang)("video_catalog_showcase_section_my_watch_later_title")}»`,before:{content:(0,i.jsx)(r.Icon28ClockOutline,{})},action:window.cur?.section_id!==d.SECTION_MY_BOOKMARKS?{label:(0,n.getLang)("global_open_section"),onClick:()=>window.location.href=d.BOOKMARKS_URL}:void 0};(0,s.showSnackbar)(t)}},537324:(e,o,t)=>{t.d(o,{hasSectionInCache:()=>n,loadSectionFromCache:()=>s,saveSectionInCache:()=>r});let i=null;const n=(e,o)=>i?.key===e&&i.nextFrom===o,s=(e,o)=>{if(i?.key===e&&i.nextFrom===o)return Promise.resolve(i.data)},r=(e,o,t)=>{if(i?.key!==e)return void(i={key:e,data:t,nextFrom:o});const{videos:n,playlists:s,nextFrom:r,communities:d,shopping:a,shoppingVideos:c}=t;i.data={nextFrom:r,shopping:a,videos:(i.data.videos??[]).concat(n??[]),playlists:(i.data.playlists??[]).concat(s??[]),communities:(i.data.communities??[]).concat(d??[]),shoppingVideos:(i.data.shoppingVideos??[]).concat(c??[])}}},975802:(e,o,t)=>{t.d(o,{addVideoToBookmarks:()=>n});var i=t(957994);const n=e=>(0,i.api)("fave.addVideo",e)},532865:(e,o,t)=>{t.d(o,{downloadVideo:()=>s});var i=t(636576),n=t(538522);const s=({oid:e,vid:o,title:t,type:s})=>{const r=Number(e),d=Number(o);window.ajax.post("al_video.php?act=get_download_url",{video_raw_id:(0,n.joinRawId)({ownerId:r,itemId:d})},{onDone:e=>{((e,o,t)=>{if(!e)return!1;const n=document.createElement("a");n.href=e,n.download=`${o}.mp4`,document.body.appendChild(n),n.click(),document.body.removeChild(n),(0,i.statlogsValueEvent)("video_downloads","",t)})(e,t,s)}})}},636826:(e,o,t)=>{t.d(o,{addVideoToBookmarks:()=>i.addVideoToBookmarks,downloadVideo:()=>n.downloadVideo,onAuthorClick:()=>s.onAuthorClick,removeShortVideo:()=>r.removeShortVideo,removeVideoFromAlbum:()=>r.removeVideoFromAlbum,removeVideoFromBookmarks:()=>r.removeVideoFromBookmarks,removeVideoFromLikes:()=>r.removeVideoFromLikes,removeVideoFromMy:()=>r.removeVideoFromMy});var i=t(975802),n=t(532865),s=t(396036),r=t(161629)},396036:(e,o,t)=>{t.d(o,{onAuthorClick:()=>n});var i=t(856289);const n=e=>{e.stopPropagation(),(0,i.isVideoStandalone)()&&e.target instanceof HTMLAnchorElement&&Boolean(e.target.href)&&(e.preventDefault(),window?.nav?.go(e.target.href))}},161629:(e,o,t)=>{t.d(o,{removeShortVideo:()=>s,removeVideoFromAlbum:()=>r,removeVideoFromBookmarks:()=>a,removeVideoFromLikes:()=>d,removeVideoFromMy:()=>n});var i=t(957994);const n=e=>(0,i.api)("video.delete",e),s=e=>(0,i.api)("shortVideo.delete",e),r=e=>(0,i.api)("video.removeFromAlbum",e),d=e=>(0,i.api)("likes.delete",e),a=e=>(0,i.api)("fave.removeVideo",e)},187862:(e,o,t)=>{t.d(o,{showNewVideoEditModal:()=>l});var i=t(474848),n=t(725669),s=t(314309),r=t(211413),d=t(319756),a=t(452223);const c=(0,n.asyncComponent)((()=>Promise.all([t.e(91498),t.e(89631),t.e(762),t.e(79210),t.e(63616),t.e(96851),t.e(5375),t.e(89887),t.e(9397),t.e(96025),t.e(87108),t.e(1071),t.e(95698),t.e(38302),t.e(31325),t.e(14262),t.e(80178),t.e(1093),t.e(7743),t.e(94781),t.e(57220),t.e(15642),t.e(66536),t.e(6743),t.e(75846),t.e(91338),t.e(11420),t.e(36943),t.e(83521),t.e(10275),t.e(85596),t.e(14762),t.e(58020),t.e(77312),t.e(51320),t.e(46631),t.e(26648),t.e(63502),t.e(34767),t.e("langs/web/NewVideoEditModal")]).then(t.bind(t,114532))),(({NewVideoEditModal:e})=>e)),l=async({ownerId:e,videoId:o,onDone:t,entryPoint:n,generatedOvId:l,analyticEventSubtype:u})=>{window.Privacy||window.stManager.add([window.jsc("web/privacy.js")]),u&&s.videoEditStatsCollector.logEvent({event_type:a.VideoEditActionEventTypes.EVENT_TYPE_EDIT_VIDEO,event_subtype:u,object_type:a.VideoEditActionObjectTypes.VIDEO,video_id:Number(o),video_owner_id:Number(e)}),window.cur.videoInlinePlayer&&window.cur.videoInlinePlayer.pause(),(0,r.showMessageBoxModalSuspense)((s=>(0,i.jsx)(d.DIRootWebProvider,{children:(0,i.jsx)(c,{...s,name:"new-video-edit-modal",ownerId:e,videoId:o,onDone:t,entryPoint:n,generatedOvId:l})})),{width:825})}},713851:(e,o,t)=>{t.d(o,{default:()=>i});const i={actions:"VideoExtraTabsActions__actions--5I0Th",spinner:"VideoExtraTabsActions__spinner--WMbVb"}},970947:(e,o,t)=>{t.d(o,{default:()=>i});const i={button:"VideoActionButton__button--qGDPt",buttonIcon:"VideoActionButton__buttonIcon--4vwV8",buttonSelected:"VideoActionButton__buttonSelected--QSLBI"}}}]),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/c2d36f3b.f041801c.js")}catch(e){throw"undefined"!=typeof window&&window.stManager?.fail?.("dist/web/chunks/c2d36f3b.f041801c.js",e),e}